import{Q as Ou,M as Iu}from"./QScrollArea.08a568a1.js";import{u as Hu}from"./use-meta.f76d898d.js";import{u as ae,a as Ce,n as lu,i as Uu,c as Fu,g as Lu}from"./myFuncts.57fb681f.js";import{c as Pu,a as Oe}from"./axios.58dd5c85.js";import{Q as O}from"./QItemLabel.91ec210f.js";import{Q as $,b as z,a as nu}from"./QImg.d3ea3630.js";import{V as Qu,X as Tu,bb as Wu,Z as Ru,di as Nu,r as k,c as K,w as Ie,aJ as Ku,W as ju,h as R,g as Yu,dk as zu,au as Ju,a6 as Xu,a4 as Gu,ak as je,z as J,i as ne,m,C as W,f as e,p as u,u as s,bi as re,y as De,ax as N,n as I,q as S,t as P,A as Ye,l as T,d as fe,cR as Zu,cq as vu,b as Fe,E as Xe,x as ue,bm as ve,v as xe,k as Ve,bk as fu,bl as mu,o as pu,I as le,F as Z,D as He,df as ze,B as se,H as gu,G as et,a as ut,ay as au}from"./index.1ed4f0d9.js";import{Q as Se}from"./QSelect.224c14af.js";import{Q as _u}from"./QTooltip.4f8868a4.js";import{T as tt,d as Le,b as hu}from"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.844c9627.js";import{a as lt}from"./style.7dcbbeeb.js";/* empty css               */import{u as ou,b as nt,c as at,_ as qe,g as ot,f as it,Q as iu,a as st}from"./QPopupProxy.8d2c5a5d.js";import{p as Ae}from"./format.de7e9769.js";import{C as su}from"./ClosePopup.18e82721.js";import{A as dt}from"./AnnounceCard.b4533ad1.js";import{S as rt,Q as ct}from"./QInnerLoading.42d26143.js";import{m as vt}from"./myAuth.e8729030.js";import{S as ft}from"./SelectComposer.7450119e.js";import{W as he,P as Je,A as mt}from"./lib.6bd68e9e.js";import{_ as Pe}from"./BtnDelete.3fcc8c4a.js";import{H as ce}from"./hall.dc91fb49.js";import{m as Ue}from"./announce.75f4185e.js";import{Q as du}from"./QList.94cd8ab2.js";import{_ as ru}from"./BtnMoveSort.6b0c3656.js";import{_ as Ge}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as pt}from"./QVideo.dff07da9.js";import{_ as cu}from"./PhoneNumber.8e9e69f7.js";import"./QToolbarTitle.41ff71e9.js";import"./QLinearProgress.83dd9361.js";import"./QMenu.56bfa58f.js";import"./position-engine.a05a0349.js";import"./selection.d99639c5.js";import"./use-virtual-scroll.757b0b25.js";import"./rtl.276c3f1b.js";import"./touch.9135741d.js";import"./use-file.cb0ee2c1.js";import"./get-emits-object.a3f16783.js";import"./use-render-cache.3aae9b27.js";import"./entry.5005a3f9.js";import"./myAxios.7a7c879e.js";import"./AuthorItem.26a9f1ee.js";function gt(l,B){if(l.hour!==null){if(l.minute===null)return"minute";if(B===!0&&l.second===null)return"second"}return"hour"}function _t(){const l=new Date;return{hour:l.getHours(),minute:l.getMinutes(),second:l.getSeconds(),millisecond:l.getMilliseconds()}}var ht=Qu({name:"QTime",props:{...Tu,...Wu,...ou,modelValue:{required:!0,validator:l=>typeof l=="string"||l===null},mask:{...ou.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:l=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(l)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:nt,setup(l,{slots:B,emit:v}){const c=Yu(),{$q:o}=c.proxy,i=Ru(l,o),{tabindex:p,headerClass:a,getLocale:A,getCurrentDate:y}=at(l,o),E=Nu(l),_=zu(E);let g,Q;const Y=k(null),H=K(()=>ku()),C=K(()=>A()),D=K(()=>yu()),w=qe(l.modelValue,H.value,C.value,l.calendar,D.value),f=k(gt(w)),r=k(w),F=k(w.hour===null||w.hour<12),L=K(()=>`q-time q-time--${l.landscape===!0?"landscape":"portrait"}`+(i.value===!0?" q-time--dark q-dark":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-time--readonly":"")+(l.bordered===!0?" q-time--bordered":"")+(l.square===!0?" q-time--square no-border-radius":"")+(l.flat===!0?" q-time--flat no-shadow":"")),U=K(()=>{const t=r.value;return{hour:t.hour===null?"--":h.value===!0?Ae(t.hour):String(F.value===!0?t.hour===0?12:t.hour:t.hour>12?t.hour-12:t.hour),minute:t.minute===null?"--":Ae(t.minute),second:t.second===null?"--":Ae(t.second)}}),h=K(()=>l.format24h!==null?l.format24h:o.lang.date.format24h),ke=K(()=>{const t=f.value==="hour",n=t===!0?12:60,b=r.value[f.value];let j=`rotate(${Math.round(b*(360/n))-180}deg) translateX(-50%)`;return t===!0&&h.value===!0&&r.value.hour>=12&&(j+=" scale(.7)"),{transform:j}}),me=K(()=>r.value.hour!==null),X=K(()=>me.value===!0&&r.value.minute!==null),oe=K(()=>l.hourOptions!==void 0?t=>l.hourOptions.includes(t):l.options!==void 0?t=>l.options(t,null,null):null),ye=K(()=>l.minuteOptions!==void 0?t=>l.minuteOptions.includes(t):l.options!==void 0?t=>l.options(r.value.hour,t,null):null),be=K(()=>l.secondOptions!==void 0?t=>l.secondOptions.includes(t):l.options!==void 0?t=>l.options(r.value.hour,r.value.minute,t):null),ee=K(()=>{if(oe.value===null)return null;const t=ge(0,11,oe.value),n=ge(12,11,oe.value);return{am:t,pm:n,values:t.values.concat(n.values)}}),ie=K(()=>ye.value!==null?ge(0,59,ye.value):null),x=K(()=>be.value!==null?ge(0,59,be.value):null),d=K(()=>{switch(f.value){case"hour":return ee.value;case"minute":return ie.value;case"second":return x.value}}),M=K(()=>{let t,n,b=0,q=1;const j=d.value!==null?d.value.values:void 0;f.value==="hour"?h.value===!0?(t=0,n=23):(t=0,n=11,F.value===!1&&(b=12)):(t=0,n=55,q=5);const te=[];for(let V=t,G=t;V<=n;V+=q,G++){const _e=V+b,$u=j!==void 0&&j.includes(_e)===!1,qu=f.value==="hour"&&V===0?h.value===!0?"00":"12":V;te.push({val:_e,index:G,disable:$u,label:qu})}return te}),pe=K(()=>[[tt,bu,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Ie(()=>l.modelValue,t=>{const n=qe(t,H.value,C.value,l.calendar,D.value);(n.dateHash!==r.value.dateHash||n.timeHash!==r.value.timeHash)&&(r.value=n,n.hour===null?f.value="hour":F.value=n.hour<12)}),Ie([H,C],()=>{Ju(()=>{Ke()})});function de(){const t={...y(),..._t()};Ke(t),Object.assign(r.value,t),f.value="hour"}function ge(t,n,b){const q=Array.apply(null,{length:n+1}).map((j,te)=>{const V=te+t;return{index:V,val:b(V)===!0}}).filter(j=>j.val===!0).map(j=>j.index);return{min:q[0],max:q[q.length-1],values:q,threshold:n+1}}function Ze(t,n,b){const q=Math.abs(t-n);return Math.min(q,b-q)}function Qe(t,{min:n,max:b,values:q,threshold:j}){if(t===n)return n;if(t<n||t>b)return Ze(t,n,j)<=Ze(t,b,j)?n:b;const te=q.findIndex(_e=>t<=_e),V=q[te-1],G=q[te];return t-V<=G-t?V:G}function ku(){return l.calendar!=="persian"&&l.mask!==null?l.mask:`HH:mm${l.withSeconds===!0?":ss":""}`}function yu(){if(typeof l.defaultDate!="string"){const t=y(!0);return t.dateHash=ot(t),t}return qe(l.defaultDate,"YYYY/MM/DD",void 0,l.calendar)}function Te(){return Xu(c)===!0||d.value!==null&&(d.value.values.length===0||f.value==="hour"&&h.value!==!0&&ee.value[F.value===!0?"am":"pm"].values.length===0)}function We(){const t=Y.value,{top:n,left:b,width:q}=t.getBoundingClientRect(),j=q/2;return{top:n+j,left:b+j,dist:j*.7}}function bu(t){if(Te()!==!0){if(t.isFirst===!0){g=We(),Q=Be(t.evt,g);return}Q=Be(t.evt,g,Q),t.isFinal===!0&&(g=!1,Q=null,eu())}}function eu(){f.value==="hour"?f.value="minute":l.withSeconds&&f.value==="minute"&&(f.value="second")}function Be(t,n,b){const q=Ku(t),j=Math.abs(q.top-n.top),te=Math.sqrt(Math.pow(Math.abs(q.top-n.top),2)+Math.pow(Math.abs(q.left-n.left),2));let V,G=Math.asin(j/te)*(180/Math.PI);if(q.top<n.top?G=n.left<q.left?90-G:270+G:G=n.left<q.left?G+90:270-G,f.value==="hour"){if(V=G/30,ee.value!==null){const _e=h.value!==!0?F.value===!0:ee.value.am.values.length!==0&&ee.value.pm.values.length!==0?te>=n.dist:ee.value.am.values.length!==0;V=Qe(V+(_e===!0?0:12),ee.value[_e===!0?"am":"pm"])}else V=Math.round(V),h.value===!0?te<n.dist?V<12&&(V+=12):V===12&&(V=0):F.value===!0&&V===12?V=0:F.value===!1&&V!==12&&(V+=12);h.value===!0&&(F.value=V<12)}else V=Math.round(G/6)%60,f.value==="minute"&&ie.value!==null?V=Qe(V,ie.value):f.value==="second"&&x.value!==null&&(V=Qe(V,x.value));return b!==V&&Bu[f.value](V),V}const Re={hour(){f.value="hour"},minute(){f.value="minute"},second(){f.value="second"}};function Au(t){t.keyCode===13&&uu()}function Cu(t){t.keyCode===13&&tu()}function wu(t){Te()!==!0&&(o.platform.is.desktop!==!0&&Be(t,We()),eu())}function Du(t){Te()!==!0&&Be(t,We())}function xu(t){if(t.keyCode===13)f.value="hour";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(ee.value!==null){const b=h.value===!0?ee.value.values:ee.value[F.value===!0?"am":"pm"].values;if(b.length===0)return;if(r.value.hour===null)Ee(b[0]);else{const q=(b.length+b.indexOf(r.value.hour)+n)%b.length;Ee(b[q])}}else{const b=h.value===!0?24:12,q=h.value!==!0&&F.value===!1?12:0,j=r.value.hour===null?-n:r.value.hour;Ee(q+(24+j+n)%b)}}}function Vu(t){if(t.keyCode===13)f.value="minute";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(ie.value!==null){const b=ie.value.values;if(b.length===0)return;if(r.value.minute===null)Me(b[0]);else{const q=(b.length+b.indexOf(r.value.minute)+n)%b.length;Me(b[q])}}else{const b=r.value.minute===null?-n:r.value.minute;Me((60+b+n)%60)}}}function Su(t){if(t.keyCode===13)f.value="second";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(x.value!==null){const b=x.value.values;if(b.length===0)return;if(r.value.seconds===null)$e(b[0]);else{const q=(b.length+b.indexOf(r.value.second)+n)%b.length;$e(b[q])}}else{const b=r.value.second===null?-n:r.value.second;$e((60+b+n)%60)}}}function Ee(t){r.value.hour!==t&&(r.value.hour=t,we())}function Me(t){r.value.minute!==t&&(r.value.minute=t,we())}function $e(t){r.value.second!==t&&(r.value.second=t,we())}const Bu={hour:Ee,minute:Me,second:$e};function uu(){F.value===!1&&(F.value=!0,r.value.hour!==null&&(r.value.hour-=12,we()))}function tu(){F.value===!0&&(F.value=!1,r.value.hour!==null&&(r.value.hour+=12,we()))}function Ne(t){const n=l.modelValue;f.value!==t&&n!==void 0&&n!==null&&n!==""&&typeof n!="string"&&(f.value=t)}function we(){if(oe.value!==null&&oe.value(r.value.hour)!==!0){r.value=qe(),Ne("hour");return}if(ye.value!==null&&ye.value(r.value.minute)!==!0){r.value.minute=null,r.value.second=null,Ne("minute");return}if(l.withSeconds===!0&&be.value!==null&&be.value(r.value.second)!==!0){r.value.second=null,Ne("second");return}r.value.hour===null||r.value.minute===null||l.withSeconds===!0&&r.value.second===null||Ke()}function Ke(t){const n=Object.assign({...r.value},t),b=l.calendar==="persian"?Ae(n.hour)+":"+Ae(n.minute)+(l.withSeconds===!0?":"+Ae(n.second):""):it(new Date(n.year,n.month===null?null:n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond),H.value,C.value,n.year,n.timezoneOffset);n.changed=b!==l.modelValue,v("update:modelValue",b,n)}function Eu(){const t=[R("div",{class:"q-time__link "+(f.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onClick:Re.hour,onKeyup:xu},U.value.hour),R("div",":"),R("div",me.value===!0?{class:"q-time__link "+(f.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onKeyup:Vu,onClick:Re.minute}:{class:"q-time__link"},U.value.minute)];l.withSeconds===!0&&t.push(R("div",":"),R("div",X.value===!0?{class:"q-time__link "+(f.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onKeyup:Su,onClick:Re.second}:{class:"q-time__link"},U.value.second));const n=[R("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},t)];return h.value===!1&&n.push(R("div",{class:"q-time__header-ampm column items-between no-wrap"},[R("div",{class:"q-time__link "+(F.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onClick:uu,onKeyup:Au},"AM"),R("div",{class:"q-time__link "+(F.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onClick:tu,onKeyup:Cu},"PM")])),R("div",{class:"q-time__header flex flex-center no-wrap "+a.value},n)}function Mu(){const t=r.value[f.value];return R("div",{class:"q-time__content col relative-position"},[R(Gu,{name:"q-transition--scale"},()=>R("div",{key:"clock"+f.value,class:"q-time__container-parent absolute-full"},[R("div",{ref:Y,class:"q-time__container-child fit overflow-hidden"},[je(R("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:wu,onMousedown:Du},[R("div",{class:"q-time__clock-circle fit"},[R("div",{class:"q-time__clock-pointer"+(r.value[f.value]===null?" hidden":l.color!==void 0?` text-${l.color}`:""),style:ke.value}),M.value.map(n=>R("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${n.index}`+(n.val===t?" q-time__clock-position--active "+a.value:n.disable===!0?" q-time__clock-position--disable":"")},[R("span",n.label)]))])]),pe.value)])])),l.nowBtn===!0?R(J,{class:"q-time__now-button absolute",icon:o.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:l.color,textColor:l.textColor,tabindex:p.value,onClick:de}):null])}return c.proxy.setNow=de,()=>{const t=[Mu()],n=ju(B.default);return n!==void 0&&t.push(R("div",{class:"q-time__actions"},n)),l.name!==void 0&&l.disable!==!0&&_(t,"push"),R("div",{class:L.value,tabindex:-1},[Eu(),R("div",{class:"q-time__main col overflow-auto"},t)])}}});const kt={class:"q-pa-md",style:{"max-width":"300px",padding:"0"}},yt={class:"row items-center justify-end"},bt={class:"row items-center justify-end"},At={__name:"DateTime",props:{evDateTime:k("2019-02-01 12:44")},emits:["update:date"],setup(l,{emit:B}){const v=ne("Announce");return k(l.evDateTime),(o,i)=>(m(),W("div",kt,[e(re,{filled:"",modelValue:s(v).eventTime,"onUpdate:modelValue":i[2]||(i[2]=p=>s(v).eventTime=p),mask:"####-##-## ##:##"},{prepend:u(()=>[e(De,{name:"event",class:"cursor-pointer"},{default:u(()=>[e(iu,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:u(()=>[e(st,{modelValue:s(v).eventTime,"onUpdate:modelValue":i[0]||(i[0]=p=>s(v).eventTime=p),mask:"YYYY-MM-DD HH:mm"},{default:u(()=>[N("div",yt,[je(e(J,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[su]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:u(()=>[e(De,{name:"access_time",class:"cursor-pointer"},{default:u(()=>[e(iu,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:u(()=>[e(ht,{modelValue:s(v).eventTime,"onUpdate:modelValue":i[1]||(i[1]=p=>s(v).eventTime=p),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:u(()=>[N("div",bt,[je(e(J,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[su]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},Ct={__name:"WorkSelectItem",props:{work:Object},setup(l){const B=ae();return(v,c)=>(m(),I(z,{clickable:"",dense:""},{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[S(P(l.work.titleRu),1)]),_:1}),e(O,{caption:""},{default:u(()=>[S(P(l.work.titleEn),1)]),_:1})]),_:1}),e($,{side:"",class:"opus"},{default:u(()=>[e(O,{caption:""},{default:u(()=>{var o;return[S(P((o=l.work.opus)!=null?o:"Op.?"),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var o;return[S(P((o=l.work.icatno)!=null?o:"cat\u2116.?"),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var o;return[S(P((o=l.work.catalogIndex)!=null?o:"catIdx: ?"),1)]}),_:1}),T("",!0)]),_:1})]),_:1}))}},wt=fe({__name:"WorkSelect",props:{works:{},loading:{type:Boolean}},emits:["onSelect"],setup(l,{emit:B}){const v=k(),c=B,o=l,i=k([...o.works]);Zu(()=>{i.value=[...o.works],console.log("works updated"),v.value=void 0});function p(a,A,y){A(()=>{if(!a){i.value=[...o.works];return}const E=a.toLowerCase();let _=[...o.works];a&&(_=_.filter(g=>(g.titleRu?g.titleRu.toLowerCase().includes(E):!1)||(g.titleEn?g.titleEn.toLowerCase().includes(E):!1))),i.value=_})}return(a,A)=>(m(),I(Se,{modelValue:v.value,"onUpdate:modelValue":[A[0]||(A[0]=y=>v.value=y),A[1]||(A[1]=y=>c("onSelect",v.value))],options:i.value,loading:a.loading,"option-label":"titleRu","option-value":"id","map-options":"","use-input":"",onFilter:p,clearable:"",label:"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0435"},{option:u(y=>[e(Ct,vu(y.itemProps,{work:y.opt}),null,16,["work"])]),_:1},8,["modelValue","options","loading"]))}}),Dt=fe({__name:"AddWorkDialog",props:{announce:{type:Object,required:!0}},emits:["workSelected","onAddWork"],setup(l,{emit:B}){const v=ae(),c=ne("isOpenAddWorkDialog"),o=k(!1),i=k(),p=k(),a=B,A=l,y=k([]),E=k([]);function _(w){p.value=w,w&&(a("workSelected",w),Y(w.id))}function g(w){var f;i.value=w,p.value=void 0,y.value=[],(f=i.value)!=null&&f.id&&Q(i.value.id)}async function Q(w){o.value=!0,y.value=await he.getListByAuthor(v,w),o.value=!1}async function Y(w){o.value=!0,E.value=await Je.getList(v,w),o.value=!1}async function H(){o.value=!0,await he.linkToAnnounce(v,A.announce.id,p.value.id)&&(a("onAddWork",p.value),C()),o.value=!1}function C(){c.value=!1}function D(){i.value=void 0,p.value=void 0,o.value=!1}return(w,f)=>(m(),I(Xe,{modelValue:s(c),"onUpdate:modelValue":f[0]||(f[0]=r=>Fe(c)?c.value=r:null),onBeforeHide:D},{default:u(()=>[e(xe,{bordered:"",class:"dialogArea"},{default:u(()=>[e(ue,null,{default:u(()=>[e(ft,{onItSel:g})]),_:1}),i.value?(m(),I(ue,{key:0},{default:u(()=>[e(wt,{works:y.value,onOnSelect:_},null,8,["works"])]),_:1})):T("",!0),e(ve,{align:"between"},{default:u(()=>[e(Le),e(J,{"icon-right":"save",color:"green",loading:o.value,onClick:H,label:"\u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",flat:""},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),xt=fe({__name:"SuggestSelect",emits:["saved"],setup(l,{emit:B}){const v=ae(),c=String("https://sakh-orch.ru/api/"),o=String("https://sakh-orch.ru/stapi/"),i=k(""),p=k(null),a=k([{title:{text:"\u0421\u0430\u0445\u0430\u043B\u0438\u043D\u0441\u043A\u0438\u0439 \u043C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u044B\u0439 \u0442\u0435\u0430\u0442\u0440\u0430\u043B\u044C\u043D\u044B\u0439 \u0446\u0435\u043D\u0442\u0440 \u0438\u043C\u0435\u043D\u0438 \u0410\u043D\u0442\u043E\u043D\u0430 \u041F\u0430\u0432\u043B\u043E\u0432\u0438\u0447\u0430 \u0427\u0435\u0445\u043E\u0432\u0430",hl:[{begin:26,end:31}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u043E\u043C\u043C\u0443\u043D\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442, 35",hl:[{begin:0,end:5}]},tags:["business","theatre","museum","concert hall"],distance:{value:1178.70231,text:"1.18 \u043A\u043C"}},{title:{text:"\u0421\u0430\u0445\u0430\u043B\u0438\u043D\u0441\u043A\u0438\u0439 \u0442\u0435\u0430\u0442\u0440 \u043A\u0443\u043A\u043E\u043B",hl:[{begin:12,end:17}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u043E\u043C\u043C\u0443\u043D\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442, 28\u0410",hl:[{begin:0,end:5}]},tags:["business","theatre","office service"],distance:{value:1224.330864,text:"1.22 \u043A\u043C"}},{title:{text:"\u041C\u043E\u0441\u043A\u043E\u0432\u0441\u043A\u0438\u0439 \u0434\u0440\u0430\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0442\u0435\u0430\u0442\u0440 \u0438\u043C\u0435\u043D\u0438 \u041C. \u041D. \u0415\u0440\u043C\u043E\u043B\u043E\u0432\u043E\u0439",hl:[{begin:25,end:30}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041C\u043E\u0441\u043A\u0432\u0430, \u0422\u0432\u0435\u0440\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 5/6",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:6655148389e-3,text:"6655.15 \u043A\u043C"}},{title:{text:"\u0422\u0430\u0442\u0430\u0440\u0441\u043A\u0438\u0439 \u0433\u043E\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0439 \u0442\u0435\u0430\u0442\u0440 \u043A\u0443\u043A\u043E\u043B \u042D\u043A\u0438\u044F\u0442",hl:[{begin:26,end:31}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u0430\u0437\u0430\u043D\u044C, \u041F\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 57",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:6077098052e-3,text:"6077.10 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440 \u0434\u0440\u0430\u043C\u044B \u0438 \u043A\u043E\u043C\u0435\u0434\u0438\u0438",hl:[{begin:0,end:5}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041F\u0435\u0442\u0440\u043E\u043F\u0430\u0432\u043B\u043E\u0432\u0441\u043A-\u041A\u0430\u043C\u0447\u0430\u0442\u0441\u043A\u0438\u0439, \u041B\u0435\u043D\u0438\u043D\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 75",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:1321394665e-3,text:"1321.39 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440 \u041A\u043E\u043B\u0435\u0441\u043E",hl:[{begin:0,end:5}]},subtitle:{text:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0433\u043E \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\u0430 \xB7 \u0422\u043E\u043B\u044C\u044F\u0442\u0442\u0438, \u041B\u0435\u043D\u0438\u043D\u0433\u0440\u0430\u0434\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 33\u0410\u04411"},tags:["business","bus stop"],distance:{value:6203127608e-3,text:"6203.13 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440\u0430\u043B\u044C\u043D\u0430\u044F",hl:[{begin:0,end:5}]},subtitle:{text:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0433\u043E \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\u0430 \xB7 \u0421\u043E\u0447\u0438, \u0410-147"},tags:["business","bus stop"],distance:{value:7445799203e-3,text:"7445.80 \u043A\u043C"}}]),A=k([...a.value]),y=B;function E(H,C){if(!H){A.value=[];return}C(()=>{_(H)})}function _(H){const C="https://suggest-maps.yandex.ru/v1/suggest";Pu.get(C,{params:{apikey:i.value,text:H,ull:"142.728060,46.966085",print_address:1,strict_bounds:1,attrs:"uri"},withCredentials:!1,headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(D=>{var f;if(!((f=D==null?void 0:D.data)!=null&&f.results))return;const w=D.data.results;w.forEach((r,F)=>{r.label=r.address.formatted_address,r.value=F}),A.value=w}).catch(D=>{console.error(D),v.notify(Ce(D))})}function g(){Oe.post(c+"epoint/ya/suggest.php",{params:{method:"add",suggest:p.value}}).then(H=>{var C;if(!((C=H==null?void 0:H.data)!=null&&C.result))throw new Error;y("saved",H.data.data.id)}).catch(H=>{v.notify(Ce(H))})}function Q(){!p.value||g()}function Y(){const H=o+"epoint/ya/suggest.php",C={method:"getApiKey"};Oe.post(H,{params:C}).then(D=>{var w;if(!((w=D==null?void 0:D.data)!=null&&w.result))throw new Error("SuggestApiKey Error");i.value=D.data.data.key}).catch(D=>{console.error(D),v.notify(Ce(D))})}return Ve(()=>{Y()}),(H,C)=>i.value?(m(),I(Se,{key:0,modelValue:p.value,"onUpdate:modelValue":[C[0]||(C[0]=D=>p.value=D),Q],options:A.value,"use-input":"","fill-input":"","hide-selected":"",clearable:"",onFilter:E},{option:u(D=>[e(z,fu(mu(D.itemProps)),{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[S(P(D.opt.title.text),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>{var w,f;return[S(P((f=(w=D.opt)==null?void 0:w.address)==null?void 0:f.formatted_address),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])):T("",!0)}}),Vt={class:"text-h6"},St=fe({__name:"HallDialog",setup(l){const B=ae(),v=ne("clickedHall"),c=ne("IsHallDialogOpen"),o=k(!1);pu(()=>{});async function i(){o.value=!0,await v.value.save(B)&&(ce.List.value=await ce.getList(B),c.value=!1),o.value=!1}function p(E){v.value.suggestId=E}function a(){v.value||(v.value=new ce)}function A(){}async function y(E){o.value=!0,await E.del(B)&&(c.value=!1),o.value=!1}return(E,_)=>(m(),I(Xe,{modelValue:s(c),"onUpdate:modelValue":_[3]||(_[3]=g=>Fe(c)?c.value=g:null),onBeforeShow:a,onBeforeHide:A},{default:u(()=>[e(xe,{bordered:"",class:"dialogArea"},{default:u(()=>[e($,null,{default:u(()=>[N("div",Vt,P(s(v).id>0?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0437\u0430\u043B":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043B"),1)]),_:1}),e(ue,null,{default:u(()=>[e(re,{modelValue:s(v).name,"onUpdate:modelValue":_[0]||(_[0]=g=>s(v).name=g),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435","stack-label":""},null,8,["modelValue"]),s(v).id===-1?(m(),I(xt,{key:0,onSaved:p})):(m(),I(z,{key:1},{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>{var g,Q,Y;return[S(P((Y=(Q=(g=s(v))==null?void 0:g.suggest)==null?void 0:Q.address)==null?void 0:Y.formatted),1)]}),_:1})]),_:1})]),_:1}))]),_:1}),e(ve,null,{default:u(()=>[e(Le),s(v).id>0?(m(),I(Pe,{key:0,label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",loading:o.value,"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B",danger:"",onOnOk:_[1]||(_[1]=g=>y(s(v)))},null,8,["loading"])):T("",!0),e(J,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",disable:!s(v).suggestId,loading:o.value,color:"green",onClick:_[2]||(_[2]=g=>i())},null,8,["disable","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Bt=fe({__name:"HallSelect",emits:["selected"],setup(l,{emit:B}){const v=ae(),c=ne("selectedHall"),o=k(!1),i=k(!1);le("IsHallDialogOpen",o);const p=k(),a=B;function A(g=null){g||(g=new ce),_.value=new ce(g),o.value=!0}function y(){_.value=c.value,a("selected",c.value)}async function E(g){i.value=!0,await g.del(v)&&(o.value=!1),i.value=!1}const _=k(new ce);return le("clickedHall",_),Ve(()=>{}),(g,Q)=>{var Y,H;return m(),W(Z,null,[e(Se,{modelValue:s(c),"onUpdate:modelValue":[Q[1]||(Q[1]=C=>Fe(c)?c.value=C:null),Q[2]||(Q[2]=C=>y())],label:"\u041C\u0435\u0441\u0442\u043E \u043F\u0440\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F","map-options":"","option-label":"name","option-value":"id",options:(H=(Y=s(ce).List)==null?void 0:Y.value)!=null?H:[],ref_key:"selRef",ref:p},{append:u(()=>[e(J,{icon:"add",round:"",onClick:Q[0]||(Q[0]=Ye(C=>A(),["prevent","stop"]))},{default:u(()=>[e(_u,null,{default:u(()=>Q[3]||(Q[3]=[S("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043B")])),_:1})]),_:1})]),option:u(C=>[e(z,fu(mu(C.itemProps)),{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[S(P(C.opt.name),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[S(P(C.opt.suggest.address.formatted),1)]),_:2},1024)]),_:2},1024),e($,{side:""},{default:u(()=>[e(Pe,{danger:"","throw-confirm":"",flat:"",loading:i.value,tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B: "+C.opt.name,onOnOk:D=>E(C.opt)},null,8,["loading","title","onOnOk"])]),_:2},1024),e($,{side:""},{default:u(()=>[e(J,{icon:"edit",flat:"",onClick:Ye(D=>A(C.opt),["prevent","stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),e(St)],64)}}}),Et=fe({__name:"AnnounceSelect",props:{announces:{}},emits:["onSelect"],setup(l,{emit:B}){const v=B,c=k();return(o,i)=>(m(),I(Se,{modelValue:c.value,"onUpdate:modelValue":[i[0]||(i[0]=p=>c.value=p),i[1]||(i[1]=p=>v("onSelect",c.value))],options:o.announces,"map-options":"","option-value":"id","option-label":"progName"},{option:u(p=>{var a;return[e(z,vu(p.itemProps,{id:`an${(a=p.opt)==null?void 0:a.id}`}),{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[S(P(p.opt.eventTime),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[S(P(p.opt.Hall.name),1)]),_:2},1024),e(O,null,{default:u(()=>[S(P(p.opt.progName),1)]),_:2},1024)]),_:2},1024)]),_:2},1040,["id"])]}),_:1},8,["modelValue","options"]))}}),Mt=fe({__name:"WorkBatchAddDialog",props:{targetAnnounceId:{}},emits:["onBatchAddWorks"],setup(l,{emit:B}){const v=ae(),c=ne("isOpenBatchAddDialog"),o=k(!1),i=l,p=B,a=k(),A=k([]),y=k([]);function E(){c.value=!1}function _(){y.value=[],a.value=[],A.value=[],o.value=!1}async function g(){o.value=!0,a.value=await Ue.getList(v),o.value=!1}async function Q(f){o.value=!0,A.value=await he.getListByAnnounce(v,f),o.value=!1}function Y(f){!f||Q(f.id)}async function H(){o.value=!0,await he.linkListToAnnounce(v,i.targetAnnounceId,y.value)&&(p("onBatchAddWorks"),E()),o.value=!1}function C(){y.value=A.value.map(f=>f.id)}function D(){y.value=[]}const w=K(()=>A.value.length?A.value.length===y.value.length:!1);return Ve(()=>{g()}),(f,r)=>(m(),I(Xe,{modelValue:s(c),"onUpdate:modelValue":r[1]||(r[1]=F=>Fe(c)?c.value=F:null),onBeforeHide:_},{default:u(()=>[e(xe,{bordered:"",class:"dialogArea"},{default:u(()=>[e(ue,null,{default:u(()=>[e(Et,{announces:a.value,onOnSelect:Y},null,8,["announces"])]),_:1}),A.value.length?(m(),I(ue,{key:0},{default:u(()=>[e(z,null,{default:u(()=>[e($,null,{default:u(()=>[w.value?T("",!0):(m(),I(J,{key:0,label:"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0432\u0441\u0435",onClick:C})),w.value?(m(),I(J,{key:1,label:"\u0421\u043D\u044F\u0442\u044C \u0432\u0441\u0435",onClick:D})):T("",!0)]),_:1})]),_:1}),(m(!0),W(Z,null,He(A.value,F=>(m(),I(z,{key:`add_work${F.id}`,tag:"label"},{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[S(P(F.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[S(P(F.titleRu),1)]),_:2},1024)]),_:2},1024),e($),e($,{side:""},{default:u(()=>[e(ze,{modelValue:y.value,"onUpdate:modelValue":r[0]||(r[0]=L=>y.value=L),val:F.id},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):T("",!0),e(ve,{align:"right"},{default:u(()=>[e(J,{icon:"save",flat:"",color:"green",disable:!y.value.length,onClick:H,label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),$t=fe({__name:"WorkList",props:{announce:{type:Object,required:!0}},setup(l){const B=ae(),v=l,c=k(!1),o=k(!1);le("isOpenAddWorkDialog",o);const i=k(!1);le("isOpenBatchAddDialog",i);const p=k([]),a=k([]),A=k([]),y=k(!1);function E(L){const U=L.map(h=>h.id);A.value=Array.from(new Set([...A.value,...U]))}function _(L){const U=L.map(h=>h.id);A.value=A.value.filter(h=>!U.includes(h))}function g(L){return L.every(U=>A.value.includes(U.id))}function Q(L){g(L)?_(L):E(L)}const Y=k({});function H(L){Y.value[L.id]=K({get(){return g(L.children)},set(U){Q(L.children)}})}async function C(){c.value=!0;const L=v.announce.id;p.value=await he.getListByAnnounce(B,L),p.value.length&&(await D(),p.value.forEach(U=>H(U))),c.value=!1}async function D(){c.value=!0;const L=v.announce.id;a.value=await Je.getListByAnnounce(B,L),A.value=a.value.map(U=>U.id),c.value=!1}async function w(){c.value=!0,await Je.linkListToAnnounce(B,v.announce.id,A.value),c.value=!1}async function f(L){c.value=!0,await he.unlinkFromAnnounce(B,v.announce.id,L)&&await C(),c.value=!1}async function r(L,U){c.value=!0,await he.moveSortInAnnounce(B,L,U,v.announce.id)&&await C(),c.value=!1}function F(){C(),y.value=!1}return Ve(async()=>{await mt.initList(B),await C()}),(L,U)=>(m(),W(Z,null,[e(xe,null,{default:u(()=>[e(ve,{align:"between"},{default:u(()=>[y.value?(m(),I(J,{key:0,icon:"add",label:"\u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C",onClick:U[0]||(U[0]=h=>o.value=!0),loading:c.value},null,8,["loading"])):T("",!0),y.value?(m(),I(J,{key:1,icon:"add",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432\u0441\u0435 \u0438\u0437 \u0434\u0440\u0443\u0433\u043E\u0433\u043E \u043A\u043E\u043D\u0446\u0435\u0440\u0442\u0430",onClick:U[1]||(U[1]=h=>i.value=!0),loading:c.value},null,8,["loading"])):T("",!0),e(Le),e(J,{icon:"edit",flat:"",round:"",onClick:U[2]||(U[2]=Ye(h=>y.value=!y.value,["stop","prevent"])),color:y.value?"red":"gray"},null,8,["color"])]),_:1}),e(ue,null,{default:u(()=>[e(du,null,{default:u(()=>[(m(!0),W(Z,null,He(p.value,(h,ke)=>{var me;return m(),W(Z,{key:`w${h.id}`},[(me=h==null?void 0:h.children)!=null&&me.length?(m(),I(hu,{key:0,"content-inset-level":.1,"expand-separator":""},{header:u(()=>[e(z,{style:{width:"100%"},class:"no-padding"},{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(O,{caption:""},{default:u(()=>[S(P(h.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[S(P(h.titleRu),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),default:u(()=>[e(du,null,{default:u(()=>[y.value?(m(),I(z,{key:0,tag:"label"},{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[S(P(g(h.children)?"\u0421\u043D\u044F\u0442\u044C \u0432\u0441\u0435":"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0432\u0441\u0435"),1)]),_:2},1024)]),_:2},1024),e($,{side:""},{default:u(()=>[e(ze,{modelValue:Y.value[h.id],"onUpdate:modelValue":[X=>Y.value[h.id]=X,w],disable:c.value,"keep-color":"",color:"green"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:2},1024)]),_:2},1024)):T("",!0),(m(!0),W(Z,null,He(h.children,X=>(m(),I(z,{key:`ch${X.id}`,tag:"label"},{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(O,null,{default:u(()=>[S(P(X.num),1)]),_:2},1024)]),_:2},1024),e($,null,{default:u(()=>[e(O,null,{default:u(()=>[S(P(X.title),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[S(P(X.caption),1)]),_:2},1024)]),_:2},1024),e($,{side:""},{default:u(()=>[e(ze,{modelValue:A.value,"onUpdate:modelValue":[U[3]||(U[3]=oe=>A.value=oe),w],disable:!y.value,val:X.id},null,8,["modelValue","disable","val"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):(m(),I(z,{key:1},{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[S(P(h.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[S(P(h.titleRu),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),y.value?(m(),W(Z,{key:2},[e(z,null,{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(ru,{disable:ke<1,onOnClick:X=>r("up",h.id),direction:"up"},null,8,["disable","onOnClick"])]),_:2},1024),e($,{avatar:""},{default:u(()=>[e(ru,{disable:ke>=p.value.length-1,onOnClick:X=>r("down",h.id),direction:"down"},null,8,["disable","onOnClick"])]),_:2},1024),e($),e($,{side:""},{default:u(()=>[e(Pe,{flat:"","throw-confirm":"",danger:"",onOnOk:X=>f(h.id),loading:c.value,title:`\u0423\u0434\u0430\u043B\u0438\u0442\u044C: ${h.titleRu}`},null,8,["onOnOk","loading","title"])]),_:2},1024)]),_:2},1024),e(se)],64)):T("",!0)],64)}),128))]),_:1})]),_:1})]),_:1}),e(Dt,{announce:l.announce,onOnAddWork:C},null,8,["announce"]),e(Mt,{"target-announce-id":l.announce.id,onOnBatchAddWorks:F},null,8,["target-announce-id"])],64))}});const qt={key:0,class:"eventsarea"},Ot={class:"editArea"},It={key:0,class:"card"},Ht={class:"editor"},Ut={style:{display:"flex","justify-content":"space-between"}},Ft={key:0,class:"uploads"},Lt={style:{width:"100%"}},Pt={class:"uploads"},Qt={__name:"AnnounceEditor",emits:["reload","posterUploaded"],setup(l,{expose:B,emit:v}){const c=String("https://sakh-orch.ru/api/"),o=ae(),i=gu(),p=et(),a=ne("Announce"),A=k(a.value.Hall);le("selectedHall",A);function y(x){console.log(x),a.value.hallId=x.id,a.value.Hall=x}const E=k("");le("pwUrl",E);const _=v,g={};function Q(){}const Y=[{label:"\u0412\u0445\u043E\u0434 \u0441\u0432\u043E\u0431\u043E\u0434\u043D\u044B\u0439",value:2},{label:"\u0411\u0438\u043B\u0435\u0442\u044B \u0432 \u043F\u0440\u043E\u0434\u0430\u0436\u0435",value:3},{label:"\u0412\u0445\u043E\u0434 \u043F\u043E \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C",value:4},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",value:5}],H=k(null),C=k(null),D=k(!1);le("loadingAuthors",D);const w=k(0);le("selectedAuthorId",w);const f=k(null);le("selectedAuthor",f),Ie(w,()=>{f.value=AuthorSelectList.value.find(x=>x.id===w.value)});function r(x){return{url:c+"epoint/event/poster.php",headers:[{name:"ACCESSTOKEN",value:vt.self.AccessToken}],formFields:[{name:"id",value:a.value.id},{name:"method",value:"add"}]}}function F(x){o.notify(lu("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),_("posterUploaded")}function L(x){o.notify(lu("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),_("posterUploaded"),H.value.reset(),U.value=!0}const U=k(!1);let h=null;Ie(U,x=>{console.log("photoWatcher"),x&&!h?h=setInterval(ee,3e3):!x&&h&&(clearInterval(h),h=null)});function ke(x){var M,pe,de;let d=(de=(pe=JSON.parse((M=x==null?void 0:x.xhr)==null?void 0:M.response))==null?void 0:pe.error)!=null?de:"";o.notify(Ce(null,d))}function me(){Ue.save(o,a.value)}function X(){p.push({path:"/announces"})}function oe(){_("reload")}function ye(){delete a.value.sketch,delete a.value.sketchId}async function be(){const x=await Ue.updateMarkdown(o,a.value.id,a.value.description);x&&(a.value.parsedMD=x)}function ee(){Oe.post(c+"epoint/event/poster.php",{params:{method:"get",announceId:i.params.evid}}).then(x=>{var d,M,pe,de,ge;if(!((d=x==null?void 0:x.data)!=null&&d.result))throw new Error;a.value.poster=(pe=(M=x==null?void 0:x.data)==null?void 0:M.data)!=null?pe:null,((ge=(de=a.value)==null?void 0:de.poster)==null?void 0:ge.status)!=="process"&&(U.value=!1)}).catch(x=>{U.value=!1,o.notify(Ce(x))}).finally(()=>{})}const ie=k(!1);return B({}),pu(()=>{}),ut(()=>{h&&clearInterval(h)}),(x,d)=>(m(),W(Z,null,[s(a)?(m(),W("div",qt,[N("div",Ot,[s(o).platform.is.desktop?(m(),W("div",It,[s(a).Hall?(m(),I(dt,{key:0,onIamDeleted:X,onNewAnnounce:oe,onDelSketch:ye,ref_key:"rAnnounceCard",ref:C,announce:s(a),pwUrl:E.value},null,8,["announce","pwUrl"])):T("",!0)])):T("",!0),N("div",Ht,[N("div",Ut,[e(At,{date:s(a).eventTime,"onUpdate:date":[d[0]||(d[0]=M=>s(a).eventTime=M),d[1]||(d[1]=M=>void 0)]},null,8,["date"])]),d[19]||(d[19]=N("br",null,null,-1)),d[20]||(d[20]=N("hr",null,null,-1)),s(o).platform.is.desktop?(m(),W("div",Ft,[N("div",Lt,[e(rt,{id:s(a).id,type:"event",onOnUploaded:F},null,8,["id"])])])):(m(),I(z,{key:1},{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>d[14]||(d[14]=[S(" \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u044D\u0441\u043A\u0438\u0437\u0430 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0435 \u0443\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u0430 ")])),_:1})]),_:1})]),_:1})),e(se,{spaced:"1em"}),e(re,{name:"progName",modelValue:s(a).progName,"onUpdate:modelValue":d[2]||(d[2]=M=>s(a).progName=M),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),e(Bt,{onSelected:y}),e(Se,{modelValue:s(a).pay,"onUpdate:modelValue":d[3]||(d[3]=M=>s(a).pay=M),"emit-value":"","map-options":"",label:"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0432\u0445\u043E\u0434\u0430",options:Y},null,8,["modelValue"]),d[21]||(d[21]=N("br",null,null,-1)),[3,4].includes(s(a).pay)?(m(),W(Z,{key:2},[e(re,{type:"text",modelValue:s(a).ticketLink,"onUpdate:modelValue":d[4]||(d[4]=M=>s(a).ticketLink=M),label:"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435 \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"]),d[16]||(d[16]=N("br",null,null,-1)),e(re,{modelValue:s(a).radarioEventId,"onUpdate:modelValue":d[5]||(d[5]=M=>s(a).radarioEventId=M),type:"number","stack-label":"",placeholder:"1234567",label:"ID \u043C\u0435\u0440\u043E\u043F\u0440\u0438\u044F\u0442\u0438\u044F \u043D\u0430 Radario"},{default:u(()=>[e(_u,null,{default:u(()=>d[15]||(d[15]=[S("\u0426\u0438\u0444\u0440\u044B \u0432 \u043A\u043E\u043D\u0446\u0435 \u0441\u0441\u044B\u043B\u043A\u0438 \u043D\u0430 \u043F\u043E\u043A\u0443\u043F\u043A\u0443 \u0431\u0438\u043B\u0435\u0442\u043E\u0432")])),_:1})]),_:1},8,["modelValue"]),d[17]||(d[17]=N("br",null,null,-1)),e(ve,null,{default:u(()=>[e(au,{modelValue:s(a).isPushkin,"onUpdate:modelValue":d[6]||(d[6]=M=>s(a).isPushkin=M),label:"\u041F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430",color:"green"},null,8,["modelValue"]),e(Le),e(au,{modelValue:s(a).isShowTicketCount,"onUpdate:modelValue":d[7]||(d[7]=M=>s(a).isShowTicketCount=M),color:"green",label:"\u041E\u0441\u0442\u0430\u0442\u043E\u043A \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"])]),_:1}),d[18]||(d[18]=N("br",null,null,-1))],64)):T("",!0),e(re,{type:"number",modelValue:s(a).age,"onUpdate:modelValue":d[8]||(d[8]=M=>s(a).age=M),label:"\u0412\u043E\u0437\u0440\u0430\u0441\u0442\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"},null,8,["modelValue"]),d[22]||(d[22]=N("br",null,null,-1)),e(se,{spaced:""}),e(re,{name:"evDescr",modelValue:s(a).sdescr,"onUpdate:modelValue":d[9]||(d[9]=M=>s(a).sdescr=M),type:"textarea",autogrow:"",label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),d[23]||(d[23]=N("br",null,null,-1)),e(re,{name:"evText",modelValue:s(a).description,"onUpdate:modelValue":[d[10]||(d[10]=M=>s(a).description=M),d[11]||(d[11]=M=>be())],type:"textarea",autogrow:"",debounce:300,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),e(se,{spaced:"1em"}),N("div",Pt,[e(lt,{modelValue:g,"onUpdate:modelValue":d[12]||(d[12]=M=>g=M),style:{width:"100%"},label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",factory:r,ref_key:"posterUploader",ref:H,onUploaded:L,onFailed:ke,"no-thumbnails":""},null,512)]),e(ve,{align:"right"},{default:u(()=>[e(J,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:me,color:"green","icon-right":"save",flat:""})]),_:1})]),e(se,{spaced:"1em"})])])):T("",!0),e(se),e(hu,{label:"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0439",modelValue:ie.value,"onUpdate:modelValue":d[13]||(d[13]=M=>ie.value=M)},{default:u(()=>[ie.value?(m(),I($t,{key:0,announce:s(a)},null,8,["announce"])):T("",!0)]),_:1},8,["modelValue"]),e(se),d[24]||(d[24]=N("br",null,null,-1)),d[25]||(d[25]=N("hr",null,null,-1)),d[26]||(d[26]=N("br",null,null,-1))],64))}};var Tt=Ge(Qt,[["__scopeId","data-v-c8f2465a"]]);const Wt={key:0,class:"posterArea relative-position"},Rt={key:0,style:{position:"absolute",right:"1em",top:"1em","z-index":"10"}},Nt={class:"eventboxin"},Kt={key:0},jt=["innerHTML"],Yt={key:1},zt={key:1,class:"videoItem"},Jt={__name:"AnnounceDescr",emits:["delPoster"],setup(l,{emit:B}){const v=String("https://sakh-orch.ru/api/"),c=ae(),o=ne("editMode"),i=ne("Announce"),p=K(()=>{let E=c.platform.is.mobile?1080:480;return i.value.poster?Uu(v,i.value.poster.md5,i.value.poster.ext,E):"/img/news/default_sketch.svg"}),a=K(()=>ce.findById(i.value.hallId));function A(){return"https://vk.com/share.php?url="+String("https://sakh-orch.ru/")+"/announce/"+String(i.value.id)+"&title="+String(i.value.progName)+"&noparse=true&image="+String(p.value)}function y(){Oe.post(v+"epoint/event/poster.php",{params:{method:"unlink",id:i.value.id}}).then(E=>{var _;if(!((_=E==null?void 0:E.data)!=null&&_.result))throw new Error;delete i.value.poster,delete i.value.posterId}).catch(E=>{c.notify(Ce(E))})}return(E,_)=>(m(),W(Z,null,[s(i).poster?(m(),W("div",Wt,[s(o)?(m(),W("div",Rt,[e(Pe,{"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",onOnOk:_[0]||(_[0]=g=>y())})])):T("",!0),s(i).poster.status==="process"?(m(),I(z,{key:1},{default:u(()=>[e(nu),e($,null,{default:u(()=>[e(ct,{showing:"",label:"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430"})]),_:1})]),_:1})):(m(),I(nu,{key:2,src:p.value},{error:u(()=>_[1]||(_[1]=[N("img",{src:"/img/news/default_sketch.svg"},null,-1)])),_:1},8,["src"]))])):T("",!0),N("div",Nt,[e(xe,{class:"transparent no-padding",flat:""},{default:u(()=>[e(ue,{class:"no-padding"},{default:u(()=>[e(z,null,{default:u(()=>[e($,null,{default:u(()=>[e(O,{class:"title"},{default:u(()=>[S(P(s(i).progName),1)]),_:1}),e(O,{class:"title"},{default:u(()=>[S(P(s(Fu)(s(i).eventTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(ue,null,{default:u(()=>[(m(!0),W(Z,null,He(s(i).parsedMD,(g,Q)=>(m(),W(Z,{key:Q},[g.type==="text"?(m(),W("div",Kt,[g.content!==`
`?(m(),W("div",{key:0,innerHTML:g.content,class:"textBlock"},null,8,jt)):(m(),W("br",Yt))])):T("",!0),g.type==="video"?(m(),W("div",zt,[e(pt,{ratio:16/9,src:"https://www.youtube.com/embed/"+g.content},null,8,["src"])])):T("",!0)],64))),128))]),_:1}),!s(i).completed&&[3,4].includes(s(i).pay)&&s(i).ticketLink?(m(),I(ve,{key:0,align:"right"})):T("",!0),e(ue,null,{default:u(()=>[e(z,{dense:""},{default:u(()=>[e(O,{caption:""},{default:u(()=>_[2]||(_[2]=[S(" \u0423\u0432\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043F\u043E\u0441\u0435\u0442\u0438\u0442\u0435\u043B\u0438, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0440\u043E\u0441\u044C\u0431\u0430 \u0441\u043E\u0431\u043B\u044E\u0434\u0430\u0442\u044C \u043C\u0435\u0440\u044B \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438 \u0432 \u0441\u0432\u044F\u0437\u0438 \u0441 \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u0438\u0435\u043C \u043A\u043E\u0440\u043E\u043D\u0430\u0432\u0438\u0440\u0443\u0441\u043D\u043E\u0439 \u0438\u043D\u0444\u0435\u043A\u0446\u0438\u0438! ")])),_:1})]),_:1})]),_:1}),e(ue,null,{default:u(()=>[e(z,{clickable:"",href:a.value.getMapHref(),target:"_blank"},{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(De,{name:"place"})]),_:1}),e($,null,{default:u(()=>[e(O,null,{default:u(()=>{var g;return[S(P((g=a.value)==null?void 0:g.name),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var g;return[S(P((g=a.value)==null?void 0:g.suggest.address.formatted),1)]}),_:1})]),_:1})]),_:1},8,["href"])]),_:1}),!s(i).completed&&[3,4].includes(s(i).pay)&&s(i).ticketLink?(m(),I(ue,{key:1},{default:u(()=>[e(z,{clickable:"",href:s(i).ticketLink,target:"_blank"},{default:u(()=>[s(i).pay===3?(m(),W(Z,{key:0},[e($,{avatar:""},{default:u(()=>[e(De,{name:"shopping_cart"})]),_:1}),e($,null,{default:u(()=>[e(O,null,{default:u(()=>_[3]||(_[3]=[S("\u041A\u0443\u043F\u0438\u0442\u044C \u0431\u0438\u043B\u0435\u0442")])),_:1}),s(i).isPushkin?(m(),I(O,{key:0,caption:""},{default:u(()=>_[4]||(_[4]=[S("+ \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043F\u043E \u043F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u043E\u0439 \u043A\u0430\u0440\u0442\u0435")])),_:1})):T("",!0)]),_:1})],64)):T("",!0),s(i).pay===4?(m(),W(Z,{key:1},[e($,{avatar:""},{default:u(()=>[e(De,{name:"img:/img/uds.svg"})]),_:1}),e($,null,{default:u(()=>[e(O,null,{default:u(()=>_[5]||(_[5]=[S("\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439")])),_:1})]),_:1})],64)):T("",!0)]),_:1},8,["href"])]),_:1})):T("",!0),e(se),e(ue,{class:"no-padding"},{default:u(()=>[e(cu,{"phone-number":"+7-(4242)-300-518"}),e(cu,{"phone-number":"+7-(962)-416-36-89"})]),_:1}),e(se,{spaced:"1em"}),e(ve,{align:"right"},{default:u(()=>[e(J,{href:A(),target:"_blank",outline:"",icon:"img:/img/logo/vk/VK Logo Black & White.svg",label:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},null,8,["href"])]),_:1})]),_:1})])],64))}};var Xt=Ge(Jt,[["__scopeId","data-v-fff9482e"]]);const Gt={class:"centralCol"},Zt={class:"eventboxl"},el={__name:"AnnouncePage",setup(l){const B=Lu("\u0410\u043D\u043E\u043D\u0441");Hu(B);const v=ae(),o=ne("editModes").announce;le("editMode",o);const i=gu(),p=k(),a=k(null);le("Announce",a);const A=k(!1);async function y(){A.value=!0,a.value=await Ue.get(v,i.params.evid),A.value=!1}return Ve(()=>{y()}),(E,_)=>(m(),I(Ou,{class:"col myScrollArea"},{default:u(()=>[N("div",Gt,[s(o)&&a.value?(m(),I(Tt,{key:0,onPosterUploaded:y,onReload:y,ref_key:"editorRef",ref:p},null,512)):T("",!0),N("div",Zt,[a.value?(m(),I(Xt,{key:0,onDelPoster:_[0]||(_[0]=()=>{p.value.delPoster()})})):T("",!0)])]),e(Iu)]),_:1}))}};var Rl=Ge(el,[["__scopeId","data-v-830b5bba"]]);export{Rl as default};
