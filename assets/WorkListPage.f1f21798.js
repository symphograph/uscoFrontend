import{m as f,n as _,q as a,f as t,t as g,v as w,B as A,C as S,x as o,i as m,c as N,w as M,E as U,F as B,G as q,r as k,z as F,bh as I,y as H,b as j,H as z,u as G,I as J,p as x,o as K,l as R,A as X,ax as Y}from"./index.863743c3.js";import{Q as C,b as Z}from"./QImg.1a6d9b02.js";import{Q as V}from"./QItemLabel.4be85da2.js";import"./QSelect.fe722113.js";import{A as ee}from"./AuthorItem.b225ad44.js";/* empty css                                                                   */import{_ as D}from"./plugin-vue_export-helper.21dcd24c.js";import"./LocalStorage.45157eb8.js";import{u as E}from"./use-quasar.e5a0aea6.js";import{a as te}from"./axios.05005d5e.js";import{Q as oe}from"./QList.44743ef4.js";import{h as ae,n as le}from"./myFuncts.d09ccf85.js";/* empty css                                                             */import{P as re}from"./PageShell.43282391.js";import{_ as ne}from"./BtnLibEdit.052cd2c4.js";import{Q as se}from"./QForm.942b4af5.js";/* empty css               */import"./QMenu.a63f68e9.js";import"./position-engine.1cccbb5b.js";import"./selection.9c436d4f.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";/* empty css                                                               */import"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.218a825c.js";import"./touch.9135741d.js";import"./AnderHeader.vue_vue_type_style_index_0_lang.790aafa6.js";import"./QScrollArea.5bcdbd9f.js";import"./QLinearProgress.1c1f393b.js";import"./myAuth.5621b016.js";const ie={__name:"WorkItem",props:{work:Object},setup(s){const u=E();return(c,l)=>(f(),_(Z,{clickable:"",to:`/work/${s.work.id}`,dense:""},{default:a(()=>[t(C,null,{default:a(()=>[t(V,null,{default:a(()=>[g(w(s.work.titleRu),1)]),_:1}),t(V,{caption:""},{default:a(()=>[g(w(s.work.titleEn),1)]),_:1})]),_:1}),t(C,{side:"",class:"opus"},{default:a(()=>[t(V,{caption:""},{default:a(()=>{var e;return[g(w((e=s.work.opus)!=null?e:"Op.?"),1)]}),_:1}),t(V,{caption:""},{default:a(()=>{var e;return[g(w((e=s.work.icatno)!=null?e:"cat\u2116.?"),1)]}),_:1}),t(V,{caption:""},{default:a(()=>{var e;return[g(w((e=s.work.catalogIndex)!=null?e:"catIdx: ?"),1)]}),_:1}),t(A,{dense:"","icon-right":"content_copy",flat:"",label:`ID: ${s.work.id}`,onClick:l[0]||(l[0]=S(e=>o(ae)(s.work.id,o(u)),["prevent","stop"]))},null,8,["label"])]),_:1})]),_:1},8,["to"]))}};var ue=D(ie,[["__scopeId","data-v-acd2dcbe"]]);const de={__name:"WorkList",setup(s){const u=m("works"),c=m("searchText"),l=N(()=>{if(!c.value)return u.value;const e=c.value.toLowerCase();return u.value.filter(n=>(n.titleRu?n.titleRu.toLowerCase().includes(e):!1)||(n.titleEn?n.titleEn.toLowerCase().includes(e):!1))});return M(c,(e,n)=>{console.log("Search text changed from",n,"to",e)}),(e,n)=>(f(),_(oe,{separator:""},{default:a(()=>[(f(!0),U(B,null,q(l.value,d=>(f(),_(ue,{key:d.id,work:d},null,8,["work"]))),128))]),_:1}))}},ce={__name:"WorkDialog",setup(s){E();const u=m("isOpenWorkDialog"),c=k(!1),l=m("work");function e(){!d()||save()}function n(){c.value=!1}function d(){return refTitle.value.validate()&&refNum.value.validate()}return(b,r)=>(f(),_(z,{modelValue:o(u),"onUpdate:modelValue":r[4]||(r[4]=i=>j(u)?u.value=i:null),onBeforeHide:n},{default:a(()=>[t(H,{bordered:"",class:"dialogArea"},{default:a(()=>[t(se,{onSubmit:S(e,["prevent","stop"])},{default:a(()=>[t(F,null,{default:a(()=>[t(I,{modelValue:o(l).titleRu,"onUpdate:modelValue":r[0]||(r[0]=i=>o(l).titleRu=i),prefix:"RU",label:"\u0420\u0443\u0441\u0441\u043A\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),t(I,{modelValue:o(l).titleEn,"onUpdate:modelValue":r[1]||(r[1]=i=>o(l).titleEn=i),prefix:"EN",label:"\u041C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),t(I,{modelValue:o(l).opus,"onUpdate:modelValue":r[2]||(r[2]=i=>o(l).opus=i),prefix:"Op.",label:"\u041E\u043F\u0443\u0441"},null,8,["modelValue"]),t(I,{modelValue:o(l).catalogIndex,"onUpdate:modelValue":r[3]||(r[3]=i=>o(l).catalogIndex=i),label:"\u041A\u0430\u0442\u0430\u043B\u043E\u0433. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440: BWV 123"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const me={class:"centralCol"},pe={__name:"WorkListPage",setup(s){const u=E(),c=G();J();const l=String("https://api.staff.sakh-orch.ru/"),e=k("");x("searchText",e);const n=k(!1);x("progress",n);const d=k([]);x("works",d),m("AuthorSelectList");const b=m("selectedAuthorId"),r=m("selectedAuthor"),i=m("libEditMode"),W=k(!1);x("isOpenWorkDialog",W);const y=k(null);x("work",y);function O(){let Q=c.params.authorId*1;!Q||(n.value=!0,te.post(l+"/api/lib/work.php",{params:{method:"list",authorId:Q}}).then(p=>{var v,h;d.value=[],d.value=(h=(v=p==null?void 0:p.data)==null?void 0:v.data)!=null?h:[]}).catch(p=>{d.value=[],u.notify(le(p))}).finally(()=>{n.value=!1}))}const P=m("loadAuthor");function T(){y.value={id:void 0,titleRu:"",titleEn:"",authorId:b.value,opus:"",icatno:""},W.value=!0}return K(()=>{b.value=c.params.authorId*1,P(),O(),console.log(r.value)}),(Q,p)=>(f(),U(B,null,[t(re,{"page-title":"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u044F "},{ToolPanel:a(()=>{var v,h,L;return[o(i)?(f(),_(A,{key:0,onClick:T,icon:"add",flat:"",round:""})):R("",!0),t(ee,{id:o(b),iofEn:(v=o(r))==null?void 0:v.iofEn,iconUrl:(h=o(r))==null?void 0:h.iconUrl,fioRu:(L=o(r))==null?void 0:L.fioRu},null,8,["id","iofEn","iconUrl","fioRu"]),t(I,{modelValue:e.value,"onUpdate:modelValue":p[0]||(p[0]=$=>e.value=$),style:{width:"100%","max-width":"16em"},label:"\u0444\u0438\u043B\u044C\u0442\u0440","stack-label":"",clearable:""},{append:a(()=>[t(X,{name:"search"})]),_:1},8,["modelValue"]),t(ne)]}),PageContent:a(()=>[Y("div",me,[d.value.length?(f(),_(de,{key:0})):R("",!0)])]),_:1}),t(ce)],64))}};var qe=D(pe,[["__scopeId","data-v-1e8da17e"]]);export{qe as default};
