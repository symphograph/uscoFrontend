import{r as E,m as F,O as I,a6 as O,aa as _,l as A,M}from"./index.4c9b99a1.js";function c(a,u,g,m){const r=[];return a.forEach(f=>{m(f)===!0?r.push(f):u.push({failedPropValidation:g,file:f})}),r}function p(a){a&&a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),_(a)}const W={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},R=["rejected"];function X({editable:a,dnd:u,getFileInput:g,addFilesToQueue:m}){const{props:r,emit:f,proxy:D}=I(),d=E(null),z=F(()=>r.accept!==void 0?r.accept.split(",").map(e=>(e=e.trim(),e==="*"?"*/":(e.endsWith("/*")&&(e=e.slice(0,e.length-1)),e.toUpperCase()))):null),S=F(()=>parseInt(r.maxFiles,10)),x=F(()=>parseInt(r.maxTotalSize,10));function b(e){if(a.value)if(e!==Object(e)&&(e={target:null}),e.target!==null&&e.target.matches('input[type="file"]')===!0)e.clientX===0&&e.clientY===0&&O(e);else{const l=g();l&&l!==e.target&&l.click(e)}}function y(e){a.value&&e&&m(null,e)}function N(e,l,v,h){let t=Array.from(l||e.target.files);const s=[],o=()=>{s.length!==0&&f("rejected",s)};if(r.accept!==void 0&&z.value.indexOf("*/")===-1&&(t=c(t,s,"accept",n=>z.value.some(i=>n.type.toUpperCase().startsWith(i)||n.name.toUpperCase().endsWith(i))),t.length===0))return o();if(r.maxFileSize!==void 0){const n=parseInt(r.maxFileSize,10);if(t=c(t,s,"max-file-size",i=>i.size<=n),t.length===0)return o()}if(r.multiple!==!0&&t.length!==0&&(t=[t[0]]),t.forEach(n=>{n.__key=n.webkitRelativePath+n.lastModified+n.name+n.size}),h===!0){const n=v.map(i=>i.__key);t=c(t,s,"duplicate",i=>n.includes(i.__key)===!1)}if(t.length===0)return o();if(r.maxTotalSize!==void 0){let n=h===!0?v.reduce((i,C)=>i+C.size,0):0;if(t=c(t,s,"max-total-size",i=>(n+=i.size,n<=x.value)),t.length===0)return o()}if(typeof r.filter=="function"){const n=r.filter(t);t=c(t,s,"filter",i=>n.includes(i))}if(r.maxFiles!==void 0){let n=h===!0?v.length:0;if(t=c(t,s,"max-files",()=>(n++,n<=S.value)),t.length===0)return o()}if(o(),t.length!==0)return t}function k(e){p(e),u.value!==!0&&(u.value=!0)}function T(e){_(e),(e.relatedTarget!==null||A.is.safari!==!0?e.relatedTarget!==d.value:document.elementsFromPoint(e.clientX,e.clientY).includes(d.value)===!1)===!0&&(u.value=!1)}function j(e){p(e);const l=e.dataTransfer.files;l.length!==0&&m(null,l),u.value=!1}function P(e){if(u.value===!0)return M("div",{ref:d,class:`q-${e}__dnd absolute-full`,onDragenter:p,onDragover:p,onDragleave:T,onDrop:j})}return Object.assign(D,{pickFiles:b,addFiles:y}),{pickFiles:b,addFiles:y,onDragover:k,onDragleave:T,processFiles:N,getDndNode:P,maxFilesNumber:S,maxTotalSizeNumber:x}}export{R as a,X as b,W as u};
