import{Q as z}from"./QLinearProgress.b482e42b.js";import{u as U}from"./use-quasar.e1734797.js";import{api as j}from"./axios.b6965e20.js";import{Q as $}from"./QImg.97937970.js";import{Q as F}from"./QItemSection.f60ff076.js";import{Q as C}from"./QTooltip.10f580ad.js";import{r as h,i as L,f as c,g as v,A as r,h as f,z as y,aw as Q,J as k,a4 as S,j as I,c as w,F as B,B as D,_ as V,D as R,E as T,u as A,d as H,w as M,a as J,av as K}from"./index.50239517.js";import{n as q,b as P,f as G}from"./myFuncts.24341304.js";const _=a=>(R("data-v-0d5a8738"),a=a(),T(),a),W={class:"narea"},X={class:"nimg_block"},Y={class:"tcol"},Z={class:"ntitle"},tt=["href"],et=_(()=>r("br",null,null,-1)),it=["href"],nt=_(()=>r("br",null,null,-1)),ot=_(()=>r("br",null,null,-1)),rt={class:"ndate"},at=_(()=>r("br",null,null,-1)),lt={key:0,style:{display:"flex","justify-content":"right","grid-gap":"1em"}},st=_(()=>r("br",null,null,-1)),dt=_(()=>r("hr",null,null,-1)),ut=_(()=>r("br",null,null,-1)),ct={__name:"NewItem",props:{item:h(null)},emits:["hideOrShow","delEntry"],setup(a,{emit:x}){const p=String("https://api.sakh-orch.ru/"),u=U(),b=L("editMode"),l=x,i=a,m=h(i.item.isShow);function g(){var t;return(t=i.item)!=null&&t.announceId?N():E()}function E(){var e,d;let t=u.platform.is.mobile?1080:260;return p+"/img/entry/sketch/"+t+"/entry_"+i.item.id+".jpg?ver="+((d=(e=i.item)==null?void 0:e.verString)!=null?d:"jhj")}function N(){var e,d;let t=u.platform.is.mobile?1080:480;return p+"/img/posters/sketch/"+t+"/poster_"+i.item.announceId+".jpg?ver="+((d=(e=i.item)==null?void 0:e.verString)!=null?d:"jhj")}function o(){var t,e;return(t=i.item)!=null&&t.announceId?"/announce/"+i.item.announceId:(e=i.item)!=null&&e.refLink?i.item.refLink:"/new/"+i.item.id}function n(){j.post(p+"api/news/entry.php",{params:{method:m.value?"hide":"show",entryId:i.item.id}}).then(t=>{var e;if(!((e=t==null?void 0:t.data)!=null&&e.result))throw new Error;m.value=!m.value,l("hideOrShow",i.item.id)}).catch(t=>{u.notify(q(t))}).finally(()=>{})}function s(){j.post(p+"api/news/entry.php",{params:{method:"del",entryId:i.item.id}}).then(t=>{var e,d,O;if(!((e=t==null?void 0:t.data)!=null&&e.result))throw new Error;u.notify(P((O=(d=t==null?void 0:t.data)==null?void 0:d.result)!=null?O:"")),l("delEntry",i.item.id)}).catch(t=>{u.notify(q(t))})}return(t,e)=>(c(),v(B,null,[r("div",W,[r("div",X,[r("div",null,[f(F,{href:o(),dense:"",class:"no-padding"},{default:y(()=>[f($,{src:g(),ratio:1920/1080,fit:"fill","placeholder-src":"/img/news/default_1920x1080.png"},{error:y(()=>[f($,{src:"/img/news/default_1920x1080.png",ratio:1920/960,fit:"fill"})]),_:1},8,["src"])]),_:1},8,["href"])])]),r("div",Y,[r("div",Z,[r("a",{href:o()},Q(a.item.title),9,tt)]),et,r("a",{href:o()},Q(a.item.descr),9,it),nt,ot,r("span",rt,Q(k(G)(a.item.date)),1),at])]),k(b)?(c(),v("div",lt,[f(S,{color:"red",icon:"delete",outline:"",onClick:e[0]||(e[0]=d=>s())},{default:y(()=>[f(C,{anchor:"top middle"},{default:y(()=>[D("\u0423\u0434\u0430\u043B\u0438\u0442\u044C")]),_:1})]),_:1}),m.value?(c(),I(S,{key:0,label:"\u0421\u043A\u0440\u044B\u0442\u044C",color:"orange",outline:"",onClick:e[1]||(e[1]=d=>n())})):(c(),I(S,{key:1,label:"\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C",color:"green",outline:"",onClick:e[2]||(e[2]=d=>n())})),f(S,{icon:"edit",outline:"",to:"/new/"+a.item.id},{default:y(()=>[f(C,{anchor:"top middle"},{default:y(()=>[D("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1})]),_:1},8,["to"])])):w("",!0),st,dt,ut],64))}};var mt=V(ct,[["__scopeId","data-v-0d5a8738"]]);const ht={class:"newscol"},ft={key:2,class:"noEntyes"},_t={__name:"NewsList",props:{query:h(null),category:h(null),year:h(null),limit:h(null)},setup(a){const x=String("https://api.sakh-orch.ru/"),p=A();H(),U();const u=L("progress"),b=L("editMode"),l=h([]),i=a,m=h(i.category);M(()=>i.query,()=>{g()},{deep:!0}),M(p,o=>{m.value=o.params.category,g()});function g(){!m.value||(u.value=!0,j.post(x+"api/news/entry.php",{params:{method:i.limit===100?"list":"toplist",category:m.value,year:i.year,limit:i.limit}}).then(o=>{var n,s;l.value=(s=(n=o==null?void 0:o.data)==null?void 0:n.data)!=null?s:[]}).catch(o=>{l.value=[]}).finally(()=>{u.value=!1}))}function E(o){const n=l.value.find(s=>s.id===o);n.isShow=!n.isShow}function N(o){const n=l.value.findIndex(s=>s.id===o);n!==-1&&l.value.splice(n,1)}return J(()=>{g()}),(o,n)=>{var s;return c(),v("div",ht,[k(u)?(c(),I(z,{key:0,indeterminate:"",color:"secondary",class:"q-mt-sm"})):w("",!0),(s=l.value)!=null&&s.length?(c(!0),v(B,{key:1},K(l.value,t=>(c(),v(B,{key:t.id},[t.isShow||k(b)?(c(),I(mt,{key:0,item:t,onHideOrShow:n[0]||(n[0]=e=>{E(e)}),onDelEntry:n[1]||(n[1]=e=>{N(e)})},null,8,["item"])):w("",!0)],64))),128)):w("",!0),!l.value&&!k(u)?(c(),v("h5",ft," \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443. ")):w("",!0)])}}};var xt=V(_t,[["__scopeId","data-v-450677ad"]]);export{xt as N};
