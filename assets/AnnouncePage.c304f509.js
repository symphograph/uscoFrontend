import{u as ct}from"./use-meta.1f2e8af7.js";import{u as Ae}from"./use-quasar.887a5898.js";import{api as He}from"./axios.95308f7a.js";import{R as vt,ap as mt,ba as ft,ar as pt,bi as _t,r as U,c as y,w as Ne,aJ as ht,U as kt,h as p,g as gt,bj as yt,a1 as bt,aI as wt,aD as xt,ac as Ce,a9 as se,i as Y,n as k,q as A,f as n,G as i,N as o,bh as ee,L as ie,H as _,u as Ke,aX as Vt,p as Ee,t as J,l as T,O as ye,bk as Se,F as z,I as je,J as ze,aZ as G,M as B,ax as he,aw as Mt,aY as Dt,o as qt}from"./index.cd1e76ba.js";import{Q as Be}from"./QSelect.1bf9f4be.js";import{S as Ct,Q as St}from"./SketchUploader.2554143a.js";import{u as At,a as Ht,b as It,_ as ke,g as Tt,f as Ut,Q as Le,c as $t}from"./QPopupProxy.2464f906.js";import{T as Ot}from"./TouchPan.84137fa7.js";import{p as Z}from"./format.3e32b8d9.js";import{C as Ye}from"./ClosePopup.63cf0f16.js";import{c as Qt,n as Ie,b as Pt,d as Nt,g as Bt}from"./myFuncts.9f42497d.js";import{A as Lt}from"./AnnounceCard.f14fbfbe.js";import{_ as Te}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as Yt}from"./QImg.8c76714d.js";import{b as ge,Q as j,a as L}from"./QItemLabel.971d5e50.js";import{Q as Ft}from"./QVideo.f0f467bb.js";import{_ as Fe}from"./PhoneNumber.aed8c831.js";import{_ as Kt}from"./BtnDelete.a2a2705d.js";import"./QToolbarTitle.943cd697.js";import"./QToolbar.537561d3.js";import"./QLinearProgress.1cc758cb.js";import"./rtl.61399bdd.js";import"./position-engine.b0415672.js";import"./QTooltip.4fda66b0.js";import"./use-file.2c693066.js";import"./get-emits-object.24798346.js";import"./use-render-cache.1a7235d4.js";import"./touch.3df10340.js";import"./use-ratio.5639a88d.js";function Et(l,Q){if(l.hour!==null){if(l.minute===null)return"minute";if(Q===!0&&l.second===null)return"second"}return"hour"}function jt(){const l=new Date;return{hour:l.getHours(),minute:l.getMinutes(),second:l.getSeconds(),millisecond:l.getMilliseconds()}}var zt=vt({name:"QTime",props:{...mt,...ft,...At,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:l=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(l)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:Ht,setup(l,{slots:Q,emit:D}){const H=gt(),{$q:s}=H.proxy,q=pt(l,s),{tabindex:g,headerClass:I,getLocale:x,getCurrentDate:b}=It(l,s),V=_t(l),r=yt(V);let te,R;const re=U(null),F=y(()=>We()),W=y(()=>x()),le=y(()=>Xe()),X=ke(l.modelValue,F.value,W.value,l.calendar,le.value),c=U(Et(X)),a=U(X),w=U(X.hour===null||X.hour<12),be=y(()=>`q-time q-time--${l.landscape===!0?"landscape":"portrait"}`+(q.value===!0?" q-time--dark q-dark":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-time--readonly":"")+(l.bordered===!0?" q-time--bordered":"")+(l.square===!0?" q-time--square no-border-radius":"")+(l.flat===!0?" q-time--flat no-shadow":"")),ne=y(()=>{const e=a.value;return{hour:e.hour===null?"--":C.value===!0?Z(e.hour):String(w.value===!0?e.hour===0?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:e.minute===null?"--":Z(e.minute),second:e.second===null?"--":Z(e.second)}}),C=y(()=>l.format24h!==null?l.format24h:s.lang.date.format24h),M=y(()=>{const e=c.value==="hour",t=e===!0?12:60,u=a.value[c.value];let h=`rotate(${Math.round(u*(360/t))-180}deg) translateX(-50%)`;return e===!0&&C.value===!0&&a.value.hour>=12&&(h+=" scale(.7)"),{transform:h}}),v=y(()=>a.value.hour!==null),f=y(()=>v.value===!0&&a.value.minute!==null),N=y(()=>l.hourOptions!==void 0?e=>l.hourOptions.includes(e):l.options!==void 0?e=>l.options(e,null,null):null),K=y(()=>l.minuteOptions!==void 0?e=>l.minuteOptions.includes(e):l.options!==void 0?e=>l.options(a.value.hour,e,null):null),de=y(()=>l.secondOptions!==void 0?e=>l.secondOptions.includes(e):l.options!==void 0?e=>l.options(a.value.hour,a.value.minute,e):null),O=y(()=>{if(N.value===null)return null;const e=ve(0,11,N.value),t=ve(12,11,N.value);return{am:e,pm:t,values:e.values.concat(t.values)}}),ae=y(()=>K.value!==null?ve(0,59,K.value):null),ue=y(()=>de.value!==null?ve(0,59,de.value):null),ce=y(()=>{switch(c.value){case"hour":return O.value;case"minute":return ae.value;case"second":return ue.value}}),Je=y(()=>{let e,t,u=0,m=1;const h=ce.value!==null?ce.value.values:void 0;c.value==="hour"?C.value===!0?(e=0,t=23):(e=0,t=11,w.value===!1&&(u=12)):(e=0,t=55,m=5);const $=[];for(let d=e,S=e;d<=t;d+=m,S++){const E=d+u,rt=h!==void 0&&h.includes(E)===!1,dt=c.value==="hour"&&d===0?C.value===!0?"00":"12":d;$.push({val:E,index:S,disable:rt,label:dt})}return $}),Re=y(()=>[[Ot,Ge,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Ne(()=>l.modelValue,e=>{const t=ke(e,F.value,W.value,l.calendar,le.value);(t.dateHash!==a.value.dateHash||t.timeHash!==a.value.timeHash)&&(a.value=t,t.hour===null?c.value="hour":w.value=t.hour<12)}),Ne([F,W],()=>{bt(()=>{qe()})});function Ue(){const e={...b(),...jt()};qe(e),Object.assign(a.value,e),c.value="hour"}function ve(e,t,u){const m=Array.apply(null,{length:t+1}).map((h,$)=>{const d=$+e;return{index:d,val:u(d)===!0}}).filter(h=>h.val===!0).map(h=>h.index);return{min:m[0],max:m[m.length-1],values:m,threshold:t+1}}function $e(e,t,u){const m=Math.abs(e-t);return Math.min(m,u-m)}function we(e,{min:t,max:u,values:m,threshold:h}){if(e===t)return t;if(e<t||e>u)return $e(e,t,h)<=$e(e,u,h)?t:u;const $=m.findIndex(E=>e<=E),d=m[$-1],S=m[$];return e-d<=S-e?d:S}function We(){return l.calendar!=="persian"&&l.mask!==null?l.mask:`HH:mm${l.withSeconds===!0?":ss":""}`}function Xe(){if(typeof l.defaultDate!="string"){const e=b(!0);return e.dateHash=Tt(e),e}return ke(l.defaultDate,"YYYY/MM/DD",void 0,l.calendar)}function xe(){return wt(H)===!0||ce.value!==null&&(ce.value.values.length===0||c.value==="hour"&&C.value!==!0&&O.value[w.value===!0?"am":"pm"].values.length===0)}function Ve(){const e=re.value,{top:t,left:u,width:m}=e.getBoundingClientRect(),h=m/2;return{top:t+h,left:u+h,dist:h*.7}}function Ge(e){if(xe()!==!0){if(e.isFirst===!0){te=Ve(),R=me(e.evt,te);return}R=me(e.evt,te,R),e.isFinal===!0&&(te=!1,R=null,Oe())}}function Oe(){c.value==="hour"?c.value="minute":l.withSeconds&&c.value==="minute"&&(c.value="second")}function me(e,t,u){const m=ht(e),h=Math.abs(m.top-t.top),$=Math.sqrt(Math.pow(Math.abs(m.top-t.top),2)+Math.pow(Math.abs(m.left-t.left),2));let d,S=Math.asin(h/$)*(180/Math.PI);if(m.top<t.top?S=t.left<m.left?90-S:270+S:S=t.left<m.left?S+90:270-S,c.value==="hour"){if(d=S/30,O.value!==null){const E=C.value!==!0?w.value===!0:O.value.am.values.length!==0&&O.value.pm.values.length!==0?$>=t.dist:O.value.am.values.length!==0;d=we(d+(E===!0?0:12),O.value[E===!0?"am":"pm"])}else d=Math.round(d),C.value===!0?$<t.dist?d<12&&(d+=12):d===12&&(d=0):w.value===!0&&d===12?d=0:w.value===!1&&d!==12&&(d+=12);C.value===!0&&(w.value=d<12)}else d=Math.round(S/6)%60,c.value==="minute"&&ae.value!==null?d=we(d,ae.value):c.value==="second"&&ue.value!==null&&(d=we(d,ue.value));return u!==d&&ot[c.value](d),d}const Me={hour(){c.value="hour"},minute(){c.value="minute"},second(){c.value="second"}};function Ze(e){e.keyCode===13&&Qe()}function et(e){e.keyCode===13&&Pe()}function tt(e){xe()!==!0&&(s.platform.is.desktop!==!0&&me(e,Ve()),Oe())}function lt(e){xe()!==!0&&me(e,Ve())}function nt(e){if(e.keyCode===13)c.value="hour";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(O.value!==null){const u=C.value===!0?O.value.values:O.value[w.value===!0?"am":"pm"].values;if(u.length===0)return;if(a.value.hour===null)fe(u[0]);else{const m=(u.length+u.indexOf(a.value.hour)+t)%u.length;fe(u[m])}}else{const u=C.value===!0?24:12,m=C.value!==!0&&w.value===!1?12:0,h=a.value.hour===null?-t:a.value.hour;fe(m+(24+h+t)%u)}}}function at(e){if(e.keyCode===13)c.value="minute";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(ae.value!==null){const u=ae.value.values;if(u.length===0)return;if(a.value.minute===null)pe(u[0]);else{const m=(u.length+u.indexOf(a.value.minute)+t)%u.length;pe(u[m])}}else{const u=a.value.minute===null?-t:a.value.minute;pe((60+u+t)%60)}}}function ut(e){if(e.keyCode===13)c.value="second";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(ue.value!==null){const u=ue.value.values;if(u.length===0)return;if(a.value.seconds===null)_e(u[0]);else{const m=(u.length+u.indexOf(a.value.second)+t)%u.length;_e(u[m])}}else{const u=a.value.second===null?-t:a.value.second;_e((60+u+t)%60)}}}function fe(e){a.value.hour!==e&&(a.value.hour=e,oe())}function pe(e){a.value.minute!==e&&(a.value.minute=e,oe())}function _e(e){a.value.second!==e&&(a.value.second=e,oe())}const ot={hour:fe,minute:pe,second:_e};function Qe(){w.value===!1&&(w.value=!0,a.value.hour!==null&&(a.value.hour-=12,oe()))}function Pe(){w.value===!0&&(w.value=!1,a.value.hour!==null&&(a.value.hour+=12,oe()))}function De(e){const t=l.modelValue;c.value!==e&&t!==void 0&&t!==null&&t!==""&&typeof t!="string"&&(c.value=e)}function oe(){if(N.value!==null&&N.value(a.value.hour)!==!0){a.value=ke(),De("hour");return}if(K.value!==null&&K.value(a.value.minute)!==!0){a.value.minute=null,a.value.second=null,De("minute");return}if(l.withSeconds===!0&&de.value!==null&&de.value(a.value.second)!==!0){a.value.second=null,De("second");return}a.value.hour===null||a.value.minute===null||l.withSeconds===!0&&a.value.second===null||qe()}function qe(e){const t=Object.assign({...a.value},e),u=l.calendar==="persian"?Z(t.hour)+":"+Z(t.minute)+(l.withSeconds===!0?":"+Z(t.second):""):Ut(new Date(t.year,t.month===null?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),F.value,W.value,t.year,t.timezoneOffset);t.changed=u!==l.modelValue,D("update:modelValue",u,t)}function it(){const e=[p("div",{class:"q-time__link "+(c.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Me.hour,onKeyup:nt},ne.value.hour),p("div",":"),p("div",v.value===!0?{class:"q-time__link "+(c.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:at,onClick:Me.minute}:{class:"q-time__link"},ne.value.minute)];l.withSeconds===!0&&e.push(p("div",":"),p("div",f.value===!0?{class:"q-time__link "+(c.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:ut,onClick:Me.second}:{class:"q-time__link"},ne.value.second));const t=[p("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},e)];return C.value===!1&&t.push(p("div",{class:"q-time__header-ampm column items-between no-wrap"},[p("div",{class:"q-time__link "+(w.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Qe,onKeyup:Ze},"AM"),p("div",{class:"q-time__link "+(w.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Pe,onKeyup:et},"PM")])),p("div",{class:"q-time__header flex flex-center no-wrap "+I.value},t)}function st(){const e=a.value[c.value];return p("div",{class:"q-time__content col relative-position"},[p(xt,{name:"q-transition--scale"},()=>p("div",{key:"clock"+c.value,class:"q-time__container-parent absolute-full"},[p("div",{ref:re,class:"q-time__container-child fit overflow-hidden"},[Ce(p("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:tt,onMousedown:lt},[p("div",{class:"q-time__clock-circle fit"},[p("div",{class:"q-time__clock-pointer"+(a.value[c.value]===null?" hidden":l.color!==void 0?` text-${l.color}`:""),style:M.value}),Je.value.map(t=>p("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${t.index}`+(t.val===e?" q-time__clock-position--active "+I.value:t.disable===!0?" q-time__clock-position--disable":"")},[p("span",t.label)]))])]),Re.value)])])),l.nowBtn===!0?p(se,{class:"q-time__now-button absolute",icon:s.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:l.color,textColor:l.textColor,tabindex:g.value,onClick:Ue}):null])}return H.proxy.setNow=Ue,()=>{const e=[st()],t=kt(Q.default);return t!==void 0&&e.push(p("div",{class:"q-time__actions"},t)),l.name!==void 0&&l.disable!==!0&&r(e,"push"),p("div",{class:be.value,tabindex:-1},[it(),p("div",{class:"q-time__main col overflow-auto"},e)])}}});const Jt={class:"q-pa-md",style:{"max-width":"300px",padding:"0"}},Rt={class:"row items-center justify-end"},Wt={class:"row items-center justify-end"},Xt={__name:"DateTime",props:{evDateTime:U("2019-02-01 12:44")},emits:["update:date"],setup(l,{emit:Q}){const D=Y("Announce");return U(l.evDateTime),(s,q)=>(k(),A("div",Jt,[n(ee,{filled:"",modelValue:o(D).eventTime,"onUpdate:modelValue":q[2]||(q[2]=g=>o(D).eventTime=g),mask:"####-##-## ##:##"},{prepend:i(()=>[n(ie,{name:"event",class:"cursor-pointer"},{default:i(()=>[n(Le,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:i(()=>[n($t,{modelValue:o(D).eventTime,"onUpdate:modelValue":q[0]||(q[0]=g=>o(D).eventTime=g),mask:"YYYY-MM-DD HH:mm"},{default:i(()=>[_("div",Rt,[Ce(n(se,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[Ye]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:i(()=>[n(ie,{name:"access_time",class:"cursor-pointer"},{default:i(()=>[n(Le,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:i(()=>[n(zt,{modelValue:o(D).eventTime,"onUpdate:modelValue":q[1]||(q[1]=g=>o(D).eventTime=g),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:i(()=>[_("div",Wt,[Ce(n(se,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[Ye]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};const P=l=>(je("data-v-dfdeba34"),l=l(),ze(),l),Gt={key:0,class:"eventsarea"},Zt={class:"editArea"},el={class:"card"},tl={class:"editor"},ll={style:{display:"flex","justify-content":"space-between"}},nl=P(()=>_("br",null,null,-1)),al=P(()=>_("hr",null,null,-1)),ul={class:"uploads"},ol={style:{width:"100%"}},il=P(()=>_("br",null,null,-1)),sl=P(()=>_("br",null,null,-1)),rl=P(()=>_("br",null,null,-1)),dl=P(()=>_("br",null,null,-1)),cl={class:"uploads"},vl=P(()=>_("br",null,null,-1)),ml=P(()=>_("hr",null,null,-1)),fl=P(()=>_("br",null,null,-1)),pl={__name:"AnnounceEditor",emits:["reload","posterUploaded"],setup(l,{expose:Q,emit:D}){const H=String("https://api.sakh-orch.ru/"),s=Ae();Ke();const q=Vt();Y("editMode");const g=Y("Halls"),I=U("");Ee("pwUrl",I);const x=D,b={},V=Y("AccessToken"),r=Y("Announce");function te(){}const R=[{label:"\u0412\u0445\u043E\u0434 \u0441\u0432\u043E\u0431\u043E\u0434\u043D\u044B\u0439",value:2},{label:"\u0411\u0438\u043B\u0435\u0442\u044B \u0432 \u043F\u0440\u043E\u0434\u0430\u0436\u0435",value:3},{label:"\u0412\u0445\u043E\u0434 \u043F\u043E \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C",value:4},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",value:5}];U(null);const re=U(null),F=U(null);function W(M){return{url:H+"api/event/poster.php",headers:[{name:"ACCESSTOKEN",value:V.value}],formFields:[{name:"id",value:r.value.id},{name:"method",value:"add"}]}}function le(M){s.notify(Qt("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),x("posterUploaded")}function X(M){var f,N,K;let v=(K=(N=JSON.parse((f=M==null?void 0:M.xhr)==null?void 0:f.response))==null?void 0:N.error)!=null?K:"";s.notify(Ie(null,v))}function c(){F.value.saveData()}function a(){q.push({path:"/announces"})}function w(){x("reload")}function be(){delete r.value.sketch,delete r.value.sketchId}function ne(){r.value.hallId=r.value.Hall.id}function C(){He.post(H+"api/event/announce.php",{params:{method:"updateMarkdown",id:r.value.id,markdown:r.value.description}}).then(M=>{var v;if(!((v=M==null?void 0:M.data)!=null&&v.result))throw new Error;r.value.parsedMD=M==null?void 0:M.data.data}).catch(M=>{})}return Q({}),(M,v)=>(k(),A(z,null,[o(r)?(k(),A("div",Gt,[_("div",Zt,[_("div",el,[o(r).Hall.map?(k(),J(Lt,{key:0,onIamDeleted:a,onNewAnnounce:w,onDelSketch:be,ref_key:"rAnnounceCard",ref:F,Announce:o(r),pwUrl:I.value},null,8,["Announce","pwUrl"])):T("",!0)]),_("div",tl,[_("div",ll,[n(Xt,{date:o(r).eventTime,"onUpdate:date":[v[0]||(v[0]=f=>o(r).eventTime=f),v[1]||(v[1]=f=>void 0)]},null,8,["date"])]),nl,al,_("div",ul,[_("div",ol,[n(Ct,{id:o(r).id,type:"event",onOnUploaded:le},null,8,["id"])])]),n(ye,{spaced:"1em"}),n(ee,{name:"progName",modelValue:o(r).progName,"onUpdate:modelValue":v[2]||(v[2]=f=>o(r).progName=f),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),n(Be,{modelValue:o(r).Hall,"onUpdate:modelValue":[v[3]||(v[3]=f=>o(r).Hall=f),v[4]||(v[4]=f=>ne())],label:"\u041C\u0435\u0441\u0442\u043E \u043F\u0440\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F","map-options":"","option-label":"name","option-value":"id",options:o(g)},null,8,["modelValue","options"]),n(Be,{modelValue:o(r).pay,"onUpdate:modelValue":v[5]||(v[5]=f=>o(r).pay=f),"emit-value":"","map-options":"",label:"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0432\u0445\u043E\u0434\u0430",options:R},null,8,["modelValue"]),il,[3,4].includes(o(r).pay)?(k(),J(ee,{key:0,type:"text",modelValue:o(r).ticketLink,"onUpdate:modelValue":v[6]||(v[6]=f=>o(r).ticketLink=f),label:"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435 \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"])):T("",!0),sl,n(ee,{type:"number",modelValue:o(r).age,"onUpdate:modelValue":v[7]||(v[7]=f=>o(r).age=f),label:"\u0412\u043E\u0437\u0440\u0430\u0441\u0442\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"},null,8,["modelValue"]),rl,n(ee,{name:"evDescr",modelValue:o(r).sdescr,"onUpdate:modelValue":v[8]||(v[8]=f=>o(r).sdescr=f),type:"textarea",autogrow:"",label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),dl,n(ee,{name:"evText",modelValue:o(r).description,"onUpdate:modelValue":[v[9]||(v[9]=f=>o(r).description=f),v[10]||(v[10]=f=>C())],type:"textarea",autogrow:"",debounce:300,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),n(ye,{spaced:"1em"}),_("div",cl,[n(St,{modelValue:b,"onUpdate:modelValue":v[11]||(v[11]=f=>b=f),style:{width:"100%"},label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",factory:W,ref_key:"uploader2",ref:re,onUploaded:le,onFailed:X,"no-thumbnails":""},null,512)])])]),n(Se,{align:"right"},{default:i(()=>[n(se,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:c,color:"green"})]),_:1})])):T("",!0),vl,ml,fl],64))}};var _l=Te(pl,[["__scopeId","data-v-dfdeba34"]]);const hl=l=>(je("data-v-5d52020c"),l=l(),ze(),l),kl={key:0,class:"posterArea relative-position"},gl={style:{position:"absolute",right:"1em",top:"1em","z-index":"10"}},yl=hl(()=>_("img",{src:"/img/news/default_sketch.svg"},null,-1)),bl={class:"eventboxin"},wl={key:0},xl=["innerHTML"],Vl={key:1},Ml={key:1,class:"videoItem"},Dl={__name:"AnnounceDescr",emits:["delPoster"],setup(l,{emit:Q}){const D=String("https://api.sakh-orch.ru/"),H=Ae();Y("editMode");const s=Y("Announce"),q=y(()=>{let x=H.platform.is.mobile?1080:480;return s.value.poster?Pt(D,s.value.poster.md5,s.value.poster.ext,x):"/error.err"});function g(){return"https://vk.com/share.php?url="+String("https://sakh-orch.ru/")+"/announce/"+String(s.value.id)+"&title="+String(s.value.progName)+"&noparse=true&image="+String(q.value)}function I(){He.post(D+"api/event/poster.php",{params:{method:"unlink",id:s.value.id}}).then(x=>{var b;if(!((b=x==null?void 0:x.data)!=null&&b.result))throw new Error;delete s.value.poster,delete s.value.posterId}).catch(x=>{H.notify(Ie(x))})}return(x,b)=>(k(),A(z,null,[o(s).poster?(k(),A("div",kl,[_("div",gl,[n(Kt,{"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",onOnOk:b[0]||(b[0]=V=>I())})]),n(Yt,{src:q.value},{error:i(()=>[yl]),_:1},8,["src"])])):T("",!0),_("div",bl,[n(Dt,{class:"transparent no-padding",flat:""},{default:i(()=>[n(G,{class:"no-padding"},{default:i(()=>[n(ge,null,{default:i(()=>[n(j,null,{default:i(()=>[n(L,{class:"title"},{default:i(()=>[B(he(o(s).progName),1)]),_:1}),n(L,{class:"title"},{default:i(()=>[B(he(o(Nt)(o(s).eventTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),n(G,null,{default:i(()=>[(k(!0),A(z,null,Mt(o(s).parsedMD,(V,r)=>(k(),A(z,{key:r},[V.type==="text"?(k(),A("div",wl,[V.content!==`
`?(k(),A("div",{key:0,innerHTML:V.content,class:"textBlock"},null,8,xl)):(k(),A("br",Vl))])):T("",!0),V.type==="video"?(k(),A("div",Ml,[n(Ft,{ratio:16/9,src:"https://www.youtube.com/embed/"+V.content},null,8,["src"])])):T("",!0)],64))),128))]),_:1}),!o(s).completed&&[3,4].includes(o(s).pay)&&o(s).ticketLink?(k(),J(Se,{key:0,align:"right"})):T("",!0),n(G,null,{default:i(()=>[n(ge,{dense:""},{default:i(()=>[n(L,{caption:""},{default:i(()=>[B(" \u0423\u0432\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043F\u043E\u0441\u0435\u0442\u0438\u0442\u0435\u043B\u0438, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0440\u043E\u0441\u044C\u0431\u0430 \u0441\u043E\u0431\u043B\u044E\u0434\u0430\u0442\u044C \u043C\u0435\u0440\u044B \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438 \u0432 \u0441\u0432\u044F\u0437\u0438 \u0441 \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u0438\u0435\u043C \u043A\u043E\u0440\u043E\u043D\u0430\u0432\u0438\u0440\u0443\u0441\u043D\u043E\u0439 \u0438\u043D\u0444\u0435\u043A\u0446\u0438\u0438! ")]),_:1})]),_:1})]),_:1}),n(G,null,{default:i(()=>[n(ge,{clickable:"",href:o(s).Hall.map,target:"_blank"},{default:i(()=>[n(j,{avatar:""},{default:i(()=>[n(ie,{name:"place"})]),_:1}),n(j,null,{default:i(()=>[n(L,null,{default:i(()=>[B(he(o(s).Hall.name),1)]),_:1}),n(L,{caption:""},{default:i(()=>[B(he(o(s).Hall.address),1)]),_:1})]),_:1})]),_:1},8,["href"])]),_:1}),!o(s).completed&&[3,4].includes(o(s).pay)&&o(s).ticketLink?(k(),J(G,{key:1},{default:i(()=>[n(ge,{clickable:"",href:o(s).ticketLink,target:"_blank"},{default:i(()=>[o(s).pay===3?(k(),A(z,{key:0},[n(j,{avatar:""},{default:i(()=>[n(ie,{name:"shopping_cart"})]),_:1}),n(j,null,{default:i(()=>[n(L,null,{default:i(()=>[B("\u041A\u0443\u043F\u0438\u0442\u044C \u0431\u0438\u043B\u0435\u0442")]),_:1}),(k(),J(L,{key:0,caption:""},{default:i(()=>[B("+ \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043F\u043E \u043F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u043E\u0439 \u043A\u0430\u0440\u0442\u0435")]),_:1}))]),_:1})],64)):T("",!0),o(s).pay===4?(k(),A(z,{key:1},[n(j,{avatar:""},{default:i(()=>[n(ie,{name:"img:/img/uds.svg"})]),_:1}),n(j,null,{default:i(()=>[n(L,null,{default:i(()=>[B("\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439")]),_:1})]),_:1})],64)):T("",!0)]),_:1},8,["href"])]),_:1})):T("",!0),n(ye),n(G,{class:"no-padding"},{default:i(()=>[n(Fe,{"phone-number":"+7-(4242)-300-518"}),n(Fe,{"phone-number":"+7-(962)-416-36-89"})]),_:1}),n(ye,{spaced:"1em"}),n(Se,{align:"right"},{default:i(()=>[n(se,{href:g(),target:"_blank",icon:"ion-logo-vk",outline:"",style:{color:"var(--docTitle)"},label:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},null,8,["href"])]),_:1})]),_:1})])],64))}};var ql=Te(Dl,[["__scopeId","data-v-5d52020c"]]);const Cl={class:"eventboxl"},Sl={__name:"AnnouncePage",setup(l){const Q=Bt("\u0410\u043D\u043E\u043D\u0441");ct(Q);const D=Ae(),H=Y("editMode"),s=String("https://api.sakh-orch.ru/"),q=Ke(),g=U(),I=U(null);Ee("Announce",I);function x(){He.post(s+"api/event/announce.php",{params:{method:"get",id:q.params.evid}}).then(b=>{var V,r;I.value=(r=(V=b==null?void 0:b.data)==null?void 0:V.data)!=null?r:null,console.log("Announce loaded")}).catch(b=>{D.notify(Ie(b))})}return qt(()=>{x()}),(b,V)=>(k(),A(z,null,[o(H)&&I.value?(k(),J(_l,{key:0,onPosterUploaded:x,onReload:x,ref_key:"editorRef",ref:g},null,512)):T("",!0),_("div",Cl,[I.value?(k(),J(ql,{key:0,onDelPoster:V[0]||(V[0]=()=>{g.value.delPoster()})})):T("",!0)])],64))}};var un=Te(Sl,[["__scopeId","data-v-64b5a099"]]);export{un as default};
