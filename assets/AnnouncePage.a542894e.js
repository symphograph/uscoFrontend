import{Q as vt}from"./QScrollArea.3d1595d7.js";import{u as ft}from"./use-meta.efc19951.js";import{u as ye}from"./use-quasar.2b1b4907.js";import{a as ve}from"./axios.ad5085a6.js";import{V as pt,X as ht,bf as _t,Z as kt,di as gt,r as x,c as S,w as Me,aK as yt,W as bt,h as b,g as wt,dk as At,au as xt,a6 as Vt,a4 as Dt,ak as Pe,B as ne,i as X,m as k,E as O,f as l,q as o,x as i,b7 as de,A as _e,ax as w,n as W,t as Q,v as R,C as St,y as Be,z as Y,l as T,b as Mt,H as Ct,u as Je,I as qt,p as ae,o as Ze,a as It,D as ke,bl as Le,F as ce,G as Ut}from"./index.bd97e9c1.js";import{Q as Ne}from"./QSelect.c85d4813.js";import{a as Ht}from"./style.97a2fd80.js";/* empty css               */import{u as Ye,b as $t,c as Ot,_ as Se,g as Qt,f as Tt,Q as je,a as Pt}from"./QPopupProxy.034d26ae.js";import{T as Lt}from"./TouchPan.d2e1aed3.js";import{p as re}from"./format.de7e9769.js";import{C as ze}from"./ClosePopup.37ce5abd.js";import{n as ge,a as Re,i as Nt,b as Bt,g as Wt}from"./myFuncts.eda7a4d2.js";import{A as Et}from"./AnnounceCard.437c1cad.js";import{S as Kt,Q as Ft}from"./QInnerLoading.9b2d4082.js";import{m as Yt}from"./myAuth.5621b016.js";import{S as jt}from"./SelectComposer.a36dabb5.js";import{Q as B}from"./QItemLabel.2de18a52.js";import{Q as F,a as me}from"./QItem.42e8eee9.js";import{_ as We}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as Xe}from"./QImg.8430c3f7.js";import{Q as zt}from"./QVideo.00bd036e.js";import{_ as Ge}from"./PhoneNumber.e2d49d96.js";import{_ as Rt}from"./BtnDelete.5480a871.js";import"./QToolbarTitle.5ac10bcf.js";import"./QToolbar.46b6485c.js";import"./QLinearProgress.61f529b3.js";import{M as Xt}from"./MainFooter.76d58485.js";import"./QMenu.3a1b066a.js";import"./position-engine.55550dc5.js";import"./selection.db5b1e6e.js";import"./rtl.276c3f1b.js";import"./use-file.3e8e86c0.js";import"./get-emits-object.a3f16783.js";import"./use-render-cache.3aae9b27.js";import"./touch.9135741d.js";import"./QTooltip.0e7277dc.js";import"./QList.f2c9d2ce.js";import"./AuthorItem.ee6053cd.js";/* empty css                                                               *//* empty css                                                                   */import"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.95e4fb79.js";function Gt(a,P){if(a.hour!==null){if(a.minute===null)return"minute";if(P===!0&&a.second===null)return"second"}return"hour"}function Jt(){const a=new Date;return{hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds(),millisecond:a.getMilliseconds()}}var Zt=pt({name:"QTime",props:{...ht,..._t,...Ye,modelValue:{required:!0,validator:a=>typeof a=="string"||a===null},mask:{...Ye.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:a=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(a)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:$t,setup(a,{slots:P,emit:V}){const C=wt(),{$q:h}=C.proxy,s=kt(a,h),{tabindex:g,headerClass:L,getLocale:d,getCurrentDate:y}=Ot(a,h),_=gt(a),M=At(_);let q,I;const U=x(null),G=S(()=>te()),J=S(()=>d()),fe=S(()=>we()),j=Se(a.modelValue,G.value,J.value,a.calendar,fe.value),m=x(Gt(j)),u=x(j),D=x(j.hour===null||j.hour<12),Ce=S(()=>`q-time q-time--${a.landscape===!0?"landscape":"portrait"}`+(s.value===!0?" q-time--dark q-dark":"")+(a.disable===!0?" disabled":a.readonly===!0?" q-time--readonly":"")+(a.bordered===!0?" q-time--bordered":"")+(a.square===!0?" q-time--square no-border-radius":"")+(a.flat===!0?" q-time--flat no-shadow":"")),pe=S(()=>{const e=u.value;return{hour:e.hour===null?"--":H.value===!0?re(e.hour):String(D.value===!0?e.hour===0?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:e.minute===null?"--":re(e.minute),second:e.second===null?"--":re(e.second)}}),H=S(()=>a.format24h!==null?a.format24h:h.lang.date.format24h),qe=S(()=>{const e=m.value==="hour",t=e===!0?12:60,r=u.value[m.value];let A=`rotate(${Math.round(r*(360/t))-180}deg) translateX(-50%)`;return e===!0&&H.value===!0&&u.value.hour>=12&&(A+=" scale(.7)"),{transform:A}}),be=S(()=>u.value.hour!==null),oe=S(()=>be.value===!0&&u.value.minute!==null),N=S(()=>a.hourOptions!==void 0?e=>a.hourOptions.includes(e):a.options!==void 0?e=>a.options(e,null,null):null),ue=S(()=>a.minuteOptions!==void 0?e=>a.minuteOptions.includes(e):a.options!==void 0?e=>a.options(u.value.hour,e,null):null),ie=S(()=>a.secondOptions!==void 0?e=>a.secondOptions.includes(e):a.options!==void 0?e=>a.options(u.value.hour,u.value.minute,e):null),E=S(()=>{if(N.value===null)return null;const e=n(0,11,N.value),t=n(12,11,N.value);return{am:e,pm:t,values:e.values.concat(t.values)}}),Z=S(()=>ue.value!==null?n(0,59,ue.value):null),ee=S(()=>ie.value!==null?n(0,59,ie.value):null),se=S(()=>{switch(m.value){case"hour":return E.value;case"minute":return Z.value;case"second":return ee.value}}),Ie=S(()=>{let e,t,r=0,p=1;const A=se.value!==null?se.value.values:void 0;m.value==="hour"?H.value===!0?(e=0,t=23):(e=0,t=11,D.value===!1&&(r=12)):(e=0,t=55,p=5);const K=[];for(let v=e,$=e;v<=t;v+=p,$++){const le=v+r,ct=A!==void 0&&A.includes(le)===!1,mt=m.value==="hour"&&v===0?H.value===!0?"00":"12":v;K.push({val:le,index:$,disable:ct,label:mt})}return K}),Ue=S(()=>[[Lt,et,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Me(()=>a.modelValue,e=>{const t=Se(e,G.value,J.value,a.calendar,fe.value);(t.dateHash!==u.value.dateHash||t.timeHash!==u.value.timeHash)&&(u.value=t,t.hour===null?m.value="hour":D.value=t.hour<12)}),Me([G,J],()=>{xt(()=>{Te()})});function c(){const e={...y(),...Jt()};Te(e),Object.assign(u.value,e),m.value="hour"}function n(e,t,r){const p=Array.apply(null,{length:t+1}).map((A,K)=>{const v=K+e;return{index:v,val:r(v)===!0}}).filter(A=>A.val===!0).map(A=>A.index);return{min:p[0],max:p[p.length-1],values:p,threshold:t+1}}function f(e,t,r){const p=Math.abs(e-t);return Math.min(p,r-p)}function z(e,{min:t,max:r,values:p,threshold:A}){if(e===t)return t;if(e<t||e>r)return f(e,t,A)<=f(e,r,A)?t:r;const K=p.findIndex(le=>e<=le),v=p[K-1],$=p[K];return e-v<=$-e?v:$}function te(){return a.calendar!=="persian"&&a.mask!==null?a.mask:`HH:mm${a.withSeconds===!0?":ss":""}`}function we(){if(typeof a.defaultDate!="string"){const e=y(!0);return e.dateHash=Qt(e),e}return Se(a.defaultDate,"YYYY/MM/DD",void 0,a.calendar)}function He(){return Vt(C)===!0||se.value!==null&&(se.value.values.length===0||m.value==="hour"&&H.value!==!0&&E.value[D.value===!0?"am":"pm"].values.length===0)}function $e(){const e=U.value,{top:t,left:r,width:p}=e.getBoundingClientRect(),A=p/2;return{top:t+A,left:r+A,dist:A*.7}}function et(e){if(He()!==!0){if(e.isFirst===!0){q=$e(),I=Ae(e.evt,q);return}I=Ae(e.evt,q,I),e.isFinal===!0&&(q=!1,I=null,Ee())}}function Ee(){m.value==="hour"?m.value="minute":a.withSeconds&&m.value==="minute"&&(m.value="second")}function Ae(e,t,r){const p=yt(e),A=Math.abs(p.top-t.top),K=Math.sqrt(Math.pow(Math.abs(p.top-t.top),2)+Math.pow(Math.abs(p.left-t.left),2));let v,$=Math.asin(A/K)*(180/Math.PI);if(p.top<t.top?$=t.left<p.left?90-$:270+$:$=t.left<p.left?$+90:270-$,m.value==="hour"){if(v=$/30,E.value!==null){const le=H.value!==!0?D.value===!0:E.value.am.values.length!==0&&E.value.pm.values.length!==0?K>=t.dist:E.value.am.values.length!==0;v=z(v+(le===!0?0:12),E.value[le===!0?"am":"pm"])}else v=Math.round(v),H.value===!0?K<t.dist?v<12&&(v+=12):v===12&&(v=0):D.value===!0&&v===12?v=0:D.value===!1&&v!==12&&(v+=12);H.value===!0&&(D.value=v<12)}else v=Math.round($/6)%60,m.value==="minute"&&Z.value!==null?v=z(v,Z.value):m.value==="second"&&ee.value!==null&&(v=z(v,ee.value));return r!==v&&st[m.value](v),v}const Oe={hour(){m.value="hour"},minute(){m.value="minute"},second(){m.value="second"}};function tt(e){e.keyCode===13&&Ke()}function lt(e){e.keyCode===13&&Fe()}function at(e){He()!==!0&&(h.platform.is.desktop!==!0&&Ae(e,$e()),Ee())}function nt(e){He()!==!0&&Ae(e,$e())}function ot(e){if(e.keyCode===13)m.value="hour";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(E.value!==null){const r=H.value===!0?E.value.values:E.value[D.value===!0?"am":"pm"].values;if(r.length===0)return;if(u.value.hour===null)xe(r[0]);else{const p=(r.length+r.indexOf(u.value.hour)+t)%r.length;xe(r[p])}}else{const r=H.value===!0?24:12,p=H.value!==!0&&D.value===!1?12:0,A=u.value.hour===null?-t:u.value.hour;xe(p+(24+A+t)%r)}}}function ut(e){if(e.keyCode===13)m.value="minute";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(Z.value!==null){const r=Z.value.values;if(r.length===0)return;if(u.value.minute===null)Ve(r[0]);else{const p=(r.length+r.indexOf(u.value.minute)+t)%r.length;Ve(r[p])}}else{const r=u.value.minute===null?-t:u.value.minute;Ve((60+r+t)%60)}}}function it(e){if(e.keyCode===13)m.value="second";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(ee.value!==null){const r=ee.value.values;if(r.length===0)return;if(u.value.seconds===null)De(r[0]);else{const p=(r.length+r.indexOf(u.value.second)+t)%r.length;De(r[p])}}else{const r=u.value.second===null?-t:u.value.second;De((60+r+t)%60)}}}function xe(e){u.value.hour!==e&&(u.value.hour=e,he())}function Ve(e){u.value.minute!==e&&(u.value.minute=e,he())}function De(e){u.value.second!==e&&(u.value.second=e,he())}const st={hour:xe,minute:Ve,second:De};function Ke(){D.value===!1&&(D.value=!0,u.value.hour!==null&&(u.value.hour-=12,he()))}function Fe(){D.value===!0&&(D.value=!1,u.value.hour!==null&&(u.value.hour+=12,he()))}function Qe(e){const t=a.modelValue;m.value!==e&&t!==void 0&&t!==null&&t!==""&&typeof t!="string"&&(m.value=e)}function he(){if(N.value!==null&&N.value(u.value.hour)!==!0){u.value=Se(),Qe("hour");return}if(ue.value!==null&&ue.value(u.value.minute)!==!0){u.value.minute=null,u.value.second=null,Qe("minute");return}if(a.withSeconds===!0&&ie.value!==null&&ie.value(u.value.second)!==!0){u.value.second=null,Qe("second");return}u.value.hour===null||u.value.minute===null||a.withSeconds===!0&&u.value.second===null||Te()}function Te(e){const t=Object.assign({...u.value},e),r=a.calendar==="persian"?re(t.hour)+":"+re(t.minute)+(a.withSeconds===!0?":"+re(t.second):""):Tt(new Date(t.year,t.month===null?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),G.value,J.value,t.year,t.timezoneOffset);t.changed=r!==a.modelValue,V("update:modelValue",r,t)}function rt(){const e=[b("div",{class:"q-time__link "+(m.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Oe.hour,onKeyup:ot},pe.value.hour),b("div",":"),b("div",be.value===!0?{class:"q-time__link "+(m.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:ut,onClick:Oe.minute}:{class:"q-time__link"},pe.value.minute)];a.withSeconds===!0&&e.push(b("div",":"),b("div",oe.value===!0?{class:"q-time__link "+(m.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:it,onClick:Oe.second}:{class:"q-time__link"},pe.value.second));const t=[b("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},e)];return H.value===!1&&t.push(b("div",{class:"q-time__header-ampm column items-between no-wrap"},[b("div",{class:"q-time__link "+(D.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Ke,onKeyup:tt},"AM"),b("div",{class:"q-time__link "+(D.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Fe,onKeyup:lt},"PM")])),b("div",{class:"q-time__header flex flex-center no-wrap "+L.value},t)}function dt(){const e=u.value[m.value];return b("div",{class:"q-time__content col relative-position"},[b(Dt,{name:"q-transition--scale"},()=>b("div",{key:"clock"+m.value,class:"q-time__container-parent absolute-full"},[b("div",{ref:U,class:"q-time__container-child fit overflow-hidden"},[Pe(b("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:at,onMousedown:nt},[b("div",{class:"q-time__clock-circle fit"},[b("div",{class:"q-time__clock-pointer"+(u.value[m.value]===null?" hidden":a.color!==void 0?` text-${a.color}`:""),style:qe.value}),Ie.value.map(t=>b("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${t.index}`+(t.val===e?" q-time__clock-position--active "+L.value:t.disable===!0?" q-time__clock-position--disable":"")},[b("span",t.label)]))])]),Ue.value)])])),a.nowBtn===!0?b(ne,{class:"q-time__now-button absolute",icon:h.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:a.color,textColor:a.textColor,tabindex:g.value,onClick:c}):null])}return C.proxy.setNow=c,()=>{const e=[dt()],t=bt(P.default);return t!==void 0&&e.push(b("div",{class:"q-time__actions"},t)),a.name!==void 0&&a.disable!==!0&&M(e,"push"),b("div",{class:Ce.value,tabindex:-1},[rt(),b("div",{class:"q-time__main col overflow-auto"},e)])}}});const el={class:"q-pa-md",style:{"max-width":"300px",padding:"0"}},tl={class:"row items-center justify-end"},ll={class:"row items-center justify-end"},al={__name:"DateTime",props:{evDateTime:x("2019-02-01 12:44")},emits:["update:date"],setup(a,{emit:P}){const V=X("Announce");return x(a.evDateTime),(h,s)=>(k(),O("div",el,[l(de,{filled:"",modelValue:i(V).eventTime,"onUpdate:modelValue":s[2]||(s[2]=g=>i(V).eventTime=g),mask:"####-##-## ##:##"},{prepend:o(()=>[l(_e,{name:"event",class:"cursor-pointer"},{default:o(()=>[l(je,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[l(Pt,{modelValue:i(V).eventTime,"onUpdate:modelValue":s[0]||(s[0]=g=>i(V).eventTime=g),mask:"YYYY-MM-DD HH:mm"},{default:o(()=>[w("div",tl,[Pe(l(ne,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[ze]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:o(()=>[l(_e,{name:"access_time",class:"cursor-pointer"},{default:o(()=>[l(je,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[l(Zt,{modelValue:i(V).eventTime,"onUpdate:modelValue":s[1]||(s[1]=g=>i(V).eventTime=g),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:o(()=>[w("div",ll,[Pe(l(ne,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[ze]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},nl={__name:"WorkSelectItem",props:{work:Object},setup(a){const P=ye();return(V,C)=>(k(),W(me,{clickable:"",dense:""},{default:o(()=>[l(F,null,{default:o(()=>[l(B,null,{default:o(()=>[Q(R(a.work.titleRu),1)]),_:1}),l(B,{caption:""},{default:o(()=>[Q(R(a.work.titleEn),1)]),_:1})]),_:1}),l(F,{side:"",class:"opus"},{default:o(()=>[l(B,{caption:""},{default:o(()=>{var h;return[Q(R((h=a.work.opus)!=null?h:"Op.?"),1)]}),_:1}),l(B,{caption:""},{default:o(()=>{var h;return[Q(R((h=a.work.icatno)!=null?h:"cat\u2116.?"),1)]}),_:1}),l(B,{caption:""},{default:o(()=>{var h;return[Q(R((h=a.work.catalogIndex)!=null?h:"catIdx: ?"),1)]}),_:1}),l(ne,{dense:"","icon-right":"content_copy",flat:"",label:`ID: ${a.work.id}`,onClick:C[0]||(C[0]=St(h=>V.copy(a.work.id,i(P)),["prevent","stop"]))},null,8,["label"])]),_:1})]),_:1}))}},ol={__name:"AddWorkDialog",emits:["workSelected"],setup(a,{emit:P}){const V=ye(),C=String("https://api.staff.sakh-orch.ru/"),h=X("isOpenAddWorkDialog"),s=x(!1),g=X("selectedAuthorId");X("selectedAuthor");const L=P,d=x([]),y=x(null);function _(){console.log("authorSelected"),g.value&&(s.value=!0,ve.post(C+"/api/lib/work.php",{params:{method:"list",authorId:g.value}}).then(q=>{var I,U;d.value=(U=(I=q==null?void 0:q.data)==null?void 0:I.data)!=null?U:[]}).catch(q=>{d.value=[],V.notify(notifyError(q))}).finally(()=>{s.value=!1}))}function M(){s.value=!1}return(q,I)=>(k(),W(Ct,{modelValue:i(h),"onUpdate:modelValue":I[2]||(I[2]=U=>Mt(h)?h.value=U:null),onBeforeHide:M},{default:o(()=>[l(Be,{bordered:"",class:"dialogArea"},{default:o(()=>[l(Y,null,{default:o(()=>[l(jt,{onItSel:_})]),_:1}),i(g)?(k(),W(Y,{key:0},{default:o(()=>[l(Ne,{modelValue:y.value,"onUpdate:modelValue":[I[0]||(I[0]=U=>y.value=U),I[1]||(I[1]=U=>L("workSelected",y.value))],options:d.value,"option-label":"titleRu","option-value":"id","map-options":"",label:"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0435"},{option:o(U=>[l(nl,{work:U.opt},null,8,["work"])]),_:1},8,["modelValue","options"])]),_:1})):T("",!0)]),_:1})]),_:1},8,["modelValue"]))}};const ul={key:0,class:"eventsarea"},il={class:"editArea"},sl={class:"card"},rl={class:"editor"},dl={style:{display:"flex","justify-content":"space-between"}},cl={class:"uploads"},ml={style:{width:"100%"}},vl={class:"uploads"},fl={__name:"AnnounceEditor",emits:["reload","posterUploaded"],setup(a,{expose:P,emit:V}){const C=String("https://api.staff.sakh-orch.ru/"),h=String("https://api.sakh-orch.ru/"),s=ye(),g=Je(),L=qt(),d=X("Announce"),y=X("Halls"),_=x("");ae("pwUrl",_);const M=V,q={};function I(){}const U=[{label:"\u0412\u0445\u043E\u0434 \u0441\u0432\u043E\u0431\u043E\u0434\u043D\u044B\u0439",value:2},{label:"\u0411\u0438\u043B\u0435\u0442\u044B \u0432 \u043F\u0440\u043E\u0434\u0430\u0436\u0435",value:3},{label:"\u0412\u0445\u043E\u0434 \u043F\u043E \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C",value:4},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",value:5}],G=x(null),J=x(null),fe=x(!1);ae("isOpenAddWorkDialog",fe);const j=x([]);ae("AuthorSelectList",j);const m=x(!1);ae("loadingAuthors",m);const u=x(0);ae("selectedAuthorId",u);const D=x(null);ae("selectedAuthor",D),Me(u,()=>{D.value=j.value.find(c=>c.id===u.value)});function Ce(){m.value=!0,ve.post(C+"/api/lib/author.php",{params:{method:"all"}}).then(c=>{var n,f;j.value=(f=(n=c==null?void 0:c.data)==null?void 0:n.data)!=null?f:[]}).catch(c=>{j.value=[],s.notify(ge(c))}).finally(()=>{m.value=!1})}function pe(){fe.value=!0}function H(c){return{url:h+"api/event/poster.php",headers:[{name:"ACCESSTOKEN",value:Yt.self.AccessToken}],formFields:[{name:"id",value:d.value.id},{name:"method",value:"add"}]}}function qe(c){s.notify(Re("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),M("posterUploaded")}function be(c){s.notify(Re("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),M("posterUploaded"),G.value.reset(),oe.value=!0}const oe=x(!1);let N=null;Me(oe,c=>{console.log("photoWatcher"),c&&!N?N=setInterval(Ue,3e3):!c&&N&&(clearInterval(N),N=null)});function ue(c){var f,z,te;let n=(te=(z=JSON.parse((f=c==null?void 0:c.xhr)==null?void 0:f.response))==null?void 0:z.error)!=null?te:"";s.notify(ge(null,n))}function ie(){J.value.saveData()}function E(){L.push({path:"/announces"})}function Z(){M("reload")}function ee(){delete d.value.sketch,delete d.value.sketchId}function se(){d.value.hallId=d.value.Hall.id}function Ie(){ve.post(h+"api/event/announce.php",{params:{method:"updateMarkdown",id:d.value.id,markdown:d.value.description}}).then(c=>{var n;if(!((n=c==null?void 0:c.data)!=null&&n.result))throw new Error;d.value.parsedMD=c==null?void 0:c.data.data}).catch(c=>{})}function Ue(){ve.post(h+"api/event/poster.php",{params:{method:"get",announceId:g.params.evid}}).then(c=>{var n,f,z,te,we;if(!((n=c==null?void 0:c.data)!=null&&n.result))throw new Error;d.value.poster=(z=(f=c==null?void 0:c.data)==null?void 0:f.data)!=null?z:null,((we=(te=d.value)==null?void 0:te.poster)==null?void 0:we.status)!=="process"&&(oe.value=!1)}).catch(c=>{oe.value=!1,s.notify(ge(c))}).finally(()=>{})}return P({}),Ze(()=>{Ce()}),It(()=>{N&&clearInterval(N)}),(c,n)=>(k(),O(ce,null,[i(d)?(k(),O("div",ul,[w("div",il,[w("div",sl,[i(d).Hall.map?(k(),W(Et,{key:0,onIamDeleted:E,onNewAnnounce:Z,onDelSketch:ee,ref_key:"rAnnounceCard",ref:J,Announce:i(d),pwUrl:_.value},null,8,["Announce","pwUrl"])):T("",!0)]),w("div",rl,[w("div",dl,[l(al,{date:i(d).eventTime,"onUpdate:date":[n[0]||(n[0]=f=>i(d).eventTime=f),n[1]||(n[1]=f=>void 0)]},null,8,["date"])]),n[12]||(n[12]=w("br",null,null,-1)),n[13]||(n[13]=w("hr",null,null,-1)),w("div",cl,[w("div",ml,[l(Kt,{id:i(d).id,type:"event",onOnUploaded:qe},null,8,["id"])])]),l(ke,{spaced:"1em"}),l(de,{name:"progName",modelValue:i(d).progName,"onUpdate:modelValue":n[2]||(n[2]=f=>i(d).progName=f),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),l(Ne,{modelValue:i(d).Hall,"onUpdate:modelValue":[n[3]||(n[3]=f=>i(d).Hall=f),n[4]||(n[4]=f=>se())],label:"\u041C\u0435\u0441\u0442\u043E \u043F\u0440\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F","map-options":"","option-label":"name","option-value":"id",options:i(y)},null,8,["modelValue","options"]),l(Ne,{modelValue:i(d).pay,"onUpdate:modelValue":n[5]||(n[5]=f=>i(d).pay=f),"emit-value":"","map-options":"",label:"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0432\u0445\u043E\u0434\u0430",options:U},null,8,["modelValue"]),n[14]||(n[14]=w("br",null,null,-1)),[3,4].includes(i(d).pay)?(k(),W(de,{key:0,type:"text",modelValue:i(d).ticketLink,"onUpdate:modelValue":n[6]||(n[6]=f=>i(d).ticketLink=f),label:"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435 \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"])):T("",!0),n[15]||(n[15]=w("br",null,null,-1)),l(de,{type:"number",modelValue:i(d).age,"onUpdate:modelValue":n[7]||(n[7]=f=>i(d).age=f),label:"\u0412\u043E\u0437\u0440\u0430\u0441\u0442\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"},null,8,["modelValue"]),n[16]||(n[16]=w("br",null,null,-1)),l(de,{name:"evDescr",modelValue:i(d).sdescr,"onUpdate:modelValue":n[8]||(n[8]=f=>i(d).sdescr=f),type:"textarea",autogrow:"",label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),n[17]||(n[17]=w("br",null,null,-1)),l(de,{name:"evText",modelValue:i(d).description,"onUpdate:modelValue":[n[9]||(n[9]=f=>i(d).description=f),n[10]||(n[10]=f=>Ie())],type:"textarea",autogrow:"",debounce:300,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),l(ke,{spaced:"1em"}),w("div",vl,[l(Ht,{modelValue:q,"onUpdate:modelValue":n[11]||(n[11]=f=>q=f),style:{width:"100%"},label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",factory:H,ref_key:"posterUploader",ref:G,onUploaded:be,onFailed:ue,"no-thumbnails":""},null,512)])]),l(ke,{spaced:"1em"})]),l(Le,{align:"right"},{default:o(()=>[l(ne,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:ie,color:"green"})]),_:1})])):T("",!0),n[19]||(n[19]=w("br",null,null,-1)),n[20]||(n[20]=w("hr",null,null,-1)),n[21]||(n[21]=w("br",null,null,-1)),l(Be,null,{default:o(()=>[l(Y,null,{default:o(()=>n[18]||(n[18]=[Q("\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0439:")])),_:1}),l(Y,null,{default:o(()=>[l(ne,{icon:"add",label:"\u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C",onClick:pe})]),_:1})]),_:1}),l(ol)],64))}};var pl=We(fl,[["__scopeId","data-v-555a2f42"]]);const hl={key:0,class:"posterArea relative-position"},_l={key:0,style:{position:"absolute",right:"1em",top:"1em","z-index":"10"}},kl={class:"eventboxin"},gl={key:0},yl=["innerHTML"],bl={key:1},wl={key:1,class:"videoItem"},Al={__name:"AnnounceDescr",emits:["delPoster"],setup(a,{emit:P}){const V=String("https://api.sakh-orch.ru/"),C=ye(),h=X("editMode"),s=X("Announce"),g=S(()=>{let y=C.platform.is.mobile?1080:480;return s.value.poster?Nt(V,s.value.poster.md5,s.value.poster.ext,y):"/error.err"});function L(){return"https://vk.com/share.php?url="+String("https://sakh-orch.ru/")+"/announce/"+String(s.value.id)+"&title="+String(s.value.progName)+"&noparse=true&image="+String(g.value)}function d(){ve.post(V+"api/event/poster.php",{params:{method:"unlink",id:s.value.id}}).then(y=>{var _;if(!((_=y==null?void 0:y.data)!=null&&_.result))throw new Error;delete s.value.poster,delete s.value.posterId}).catch(y=>{C.notify(ge(y))})}return(y,_)=>(k(),O(ce,null,[i(s).poster?(k(),O("div",hl,[i(h)?(k(),O("div",_l,[l(Rt,{"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",onOnOk:_[0]||(_[0]=M=>d())})])):T("",!0),i(s).poster.status==="process"?(k(),W(me,{key:1},{default:o(()=>[l(Xe),l(F,null,{default:o(()=>[l(Ft,{showing:"",label:"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430"})]),_:1})]),_:1})):(k(),W(Xe,{key:2,src:g.value},{error:o(()=>_[1]||(_[1]=[w("img",{src:"/img/news/default_sketch.svg"},null,-1)])),_:1},8,["src"]))])):T("",!0),w("div",kl,[l(Be,{class:"transparent no-padding",flat:""},{default:o(()=>[l(Y,{class:"no-padding"},{default:o(()=>[l(me,null,{default:o(()=>[l(F,null,{default:o(()=>[l(B,{class:"title"},{default:o(()=>[Q(R(i(s).progName),1)]),_:1}),l(B,{class:"title"},{default:o(()=>[Q(R(i(Bt)(i(s).eventTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(Y,null,{default:o(()=>[(k(!0),O(ce,null,Ut(i(s).parsedMD,(M,q)=>(k(),O(ce,{key:q},[M.type==="text"?(k(),O("div",gl,[M.content!==`
`?(k(),O("div",{key:0,innerHTML:M.content,class:"textBlock"},null,8,yl)):(k(),O("br",bl))])):T("",!0),M.type==="video"?(k(),O("div",wl,[l(zt,{ratio:16/9,src:"https://www.youtube.com/embed/"+M.content},null,8,["src"])])):T("",!0)],64))),128))]),_:1}),!i(s).completed&&[3,4].includes(i(s).pay)&&i(s).ticketLink?(k(),W(Le,{key:0,align:"right"})):T("",!0),l(Y,null,{default:o(()=>[l(me,{dense:""},{default:o(()=>[l(B,{caption:""},{default:o(()=>_[2]||(_[2]=[Q(" \u0423\u0432\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043F\u043E\u0441\u0435\u0442\u0438\u0442\u0435\u043B\u0438, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0440\u043E\u0441\u044C\u0431\u0430 \u0441\u043E\u0431\u043B\u044E\u0434\u0430\u0442\u044C \u043C\u0435\u0440\u044B \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438 \u0432 \u0441\u0432\u044F\u0437\u0438 \u0441 \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u0438\u0435\u043C \u043A\u043E\u0440\u043E\u043D\u0430\u0432\u0438\u0440\u0443\u0441\u043D\u043E\u0439 \u0438\u043D\u0444\u0435\u043A\u0446\u0438\u0438! ")])),_:1})]),_:1})]),_:1}),l(Y,null,{default:o(()=>[l(me,{clickable:"",href:i(s).Hall.map,target:"_blank"},{default:o(()=>[l(F,{avatar:""},{default:o(()=>[l(_e,{name:"place"})]),_:1}),l(F,null,{default:o(()=>[l(B,null,{default:o(()=>[Q(R(i(s).Hall.name),1)]),_:1}),l(B,{caption:""},{default:o(()=>[Q(R(i(s).Hall.address),1)]),_:1})]),_:1})]),_:1},8,["href"])]),_:1}),!i(s).completed&&[3,4].includes(i(s).pay)&&i(s).ticketLink?(k(),W(Y,{key:1},{default:o(()=>[l(me,{clickable:"",href:i(s).ticketLink,target:"_blank"},{default:o(()=>[i(s).pay===3?(k(),O(ce,{key:0},[l(F,{avatar:""},{default:o(()=>[l(_e,{name:"shopping_cart"})]),_:1}),l(F,null,{default:o(()=>[l(B,null,{default:o(()=>_[3]||(_[3]=[Q("\u041A\u0443\u043F\u0438\u0442\u044C \u0431\u0438\u043B\u0435\u0442")])),_:1}),(k(),W(B,{key:0,caption:""},{default:o(()=>_[4]||(_[4]=[Q("+ \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043F\u043E \u043F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u043E\u0439 \u043A\u0430\u0440\u0442\u0435")])),_:1}))]),_:1})],64)):T("",!0),i(s).pay===4?(k(),O(ce,{key:1},[l(F,{avatar:""},{default:o(()=>[l(_e,{name:"img:/img/uds.svg"})]),_:1}),l(F,null,{default:o(()=>[l(B,null,{default:o(()=>_[5]||(_[5]=[Q("\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439")])),_:1})]),_:1})],64)):T("",!0)]),_:1},8,["href"])]),_:1})):T("",!0),l(ke),l(Y,{class:"no-padding"},{default:o(()=>[l(Ge,{"phone-number":"+7-(4242)-300-518"}),l(Ge,{"phone-number":"+7-(962)-416-36-89"})]),_:1}),l(ke,{spaced:"1em"}),l(Le,{align:"right"},{default:o(()=>[l(ne,{href:L(),target:"_blank",outline:"",icon:"img:/img/logo/vk/VK Logo Black & White.svg",label:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},null,8,["href"])]),_:1})]),_:1})])],64))}};var xl=We(Al,[["__scopeId","data-v-10491d29"]]);const Vl={class:"centralCol"},Dl={class:"eventboxl"},Sl={__name:"AnnouncePage",setup(a){const P=Wt("\u0410\u043D\u043E\u043D\u0441");ft(P);const V=ye(),C=X("editMode"),h=String("https://api.sakh-orch.ru/"),s=Je(),g=x(),L=x(null);ae("Announce",L);function d(){ve.post(h+"api/event/announce.php",{params:{method:"get",id:s.params.evid}}).then(y=>{var _,M;L.value=(M=(_=y==null?void 0:y.data)==null?void 0:_.data)!=null?M:null,console.log("Announce loaded")}).catch(y=>{V.notify(ge(y))})}return Ze(()=>{d()}),(y,_)=>(k(),W(vt,{class:"col myScrollArea"},{default:o(()=>[w("div",Vl,[i(C)&&L.value?(k(),W(pl,{key:0,onPosterUploaded:d,onReload:d,ref_key:"editorRef",ref:g},null,512)):T("",!0),w("div",Dl,[L.value?(k(),W(xl,{key:0,onDelPoster:_[0]||(_[0]=()=>{g.value.delPoster()})})):T("",!0)])]),l(Xt)]),_:1}))}};var ha=We(Sl,[["__scopeId","data-v-beb09c0a"]]);export{ha as default};
