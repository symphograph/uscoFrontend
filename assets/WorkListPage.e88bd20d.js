import{i as p,c as B,w as O,m as c,n as w,q as i,D as R,F as D,E as S,r as m,f as r,B as P,y as T,bi as V,v as a,A as E,x as M,b as N,G as q,I as F,H,p as g,o as $,l as A,z as j,ax as z}from"./index.e0f85654.js";import"./QImg.2e8349d1.js";import"./QItemLabel.36b7e39e.js";import"./QSelect.7622fe6b.js";import{A as G}from"./AuthorItem.f7420d9e.js";/* empty css                                                                   */import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";import"./LocalStorage.fd40e000.js";import{u as Q}from"./use-quasar.f463e671.js";import"./axios.42d422c9.js";import{Q as K}from"./QList.e09df5eb.js";import{W as X}from"./WorkItem.3dbfff00.js";import"./myFuncts.0887c750.js";import{P as Y}from"./PageShell.46b7f308.js";import{Q as Z}from"./QForm.321b90ad.js";/* empty css               */import{W as C,A as ee}from"./lib.beeda29a.js";import"./QMenu.71680b5c.js";import"./position-engine.6acbd510.js";import"./selection.289153d1.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./BtnDelete.456e0377.js";import"./QTooltip.cd2ab7d7.js";import"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.24bd73f4.js";import"./touch.9135741d.js";import"./QScrollArea.edf23b1f.js";import"./QLinearProgress.ca3f1b6e.js";/* empty css                                                    */import"./myAxios.8b50438a.js";const te={__name:"WorkList",emits:["onDel"],setup(W,{emit:f}){const u=p("works"),s=p("searchText"),d=B(()=>{if(!s.value)return u.value;const l=s.value.toLowerCase();return u.value.filter(e=>(e.titleRu?e.titleRu.toLowerCase().includes(l):!1)||(e.titleEn?e.titleEn.toLowerCase().includes(l):!1))}),o=f;return O(s,(l,e)=>{console.log("Search text changed from",e,"to",l)}),(l,e)=>(c(),w(K,{separator:""},{default:i(()=>[(c(!0),R(D,null,S(d.value,v=>(c(),w(X,{key:v.id,work:v,onOnDel:e[0]||(e[0]=_=>o("onDel"))},null,8,["work"]))),128))]),_:1}))}},oe={__name:"WorkDialog",emits:["onSave"],setup(W,{emit:f}){const u=Q(),s=p("isOpenWorkDialog"),d=m(!1),o=p("work"),l=m();function e(){s.value=!1}const v=f;function _(){!h()||x()}async function x(){await C.add(u,o.value)&&(v("onSave"),e())}function k(){d.value=!1}function h(){return l.value.validate()}return(b,t)=>(c(),w(q,{modelValue:a(s),"onUpdate:modelValue":t[4]||(t[4]=n=>N(s)?s.value=n:null),onBeforeHide:k},{default:i(()=>[r(M,{bordered:"",class:"dialogArea"},{default:i(()=>[r(Z,{onSubmit:P(_,["prevent","stop"])},{default:i(()=>[r(T,null,{default:i(()=>[r(V,{modelValue:a(o).titleRu,"onUpdate:modelValue":t[0]||(t[0]=n=>a(o).titleRu=n),ref_key:"refTitle",ref:l,prefix:"RU",label:"\u0420\u0443\u0441\u0441\u043A\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),r(V,{modelValue:a(o).titleEn,"onUpdate:modelValue":t[1]||(t[1]=n=>a(o).titleEn=n),prefix:"EN",label:"\u041C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),r(V,{modelValue:a(o).opus,"onUpdate:modelValue":t[2]||(t[2]=n=>a(o).opus=n),prefix:"Op.",label:"\u041E\u043F\u0443\u0441"},null,8,["modelValue"]),r(V,{modelValue:a(o).catalogIndex,"onUpdate:modelValue":t[3]||(t[3]=n=>a(o).catalogIndex=n),label:"\u041A\u0430\u0442\u0430\u043B\u043E\u0433. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440: BWV 123"},null,8,["modelValue"]),r(E,{type:"submit",label:"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const ae={class:"centralCol"},le={__name:"WorkListPage",setup(W){const f=Q(),u=F();H();const s=m("");g("searchText",s);const d=m(!1);g("progress",d);const o=m([]);g("works",o);const l=p("selectedAuthorId"),e=p("selectedAuthor"),v=p("editMode"),_=m(!1);g("isOpenWorkDialog",_);const x=m(null);g("work",x);async function k(){d.value=!0;const t=await C.getListByAuthor(f,u.params.authorId);t&&(o.value=t),d.value=!1}async function h(){const t=await ee.get(f,l.value);t&&(e.value=t)}function b(){x.value={id:void 0,titleRu:"",titleEn:"",authorId:l.value,opus:"",icatno:""},_.value=!0}return $(()=>{l.value=u.params.authorId*1,h(),k(),console.log(e.value)}),(t,n)=>(c(),R(D,null,[r(Y,{"page-title":"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u044F "},{ToolPanel:i(()=>{var y,I,L;return[a(v)?(c(),w(E,{key:0,onClick:b,icon:"add",flat:"",round:""})):A("",!0),r(G,{id:a(l),iofEn:(y=a(e))==null?void 0:y.iofEn,iconUrl:(I=a(e))==null?void 0:I.iconUrl,fioRu:(L=a(e))==null?void 0:L.fioRu},null,8,["id","iofEn","iconUrl","fioRu"]),r(V,{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=U=>s.value=U),style:{width:"100%","max-width":"16em"},label:"\u0444\u0438\u043B\u044C\u0442\u0440","stack-label":"",clearable:""},{append:i(()=>[r(j,{name:"search"})]),_:1},8,["modelValue"])]}),PageContent:i(()=>[z("div",ae,[o.value.length?(c(),w(te,{key:0,onOnDel:k})):A("",!0)])]),_:1}),r(oe,{onOnSave:k})],64))}};var Be=J(le,[["__scopeId","data-v-a2ff4c92"]]);export{Be as default};
