import{Q as Ou,M as Hu}from"./QScrollArea.767b0782.js";import{u as Uu}from"./use-meta.e8a02c93.js";import{u as ae}from"./use-quasar.ab0f1e42.js";import{c as Iu,a as we}from"./axios.d263a8b0.js";import{Q as O}from"./QItemLabel.2d316d6a.js";import{Q as $,b as z,a as lu}from"./QImg.9eb68109.js";import{V as Fu,X as Lu,bb as Pu,Z as Qu,di as Tu,r as b,c as j,w as Oe,aJ as Wu,W as Ru,h as R,g as Nu,dk as Ku,au as ju,a6 as Yu,a4 as zu,ak as Ke,A as J,i as ne,m,D as W,f as e,q as u,v as s,bi as re,z as xe,ax as N,n as H,t as E,u as P,B as je,l as Q,d as ve,cR as Ju,cq as vu,b as Ue,G as Je,y as ue,bm as ce,x as Ve,k as Ie,bk as fu,bl as mu,o as Xe,p as le,F as Z,E as He,df as Ye,C as se,I as pu,H as Xu,a as Gu,ay as nu}from"./index.7d1b9a4d.js";import{Q as Se}from"./QSelect.b07c2952.js";import{Q as gu}from"./QTooltip.834cbc11.js";import{T as Zu,d as Fe,b as _u}from"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.c98b8949.js";import{a as et}from"./style.42df4ef8.js";/* empty css               */import{u as au,b as ut,c as tt,_ as qe,g as lt,f as nt,Q as ou,a as at}from"./QPopupProxy.1fd7cca2.js";import{p as Ce}from"./format.de7e9769.js";import{C as iu}from"./ClosePopup.000fe1d9.js";import{n as he,a as su,i as ot,c as it,g as st}from"./myFuncts.c4a4425d.js";import{A as dt}from"./AnnounceCard.92cbca98.js";import{S as rt,Q as ct}from"./QInnerLoading.86e02990.js";import{m as vt}from"./myAuth.5621b016.js";import{S as ft}from"./SelectComposer.4bdaf165.js";import{W as ke,P as ze,A as mt}from"./lib.0c111b23.js";import{_ as Le}from"./BtnDelete.8fb63d02.js";import{H as _e}from"./hall.d9b4c9c0.js";import{m as hu}from"./entry.3386aa3b.js";import{Q as du}from"./QList.42d90b60.js";import{_ as ru}from"./BtnMoveSort.f3bff816.js";import{_ as Ge}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as pt}from"./QVideo.8d8db579.js";import{_ as cu}from"./PhoneNumber.91162d32.js";import"./QToolbarTitle.56c0f330.js";import"./QLinearProgress.19101882.js";import"./QMenu.def2b318.js";import"./position-engine.edee25d0.js";import"./selection.11f3eb57.js";import"./use-virtual-scroll.fd0d31d1.js";import"./rtl.276c3f1b.js";import"./touch.9135741d.js";import"./use-file.70adcbbd.js";import"./get-emits-object.a3f16783.js";import"./use-render-cache.3aae9b27.js";import"./AuthorItem.5d12af39.js";import"./myAxios.afbb5a4e.js";function gt(l,B){if(l.hour!==null){if(l.minute===null)return"minute";if(B===!0&&l.second===null)return"second"}return"hour"}function _t(){const l=new Date;return{hour:l.getHours(),minute:l.getMinutes(),second:l.getSeconds(),millisecond:l.getMilliseconds()}}var ht=Fu({name:"QTime",props:{...Lu,...Pu,...au,modelValue:{required:!0,validator:l=>typeof l=="string"||l===null},mask:{...au.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:l=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(l)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:ut,setup(l,{slots:B,emit:v}){const c=Nu(),{$q:i}=c.proxy,o=Qu(l,i),{tabindex:p,headerClass:a,getLocale:h,getCurrentDate:g}=tt(l,i),k=Tu(l),A=Ku(k);let C,T;const Y=b(null),U=j(()=>ku()),w=j(()=>h()),V=j(()=>yu()),x=qe(l.modelValue,U.value,w.value,l.calendar,V.value),f=b(gt(x)),r=b(x),F=b(x.hour===null||x.hour<12),L=j(()=>`q-time q-time--${l.landscape===!0?"landscape":"portrait"}`+(o.value===!0?" q-time--dark q-dark":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-time--readonly":"")+(l.bordered===!0?" q-time--bordered":"")+(l.square===!0?" q-time--square no-border-radius":"")+(l.flat===!0?" q-time--flat no-shadow":"")),I=j(()=>{const t=r.value;return{hour:t.hour===null?"--":_.value===!0?Ce(t.hour):String(F.value===!0?t.hour===0?12:t.hour:t.hour>12?t.hour-12:t.hour),minute:t.minute===null?"--":Ce(t.minute),second:t.second===null?"--":Ce(t.second)}}),_=j(()=>l.format24h!==null?l.format24h:i.lang.date.format24h),ye=j(()=>{const t=f.value==="hour",n=t===!0?12:60,y=r.value[f.value];let K=`rotate(${Math.round(y*(360/n))-180}deg) translateX(-50%)`;return t===!0&&_.value===!0&&r.value.hour>=12&&(K+=" scale(.7)"),{transform:K}}),fe=j(()=>r.value.hour!==null),X=j(()=>fe.value===!0&&r.value.minute!==null),oe=j(()=>l.hourOptions!==void 0?t=>l.hourOptions.includes(t):l.options!==void 0?t=>l.options(t,null,null):null),be=j(()=>l.minuteOptions!==void 0?t=>l.minuteOptions.includes(t):l.options!==void 0?t=>l.options(r.value.hour,t,null):null),Ae=j(()=>l.secondOptions!==void 0?t=>l.secondOptions.includes(t):l.options!==void 0?t=>l.options(r.value.hour,r.value.minute,t):null),ee=j(()=>{if(oe.value===null)return null;const t=pe(0,11,oe.value),n=pe(12,11,oe.value);return{am:t,pm:n,values:t.values.concat(n.values)}}),ie=j(()=>be.value!==null?pe(0,59,be.value):null),D=j(()=>Ae.value!==null?pe(0,59,Ae.value):null),d=j(()=>{switch(f.value){case"hour":return ee.value;case"minute":return ie.value;case"second":return D.value}}),M=j(()=>{let t,n,y=0,q=1;const K=d.value!==null?d.value.values:void 0;f.value==="hour"?_.value===!0?(t=0,n=23):(t=0,n=11,F.value===!1&&(y=12)):(t=0,n=55,q=5);const te=[];for(let S=t,G=t;S<=n;S+=q,G++){const ge=S+y,$u=K!==void 0&&K.includes(ge)===!1,qu=f.value==="hour"&&S===0?_.value===!0?"00":"12":S;te.push({val:ge,index:G,disable:$u,label:qu})}return te}),me=j(()=>[[Zu,bu,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Oe(()=>l.modelValue,t=>{const n=qe(t,U.value,w.value,l.calendar,V.value);(n.dateHash!==r.value.dateHash||n.timeHash!==r.value.timeHash)&&(r.value=n,n.hour===null?f.value="hour":F.value=n.hour<12)}),Oe([U,w],()=>{ju(()=>{Ne()})});function de(){const t={...g(),..._t()};Ne(t),Object.assign(r.value,t),f.value="hour"}function pe(t,n,y){const q=Array.apply(null,{length:n+1}).map((K,te)=>{const S=te+t;return{index:S,val:y(S)===!0}}).filter(K=>K.val===!0).map(K=>K.index);return{min:q[0],max:q[q.length-1],values:q,threshold:n+1}}function Ze(t,n,y){const q=Math.abs(t-n);return Math.min(q,y-q)}function Pe(t,{min:n,max:y,values:q,threshold:K}){if(t===n)return n;if(t<n||t>y)return Ze(t,n,K)<=Ze(t,y,K)?n:y;const te=q.findIndex(ge=>t<=ge),S=q[te-1],G=q[te];return t-S<=G-t?S:G}function ku(){return l.calendar!=="persian"&&l.mask!==null?l.mask:`HH:mm${l.withSeconds===!0?":ss":""}`}function yu(){if(typeof l.defaultDate!="string"){const t=g(!0);return t.dateHash=lt(t),t}return qe(l.defaultDate,"YYYY/MM/DD",void 0,l.calendar)}function Qe(){return Yu(c)===!0||d.value!==null&&(d.value.values.length===0||f.value==="hour"&&_.value!==!0&&ee.value[F.value===!0?"am":"pm"].values.length===0)}function Te(){const t=Y.value,{top:n,left:y,width:q}=t.getBoundingClientRect(),K=q/2;return{top:n+K,left:y+K,dist:K*.7}}function bu(t){if(Qe()!==!0){if(t.isFirst===!0){C=Te(),T=Ee(t.evt,C);return}T=Ee(t.evt,C,T),t.isFinal===!0&&(C=!1,T=null,eu())}}function eu(){f.value==="hour"?f.value="minute":l.withSeconds&&f.value==="minute"&&(f.value="second")}function Ee(t,n,y){const q=Wu(t),K=Math.abs(q.top-n.top),te=Math.sqrt(Math.pow(Math.abs(q.top-n.top),2)+Math.pow(Math.abs(q.left-n.left),2));let S,G=Math.asin(K/te)*(180/Math.PI);if(q.top<n.top?G=n.left<q.left?90-G:270+G:G=n.left<q.left?G+90:270-G,f.value==="hour"){if(S=G/30,ee.value!==null){const ge=_.value!==!0?F.value===!0:ee.value.am.values.length!==0&&ee.value.pm.values.length!==0?te>=n.dist:ee.value.am.values.length!==0;S=Pe(S+(ge===!0?0:12),ee.value[ge===!0?"am":"pm"])}else S=Math.round(S),_.value===!0?te<n.dist?S<12&&(S+=12):S===12&&(S=0):F.value===!0&&S===12?S=0:F.value===!1&&S!==12&&(S+=12);_.value===!0&&(F.value=S<12)}else S=Math.round(G/6)%60,f.value==="minute"&&ie.value!==null?S=Pe(S,ie.value):f.value==="second"&&D.value!==null&&(S=Pe(S,D.value));return y!==S&&Eu[f.value](S),S}const We={hour(){f.value="hour"},minute(){f.value="minute"},second(){f.value="second"}};function Au(t){t.keyCode===13&&uu()}function Cu(t){t.keyCode===13&&tu()}function wu(t){Qe()!==!0&&(i.platform.is.desktop!==!0&&Ee(t,Te()),eu())}function Du(t){Qe()!==!0&&Ee(t,Te())}function xu(t){if(t.keyCode===13)f.value="hour";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(ee.value!==null){const y=_.value===!0?ee.value.values:ee.value[F.value===!0?"am":"pm"].values;if(y.length===0)return;if(r.value.hour===null)Be(y[0]);else{const q=(y.length+y.indexOf(r.value.hour)+n)%y.length;Be(y[q])}}else{const y=_.value===!0?24:12,q=_.value!==!0&&F.value===!1?12:0,K=r.value.hour===null?-n:r.value.hour;Be(q+(24+K+n)%y)}}}function Vu(t){if(t.keyCode===13)f.value="minute";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(ie.value!==null){const y=ie.value.values;if(y.length===0)return;if(r.value.minute===null)Me(y[0]);else{const q=(y.length+y.indexOf(r.value.minute)+n)%y.length;Me(y[q])}}else{const y=r.value.minute===null?-n:r.value.minute;Me((60+y+n)%60)}}}function Su(t){if(t.keyCode===13)f.value="second";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(D.value!==null){const y=D.value.values;if(y.length===0)return;if(r.value.seconds===null)$e(y[0]);else{const q=(y.length+y.indexOf(r.value.second)+n)%y.length;$e(y[q])}}else{const y=r.value.second===null?-n:r.value.second;$e((60+y+n)%60)}}}function Be(t){r.value.hour!==t&&(r.value.hour=t,De())}function Me(t){r.value.minute!==t&&(r.value.minute=t,De())}function $e(t){r.value.second!==t&&(r.value.second=t,De())}const Eu={hour:Be,minute:Me,second:$e};function uu(){F.value===!1&&(F.value=!0,r.value.hour!==null&&(r.value.hour-=12,De()))}function tu(){F.value===!0&&(F.value=!1,r.value.hour!==null&&(r.value.hour+=12,De()))}function Re(t){const n=l.modelValue;f.value!==t&&n!==void 0&&n!==null&&n!==""&&typeof n!="string"&&(f.value=t)}function De(){if(oe.value!==null&&oe.value(r.value.hour)!==!0){r.value=qe(),Re("hour");return}if(be.value!==null&&be.value(r.value.minute)!==!0){r.value.minute=null,r.value.second=null,Re("minute");return}if(l.withSeconds===!0&&Ae.value!==null&&Ae.value(r.value.second)!==!0){r.value.second=null,Re("second");return}r.value.hour===null||r.value.minute===null||l.withSeconds===!0&&r.value.second===null||Ne()}function Ne(t){const n=Object.assign({...r.value},t),y=l.calendar==="persian"?Ce(n.hour)+":"+Ce(n.minute)+(l.withSeconds===!0?":"+Ce(n.second):""):nt(new Date(n.year,n.month===null?null:n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond),U.value,w.value,n.year,n.timezoneOffset);n.changed=y!==l.modelValue,v("update:modelValue",y,n)}function Bu(){const t=[R("div",{class:"q-time__link "+(f.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onClick:We.hour,onKeyup:xu},I.value.hour),R("div",":"),R("div",fe.value===!0?{class:"q-time__link "+(f.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onKeyup:Vu,onClick:We.minute}:{class:"q-time__link"},I.value.minute)];l.withSeconds===!0&&t.push(R("div",":"),R("div",X.value===!0?{class:"q-time__link "+(f.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onKeyup:Su,onClick:We.second}:{class:"q-time__link"},I.value.second));const n=[R("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},t)];return _.value===!1&&n.push(R("div",{class:"q-time__header-ampm column items-between no-wrap"},[R("div",{class:"q-time__link "+(F.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onClick:uu,onKeyup:Au},"AM"),R("div",{class:"q-time__link "+(F.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:p.value,onClick:tu,onKeyup:Cu},"PM")])),R("div",{class:"q-time__header flex flex-center no-wrap "+a.value},n)}function Mu(){const t=r.value[f.value];return R("div",{class:"q-time__content col relative-position"},[R(zu,{name:"q-transition--scale"},()=>R("div",{key:"clock"+f.value,class:"q-time__container-parent absolute-full"},[R("div",{ref:Y,class:"q-time__container-child fit overflow-hidden"},[Ke(R("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:wu,onMousedown:Du},[R("div",{class:"q-time__clock-circle fit"},[R("div",{class:"q-time__clock-pointer"+(r.value[f.value]===null?" hidden":l.color!==void 0?` text-${l.color}`:""),style:ye.value}),M.value.map(n=>R("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${n.index}`+(n.val===t?" q-time__clock-position--active "+a.value:n.disable===!0?" q-time__clock-position--disable":"")},[R("span",n.label)]))])]),me.value)])])),l.nowBtn===!0?R(J,{class:"q-time__now-button absolute",icon:i.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:l.color,textColor:l.textColor,tabindex:p.value,onClick:de}):null])}return c.proxy.setNow=de,()=>{const t=[Mu()],n=Ru(B.default);return n!==void 0&&t.push(R("div",{class:"q-time__actions"},n)),l.name!==void 0&&l.disable!==!0&&A(t,"push"),R("div",{class:L.value,tabindex:-1},[Bu(),R("div",{class:"q-time__main col overflow-auto"},t)])}}});const kt={class:"q-pa-md",style:{"max-width":"300px",padding:"0"}},yt={class:"row items-center justify-end"},bt={class:"row items-center justify-end"},At={__name:"DateTime",props:{evDateTime:b("2019-02-01 12:44")},emits:["update:date"],setup(l,{emit:B}){const v=ne("Announce");return b(l.evDateTime),(i,o)=>(m(),W("div",kt,[e(re,{filled:"",modelValue:s(v).eventTime,"onUpdate:modelValue":o[2]||(o[2]=p=>s(v).eventTime=p),mask:"####-##-## ##:##"},{prepend:u(()=>[e(xe,{name:"event",class:"cursor-pointer"},{default:u(()=>[e(ou,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:u(()=>[e(at,{modelValue:s(v).eventTime,"onUpdate:modelValue":o[0]||(o[0]=p=>s(v).eventTime=p),mask:"YYYY-MM-DD HH:mm"},{default:u(()=>[N("div",yt,[Ke(e(J,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[iu]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:u(()=>[e(xe,{name:"access_time",class:"cursor-pointer"},{default:u(()=>[e(ou,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:u(()=>[e(ht,{modelValue:s(v).eventTime,"onUpdate:modelValue":o[1]||(o[1]=p=>s(v).eventTime=p),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:u(()=>[N("div",bt,[Ke(e(J,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[iu]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},Ct={__name:"WorkSelectItem",props:{work:Object},setup(l){const B=ae();return(v,c)=>(m(),H(z,{clickable:"",dense:""},{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[E(P(l.work.titleRu),1)]),_:1}),e(O,{caption:""},{default:u(()=>[E(P(l.work.titleEn),1)]),_:1})]),_:1}),e($,{side:"",class:"opus"},{default:u(()=>[e(O,{caption:""},{default:u(()=>{var i;return[E(P((i=l.work.opus)!=null?i:"Op.?"),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var i;return[E(P((i=l.work.icatno)!=null?i:"cat\u2116.?"),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var i;return[E(P((i=l.work.catalogIndex)!=null?i:"catIdx: ?"),1)]}),_:1}),Q("",!0)]),_:1})]),_:1}))}},wt=ve({__name:"WorkSelect",props:{works:{},loading:{type:Boolean}},emits:["onSelect"],setup(l,{emit:B}){const v=b(),c=B,i=l,o=b([...i.works]);Ju(()=>{o.value=[...i.works],console.log("works updated"),v.value=void 0});function p(a,h,g){h(()=>{if(!a){o.value=[...i.works];return}const k=a.toLowerCase();let A=[...i.works];a&&(A=A.filter(C=>(C.titleRu?C.titleRu.toLowerCase().includes(k):!1)||(C.titleEn?C.titleEn.toLowerCase().includes(k):!1))),o.value=A})}return(a,h)=>(m(),H(Se,{modelValue:v.value,"onUpdate:modelValue":[h[0]||(h[0]=g=>v.value=g),h[1]||(h[1]=g=>c("onSelect",v.value))],options:o.value,loading:a.loading,"option-label":"titleRu","option-value":"id","map-options":"","use-input":"",onFilter:p,clearable:"",label:"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0435"},{option:u(g=>[e(Ct,vu(g.itemProps,{work:g.opt}),null,16,["work"])]),_:1},8,["modelValue","options","loading"]))}}),Dt=ve({__name:"AddWorkDialog",props:{announce:{type:Object,required:!0}},emits:["workSelected","onAddWork"],setup(l,{emit:B}){const v=ae(),c=ne("isOpenAddWorkDialog"),i=b(!1),o=b(),p=b(),a=B,h=l,g=b([]),k=b([]);function A(x){p.value=x,x&&(a("workSelected",x),Y(x.id))}function C(x){var f;o.value=x,p.value=void 0,g.value=[],(f=o.value)!=null&&f.id&&T(o.value.id)}async function T(x){i.value=!0,g.value=await ke.getListByAuthor(v,x),i.value=!1}async function Y(x){i.value=!0,k.value=await ze.getList(v,x),i.value=!1}async function U(){i.value=!0,await ke.linkToAnnounce(v,h.announce.id,p.value.id)&&(a("onAddWork",p.value),w()),i.value=!1}function w(){c.value=!1}function V(){o.value=void 0,p.value=void 0,i.value=!1}return(x,f)=>(m(),H(Je,{modelValue:s(c),"onUpdate:modelValue":f[0]||(f[0]=r=>Ue(c)?c.value=r:null),onBeforeHide:V},{default:u(()=>[e(Ve,{bordered:"",class:"dialogArea"},{default:u(()=>[e(ue,null,{default:u(()=>[e(ft,{onItSel:C})]),_:1}),o.value?(m(),H(ue,{key:0},{default:u(()=>[e(wt,{works:g.value,onOnSelect:A},null,8,["works"])]),_:1})):Q("",!0),e(ce,{align:"between"},{default:u(()=>[e(Fe),e(J,{"icon-right":"save",color:"green",loading:i.value,onClick:U,label:"\u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",flat:""},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),xt=ve({__name:"SuggestSelect",emits:["saved"],setup(l,{emit:B}){const v=ae(),c=String("https://sakh-orch.ru/api/"),i=String("https://sakh-orch.ru/stapi/"),o=b(""),p=b(null),a=b([{title:{text:"\u0421\u0430\u0445\u0430\u043B\u0438\u043D\u0441\u043A\u0438\u0439 \u043C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u044B\u0439 \u0442\u0435\u0430\u0442\u0440\u0430\u043B\u044C\u043D\u044B\u0439 \u0446\u0435\u043D\u0442\u0440 \u0438\u043C\u0435\u043D\u0438 \u0410\u043D\u0442\u043E\u043D\u0430 \u041F\u0430\u0432\u043B\u043E\u0432\u0438\u0447\u0430 \u0427\u0435\u0445\u043E\u0432\u0430",hl:[{begin:26,end:31}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u043E\u043C\u043C\u0443\u043D\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442, 35",hl:[{begin:0,end:5}]},tags:["business","theatre","museum","concert hall"],distance:{value:1178.70231,text:"1.18 \u043A\u043C"}},{title:{text:"\u0421\u0430\u0445\u0430\u043B\u0438\u043D\u0441\u043A\u0438\u0439 \u0442\u0435\u0430\u0442\u0440 \u043A\u0443\u043A\u043E\u043B",hl:[{begin:12,end:17}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u043E\u043C\u043C\u0443\u043D\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442, 28\u0410",hl:[{begin:0,end:5}]},tags:["business","theatre","office service"],distance:{value:1224.330864,text:"1.22 \u043A\u043C"}},{title:{text:"\u041C\u043E\u0441\u043A\u043E\u0432\u0441\u043A\u0438\u0439 \u0434\u0440\u0430\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0442\u0435\u0430\u0442\u0440 \u0438\u043C\u0435\u043D\u0438 \u041C. \u041D. \u0415\u0440\u043C\u043E\u043B\u043E\u0432\u043E\u0439",hl:[{begin:25,end:30}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041C\u043E\u0441\u043A\u0432\u0430, \u0422\u0432\u0435\u0440\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 5/6",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:6655148389e-3,text:"6655.15 \u043A\u043C"}},{title:{text:"\u0422\u0430\u0442\u0430\u0440\u0441\u043A\u0438\u0439 \u0433\u043E\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0439 \u0442\u0435\u0430\u0442\u0440 \u043A\u0443\u043A\u043E\u043B \u042D\u043A\u0438\u044F\u0442",hl:[{begin:26,end:31}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u0430\u0437\u0430\u043D\u044C, \u041F\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 57",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:6077098052e-3,text:"6077.10 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440 \u0434\u0440\u0430\u043C\u044B \u0438 \u043A\u043E\u043C\u0435\u0434\u0438\u0438",hl:[{begin:0,end:5}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041F\u0435\u0442\u0440\u043E\u043F\u0430\u0432\u043B\u043E\u0432\u0441\u043A-\u041A\u0430\u043C\u0447\u0430\u0442\u0441\u043A\u0438\u0439, \u041B\u0435\u043D\u0438\u043D\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 75",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:1321394665e-3,text:"1321.39 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440 \u041A\u043E\u043B\u0435\u0441\u043E",hl:[{begin:0,end:5}]},subtitle:{text:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0433\u043E \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\u0430 \xB7 \u0422\u043E\u043B\u044C\u044F\u0442\u0442\u0438, \u041B\u0435\u043D\u0438\u043D\u0433\u0440\u0430\u0434\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 33\u0410\u04411"},tags:["business","bus stop"],distance:{value:6203127608e-3,text:"6203.13 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440\u0430\u043B\u044C\u043D\u0430\u044F",hl:[{begin:0,end:5}]},subtitle:{text:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0433\u043E \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\u0430 \xB7 \u0421\u043E\u0447\u0438, \u0410-147"},tags:["business","bus stop"],distance:{value:7445799203e-3,text:"7445.80 \u043A\u043C"}}]),h=b([...a.value]),g=B;function k(U,w){if(!U){h.value=[];return}w(()=>{A(U)})}function A(U){const w="https://suggest-maps.yandex.ru/v1/suggest";Iu.get(w,{params:{apikey:o.value,text:U,ull:"142.728060,46.966085",print_address:1,strict_bounds:1,attrs:"uri"},withCredentials:!1,headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(V=>{var f;if(!((f=V==null?void 0:V.data)!=null&&f.results))return;const x=V.data.results;x.forEach((r,F)=>{r.label=r.address.formatted_address,r.value=F}),h.value=x}).catch(V=>{console.error(V),v.notify(he(V))})}function C(){we.post(c+"epoint/ya/suggest.php",{params:{method:"add",suggest:p.value}}).then(U=>{var w;if(!((w=U==null?void 0:U.data)!=null&&w.result))throw new Error;g("saved",U.data.data.id)}).catch(U=>{v.notify(he(U))})}function T(){!p.value||C()}function Y(){const U=i+"epoint/ya/suggest.php",w={method:"getApiKey"};we.post(U,{params:w}).then(V=>{var x;if(!((x=V==null?void 0:V.data)!=null&&x.result))throw new Error("SuggestApiKey Error");o.value=V.data.data.key}).catch(V=>{console.error(V),v.notify(he(V))})}return Ie(()=>{Y()}),(U,w)=>o.value?(m(),H(Se,{key:0,modelValue:p.value,"onUpdate:modelValue":[w[0]||(w[0]=V=>p.value=V),T],options:h.value,"use-input":"","fill-input":"","hide-selected":"",clearable:"",onFilter:k},{option:u(V=>[e(z,fu(mu(V.itemProps)),{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[E(P(V.opt.title.text),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>{var x,f;return[E(P((f=(x=V.opt)==null?void 0:x.address)==null?void 0:f.formatted_address),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])):Q("",!0)}}),Vt={class:"text-h6"},St=ve({__name:"HallDialog",setup(l){const B=ae(),v=ne("clickedHall"),c=ne("IsHallDialogOpen"),i=b(!1);Xe(()=>{});async function o(){i.value=!0,await v.value.save(B)&&(_e.List.value=await _e.getList(B),c.value=!1),i.value=!1}function p(k){v.value.suggestId=k}function a(){v.value||(v.value=new _e)}function h(){}async function g(k){i.value=!0,await k.del(B)&&(c.value=!1),i.value=!1}return(k,A)=>(m(),H(Je,{modelValue:s(c),"onUpdate:modelValue":A[3]||(A[3]=C=>Ue(c)?c.value=C:null),onBeforeShow:a,onBeforeHide:h},{default:u(()=>[e(Ve,{bordered:"",class:"dialogArea"},{default:u(()=>[e($,null,{default:u(()=>[N("div",Vt,P(s(v).id>0?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0437\u0430\u043B":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043B"),1)]),_:1}),e(ue,null,{default:u(()=>[e(re,{modelValue:s(v).name,"onUpdate:modelValue":A[0]||(A[0]=C=>s(v).name=C),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435","stack-label":""},null,8,["modelValue"]),s(v).id===-1?(m(),H(xt,{key:0,onSaved:p})):(m(),H(z,{key:1},{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>{var C,T,Y;return[E(P((Y=(T=(C=s(v))==null?void 0:C.suggest)==null?void 0:T.address)==null?void 0:Y.formatted),1)]}),_:1})]),_:1})]),_:1}))]),_:1}),e(ce,null,{default:u(()=>[e(Fe),s(v).id>0?(m(),H(Le,{key:0,label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",loading:i.value,"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B",danger:"",onOnOk:A[1]||(A[1]=C=>g(s(v)))},null,8,["loading"])):Q("",!0),e(J,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",disable:!s(v).suggestId,loading:i.value,color:"green",onClick:A[2]||(A[2]=C=>o())},null,8,["disable","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Et=ve({__name:"HallSelect",emits:["selected"],setup(l,{emit:B}){const v=ae(),c=ne("selectedHall"),i=b(!1),o=b(!1);le("IsHallDialogOpen",i);const p=b(),a=B;function h(C=null){C||(C=new _e),A.value=new _e(C),i.value=!0}function g(){A.value=c.value,a("selected",c.value)}async function k(C){o.value=!0,await C.del(v)&&(i.value=!1),o.value=!1}const A=b(new _e);return le("clickedHall",A),Ie(()=>{}),(C,T)=>{var Y,U;return m(),W(Z,null,[e(Se,{modelValue:s(c),"onUpdate:modelValue":[T[1]||(T[1]=w=>Ue(c)?c.value=w:null),T[2]||(T[2]=w=>g())],label:"\u041C\u0435\u0441\u0442\u043E \u043F\u0440\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F","map-options":"","option-label":"name","option-value":"id",options:(U=(Y=s(_e).List)==null?void 0:Y.value)!=null?U:[],ref_key:"selRef",ref:p},{append:u(()=>[e(J,{icon:"add",round:"",onClick:T[0]||(T[0]=je(w=>h(),["prevent","stop"]))},{default:u(()=>[e(gu,null,{default:u(()=>T[3]||(T[3]=[E("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043B")])),_:1})]),_:1})]),option:u(w=>[e(z,fu(mu(w.itemProps)),{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[E(P(w.opt.name),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[E(P(w.opt.suggest.address.formatted),1)]),_:2},1024)]),_:2},1024),e($,{side:""},{default:u(()=>[e(Le,{danger:"","throw-confirm":"",flat:"",loading:o.value,tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B: "+w.opt.name,onOnOk:V=>k(w.opt)},null,8,["loading","title","onOnOk"])]),_:2},1024),e($,{side:""},{default:u(()=>[e(J,{icon:"edit",flat:"",onClick:je(V=>h(w.opt),["prevent","stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),e(St)],64)}}}),Bt=ve({__name:"AnnounceSelect",props:{announces:{}},emits:["onSelect"],setup(l,{emit:B}){const v=B,c=b();return(i,o)=>(m(),H(Se,{modelValue:c.value,"onUpdate:modelValue":[o[0]||(o[0]=p=>c.value=p),o[1]||(o[1]=p=>v("onSelect",c.value))],options:i.announces,"map-options":"","option-value":"id","option-label":"progName"},{option:u(p=>{var a;return[e(z,vu(p.itemProps,{id:`an${(a=p.opt)==null?void 0:a.id}`}),{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(P(p.opt.eventTime),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[E(P(p.opt.Hall.name),1)]),_:2},1024),e(O,null,{default:u(()=>[E(P(p.opt.progName),1)]),_:2},1024)]),_:2},1024)]),_:2},1040,["id"])]}),_:1},8,["modelValue","options"]))}}),Mt=ve({__name:"WorkBatchAddDialog",props:{targetAnnounceId:{}},emits:["onBatchAddWorks"],setup(l,{emit:B}){const v=ae(),c=ne("isOpenBatchAddDialog"),i=b(!1),o=l,p=B,a=b(),h=b([]),g=b([]);function k(){c.value=!1}function A(){g.value=[],a.value=[],h.value=[],i.value=!1}async function C(){i.value=!0,a.value=await hu.getList(v),i.value=!1}async function T(f){i.value=!0,h.value=await ke.getListByAnnounce(v,f),i.value=!1}function Y(f){!f||T(f.id)}async function U(){i.value=!0,await ke.linkListToAnnounce(v,o.targetAnnounceId,g.value)&&(p("onBatchAddWorks"),k()),i.value=!1}function w(){g.value=h.value.map(f=>f.id)}function V(){g.value=[]}const x=j(()=>h.value.length?h.value.length===g.value.length:!1);return Ie(()=>{C()}),(f,r)=>(m(),H(Je,{modelValue:s(c),"onUpdate:modelValue":r[1]||(r[1]=F=>Ue(c)?c.value=F:null),onBeforeHide:A},{default:u(()=>[e(Ve,{bordered:"",class:"dialogArea"},{default:u(()=>[e(ue,null,{default:u(()=>[e(Bt,{announces:a.value,onOnSelect:Y},null,8,["announces"])]),_:1}),h.value.length?(m(),H(ue,{key:0},{default:u(()=>[e(z,null,{default:u(()=>[e($,null,{default:u(()=>[x.value?Q("",!0):(m(),H(J,{key:0,label:"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0432\u0441\u0435",onClick:w})),x.value?(m(),H(J,{key:1,label:"\u0421\u043D\u044F\u0442\u044C \u0432\u0441\u0435",onClick:V})):Q("",!0)]),_:1})]),_:1}),(m(!0),W(Z,null,He(h.value,F=>(m(),H(z,{key:`add_work${F.id}`,tag:"label"},{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(P(F.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[E(P(F.titleRu),1)]),_:2},1024)]),_:2},1024),e($),e($,{side:""},{default:u(()=>[e(Ye,{modelValue:g.value,"onUpdate:modelValue":r[0]||(r[0]=L=>g.value=L),val:F.id},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):Q("",!0),e(ce,{align:"right"},{default:u(()=>[e(J,{icon:"save",flat:"",color:"green",disable:!g.value.length,onClick:U,label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),$t=ve({__name:"WorkList",props:{announce:{type:Object,required:!0}},setup(l){const B=ae(),v=l,c=b(!1),i=b(!1);le("isOpenAddWorkDialog",i);const o=b(!1);le("isOpenBatchAddDialog",o);const p=b([]),a=b([]),h=b([]),g=b(!1);function k(L){const I=L.map(_=>_.id);h.value=Array.from(new Set([...h.value,...I]))}function A(L){const I=L.map(_=>_.id);h.value=h.value.filter(_=>!I.includes(_))}function C(L){return L.every(I=>h.value.includes(I.id))}function T(L){C(L)?A(L):k(L)}const Y=b({});function U(L){Y.value[L.id]=j({get(){return C(L.children)},set(I){T(L.children)}})}async function w(){c.value=!0;const L=v.announce.id;p.value=await ke.getListByAnnounce(B,L),p.value.length&&(await V(),p.value.forEach(I=>U(I))),c.value=!1}async function V(){c.value=!0;const L=v.announce.id;a.value=await ze.getListByAnnounce(B,L),h.value=a.value.map(I=>I.id),c.value=!1}async function x(){c.value=!0,await ze.linkListToAnnounce(B,v.announce.id,h.value),c.value=!1}async function f(L){c.value=!0,await ke.unlinkFromAnnounce(B,v.announce.id,L)&&await w(),c.value=!1}async function r(L,I){c.value=!0,await ke.moveSortInAnnounce(B,L,I,v.announce.id)&&await w(),c.value=!1}function F(){w(),g.value=!1}return Ie(async()=>{await mt.initList(B),await w()}),(L,I)=>(m(),W(Z,null,[e(Ve,null,{default:u(()=>[e(ce,{align:"between"},{default:u(()=>[g.value?(m(),H(J,{key:0,icon:"add",label:"\u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C",onClick:I[0]||(I[0]=_=>i.value=!0),loading:c.value},null,8,["loading"])):Q("",!0),g.value?(m(),H(J,{key:1,icon:"add",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432\u0441\u0435 \u0438\u0437 \u0434\u0440\u0443\u0433\u043E\u0433\u043E \u043A\u043E\u043D\u0446\u0435\u0440\u0442\u0430",onClick:I[1]||(I[1]=_=>o.value=!0),loading:c.value},null,8,["loading"])):Q("",!0),e(Fe),e(J,{icon:"edit",flat:"",round:"",onClick:I[2]||(I[2]=je(_=>g.value=!g.value,["stop","prevent"])),color:g.value?"red":"gray"},null,8,["color"])]),_:1}),e(ue,null,{default:u(()=>[e(du,null,{default:u(()=>[(m(!0),W(Z,null,He(p.value,(_,ye)=>{var fe;return m(),W(Z,{key:`w${_.id}`},[(fe=_==null?void 0:_.children)!=null&&fe.length?(m(),H(_u,{key:0,"content-inset-level":.1,"expand-separator":""},{header:u(()=>[e(z,{style:{width:"100%"},class:"no-padding"},{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(P(_.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[E(P(_.titleRu),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),default:u(()=>[e(du,null,{default:u(()=>[g.value?(m(),H(z,{key:0,tag:"label"},{default:u(()=>[e($,null,{default:u(()=>[e(O,null,{default:u(()=>[E(P(C(_.children)?"\u0421\u043D\u044F\u0442\u044C \u0432\u0441\u0435":"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0432\u0441\u0435"),1)]),_:2},1024)]),_:2},1024),e($,{side:""},{default:u(()=>[e(Ye,{modelValue:Y.value[_.id],"onUpdate:modelValue":[X=>Y.value[_.id]=X,x],disable:c.value,"keep-color":"",color:"green"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:2},1024)]),_:2},1024)):Q("",!0),(m(!0),W(Z,null,He(_.children,X=>(m(),H(z,{key:`ch${X.id}`,tag:"label"},{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(O,null,{default:u(()=>[E(P(X.num),1)]),_:2},1024)]),_:2},1024),e($,null,{default:u(()=>[e(O,null,{default:u(()=>[E(P(X.title),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[E(P(X.caption),1)]),_:2},1024)]),_:2},1024),e($,{side:""},{default:u(()=>[e(Ye,{modelValue:h.value,"onUpdate:modelValue":[I[3]||(I[3]=oe=>h.value=oe),x],disable:!g.value,val:X.id},null,8,["modelValue","disable","val"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):(m(),H(z,{key:1},{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(P(_.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[E(P(_.titleRu),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),g.value?(m(),W(Z,{key:2},[e(z,null,{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(ru,{disable:ye<1,onOnClick:X=>r("up",_.id),direction:"up"},null,8,["disable","onOnClick"])]),_:2},1024),e($,{avatar:""},{default:u(()=>[e(ru,{disable:ye>=p.value.length-1,onOnClick:X=>r("down",_.id),direction:"down"},null,8,["disable","onOnClick"])]),_:2},1024),e($),e($,{side:""},{default:u(()=>[e(Le,{flat:"","throw-confirm":"",danger:"",onOnOk:X=>f(_.id),loading:c.value,title:`\u0423\u0434\u0430\u043B\u0438\u0442\u044C: ${_.titleRu}`},null,8,["onOnOk","loading","title"])]),_:2},1024)]),_:2},1024),e(se)],64)):Q("",!0)],64)}),128))]),_:1})]),_:1})]),_:1}),e(Dt,{announce:l.announce,onOnAddWork:w},null,8,["announce"]),e(Mt,{"target-announce-id":l.announce.id,onOnBatchAddWorks:F},null,8,["target-announce-id"])],64))}});const qt={key:0,class:"eventsarea"},Ot={class:"editArea"},Ht={key:0,class:"card"},Ut={class:"editor"},It={style:{display:"flex","justify-content":"space-between"}},Ft={key:0,class:"uploads"},Lt={style:{width:"100%"}},Pt={class:"uploads"},Qt={__name:"AnnounceEditor",emits:["reload","posterUploaded"],setup(l,{expose:B,emit:v}){const c=String("https://sakh-orch.ru/api/"),i=ae(),o=pu(),p=Xu(),a=ne("Announce"),h=b(a.value.Hall);le("selectedHall",h);function g(D){console.log(D),a.value.hallId=D.id,a.value.Hall=D}const k=b("");le("pwUrl",k);const A=v,C={};function T(){}const Y=[{label:"\u0412\u0445\u043E\u0434 \u0441\u0432\u043E\u0431\u043E\u0434\u043D\u044B\u0439",value:2},{label:"\u0411\u0438\u043B\u0435\u0442\u044B \u0432 \u043F\u0440\u043E\u0434\u0430\u0436\u0435",value:3},{label:"\u0412\u0445\u043E\u0434 \u043F\u043E \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C",value:4},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",value:5}],U=b(null),w=b(null),V=b(!1);le("loadingAuthors",V);const x=b(0);le("selectedAuthorId",x);const f=b(null);le("selectedAuthor",f),Oe(x,()=>{f.value=AuthorSelectList.value.find(D=>D.id===x.value)});function r(D){return{url:c+"epoint/event/poster.php",headers:[{name:"ACCESSTOKEN",value:vt.self.AccessToken}],formFields:[{name:"id",value:a.value.id},{name:"method",value:"add"}]}}function F(D){i.notify(su("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),A("posterUploaded")}function L(D){i.notify(su("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),A("posterUploaded"),U.value.reset(),I.value=!0}const I=b(!1);let _=null;Oe(I,D=>{console.log("photoWatcher"),D&&!_?_=setInterval(ee,3e3):!D&&_&&(clearInterval(_),_=null)});function ye(D){var M,me,de;let d=(de=(me=JSON.parse((M=D==null?void 0:D.xhr)==null?void 0:M.response))==null?void 0:me.error)!=null?de:"";i.notify(he(null,d))}function fe(){hu.save(i,a.value)}function X(){p.push({path:"/announces"})}function oe(){A("reload")}function be(){delete a.value.sketch,delete a.value.sketchId}function Ae(){we.post(c+"epoint/event/announce.php",{params:{method:"updateMarkdown",id:a.value.id,markdown:a.value.description}}).then(D=>{var d;if(!((d=D==null?void 0:D.data)!=null&&d.result))throw new Error;a.value.parsedMD=D==null?void 0:D.data.data}).catch(D=>{})}function ee(){we.post(c+"epoint/event/poster.php",{params:{method:"get",announceId:o.params.evid}}).then(D=>{var d,M,me,de,pe;if(!((d=D==null?void 0:D.data)!=null&&d.result))throw new Error;a.value.poster=(me=(M=D==null?void 0:D.data)==null?void 0:M.data)!=null?me:null,((pe=(de=a.value)==null?void 0:de.poster)==null?void 0:pe.status)!=="process"&&(I.value=!1)}).catch(D=>{I.value=!1,i.notify(he(D))}).finally(()=>{})}const ie=b(!1);return B({}),Xe(()=>{}),Gu(()=>{_&&clearInterval(_)}),(D,d)=>(m(),W(Z,null,[s(a)?(m(),W("div",qt,[N("div",Ot,[s(i).platform.is.desktop?(m(),W("div",Ht,[s(a).Hall?(m(),H(dt,{key:0,onIamDeleted:X,onNewAnnounce:oe,onDelSketch:be,ref_key:"rAnnounceCard",ref:w,announce:s(a),pwUrl:k.value},null,8,["announce","pwUrl"])):Q("",!0)])):Q("",!0),N("div",Ut,[N("div",It,[e(At,{date:s(a).eventTime,"onUpdate:date":[d[0]||(d[0]=M=>s(a).eventTime=M),d[1]||(d[1]=M=>void 0)]},null,8,["date"])]),d[19]||(d[19]=N("br",null,null,-1)),d[20]||(d[20]=N("hr",null,null,-1)),s(i).platform.is.desktop?(m(),W("div",Ft,[N("div",Lt,[e(rt,{id:s(a).id,type:"event",onOnUploaded:F},null,8,["id"])])])):(m(),H(z,{key:1},{default:u(()=>[e($,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>d[14]||(d[14]=[E(" \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u044D\u0441\u043A\u0438\u0437\u0430 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0435 \u0443\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u0430 ")])),_:1})]),_:1})]),_:1})),e(se,{spaced:"1em"}),e(re,{name:"progName",modelValue:s(a).progName,"onUpdate:modelValue":d[2]||(d[2]=M=>s(a).progName=M),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),e(Et,{onSelected:g}),e(Se,{modelValue:s(a).pay,"onUpdate:modelValue":d[3]||(d[3]=M=>s(a).pay=M),"emit-value":"","map-options":"",label:"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0432\u0445\u043E\u0434\u0430",options:Y},null,8,["modelValue"]),d[21]||(d[21]=N("br",null,null,-1)),[3,4].includes(s(a).pay)?(m(),W(Z,{key:2},[e(re,{type:"text",modelValue:s(a).ticketLink,"onUpdate:modelValue":d[4]||(d[4]=M=>s(a).ticketLink=M),label:"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435 \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"]),d[16]||(d[16]=N("br",null,null,-1)),e(re,{modelValue:s(a).radarioEventId,"onUpdate:modelValue":d[5]||(d[5]=M=>s(a).radarioEventId=M),type:"number","stack-label":"",placeholder:"1234567",label:"ID \u043C\u0435\u0440\u043E\u043F\u0440\u0438\u044F\u0442\u0438\u044F \u043D\u0430 Radario"},{default:u(()=>[e(gu,null,{default:u(()=>d[15]||(d[15]=[E("\u0426\u0438\u0444\u0440\u044B \u0432 \u043A\u043E\u043D\u0446\u0435 \u0441\u0441\u044B\u043B\u043A\u0438 \u043D\u0430 \u043F\u043E\u043A\u0443\u043F\u043A\u0443 \u0431\u0438\u043B\u0435\u0442\u043E\u0432")])),_:1})]),_:1},8,["modelValue"]),d[17]||(d[17]=N("br",null,null,-1)),e(ce,null,{default:u(()=>[e(nu,{modelValue:s(a).isPushkin,"onUpdate:modelValue":d[6]||(d[6]=M=>s(a).isPushkin=M),label:"\u041F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430",color:"green"},null,8,["modelValue"]),e(Fe),e(nu,{modelValue:s(a).isShowTicketCount,"onUpdate:modelValue":d[7]||(d[7]=M=>s(a).isShowTicketCount=M),color:"green",label:"\u041E\u0441\u0442\u0430\u0442\u043E\u043A \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"])]),_:1}),d[18]||(d[18]=N("br",null,null,-1))],64)):Q("",!0),e(re,{type:"number",modelValue:s(a).age,"onUpdate:modelValue":d[8]||(d[8]=M=>s(a).age=M),label:"\u0412\u043E\u0437\u0440\u0430\u0441\u0442\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"},null,8,["modelValue"]),d[22]||(d[22]=N("br",null,null,-1)),e(se,{spaced:""}),e(re,{name:"evDescr",modelValue:s(a).sdescr,"onUpdate:modelValue":d[9]||(d[9]=M=>s(a).sdescr=M),type:"textarea",autogrow:"",label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),d[23]||(d[23]=N("br",null,null,-1)),e(re,{name:"evText",modelValue:s(a).description,"onUpdate:modelValue":[d[10]||(d[10]=M=>s(a).description=M),d[11]||(d[11]=M=>Ae())],type:"textarea",autogrow:"",debounce:300,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),e(se,{spaced:"1em"}),N("div",Pt,[e(et,{modelValue:C,"onUpdate:modelValue":d[12]||(d[12]=M=>C=M),style:{width:"100%"},label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",factory:r,ref_key:"posterUploader",ref:U,onUploaded:L,onFailed:ye,"no-thumbnails":""},null,512)]),e(ce,{align:"right"},{default:u(()=>[e(J,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:fe,color:"green","icon-right":"save",flat:""})]),_:1})]),e(se,{spaced:"1em"})])])):Q("",!0),e(se),e(_u,{label:"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0439",modelValue:ie.value,"onUpdate:modelValue":d[13]||(d[13]=M=>ie.value=M)},{default:u(()=>[ie.value?(m(),H($t,{key:0,announce:s(a)},null,8,["announce"])):Q("",!0)]),_:1},8,["modelValue"]),e(se),d[24]||(d[24]=N("br",null,null,-1)),d[25]||(d[25]=N("hr",null,null,-1)),d[26]||(d[26]=N("br",null,null,-1))],64))}};var Tt=Ge(Qt,[["__scopeId","data-v-05a8c005"]]);const Wt={key:0,class:"posterArea relative-position"},Rt={key:0,style:{position:"absolute",right:"1em",top:"1em","z-index":"10"}},Nt={class:"eventboxin"},Kt={key:0},jt=["innerHTML"],Yt={key:1},zt={key:1,class:"videoItem"},Jt={__name:"AnnounceDescr",emits:["delPoster"],setup(l,{emit:B}){const v=String("https://sakh-orch.ru/api/"),c=ae(),i=ne("editMode"),o=ne("Announce"),p=j(()=>{let g=c.platform.is.mobile?1080:480;return o.value.poster?ot(v,o.value.poster.md5,o.value.poster.ext,g):"/img/news/default_sketch.svg"});function a(){return"https://vk.com/share.php?url="+String("https://sakh-orch.ru/")+"/announce/"+String(o.value.id)+"&title="+String(o.value.progName)+"&noparse=true&image="+String(p.value)}function h(){we.post(v+"epoint/event/poster.php",{params:{method:"unlink",id:o.value.id}}).then(g=>{var k;if(!((k=g==null?void 0:g.data)!=null&&k.result))throw new Error;delete o.value.poster,delete o.value.posterId}).catch(g=>{c.notify(he(g))})}return(g,k)=>(m(),W(Z,null,[s(o).poster?(m(),W("div",Wt,[s(i)?(m(),W("div",Rt,[e(Le,{"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",onOnOk:k[0]||(k[0]=A=>h())})])):Q("",!0),s(o).poster.status==="process"?(m(),H(z,{key:1},{default:u(()=>[e(lu),e($,null,{default:u(()=>[e(ct,{showing:"",label:"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430"})]),_:1})]),_:1})):(m(),H(lu,{key:2,src:p.value},{error:u(()=>k[1]||(k[1]=[N("img",{src:"/img/news/default_sketch.svg"},null,-1)])),_:1},8,["src"]))])):Q("",!0),N("div",Nt,[e(Ve,{class:"transparent no-padding",flat:""},{default:u(()=>[e(ue,{class:"no-padding"},{default:u(()=>[e(z,null,{default:u(()=>[e($,null,{default:u(()=>[e(O,{class:"title"},{default:u(()=>[E(P(s(o).progName),1)]),_:1}),e(O,{class:"title"},{default:u(()=>[E(P(s(it)(s(o).eventTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(ue,null,{default:u(()=>[(m(!0),W(Z,null,He(s(o).parsedMD,(A,C)=>(m(),W(Z,{key:C},[A.type==="text"?(m(),W("div",Kt,[A.content!==`
`?(m(),W("div",{key:0,innerHTML:A.content,class:"textBlock"},null,8,jt)):(m(),W("br",Yt))])):Q("",!0),A.type==="video"?(m(),W("div",zt,[e(pt,{ratio:16/9,src:"https://www.youtube.com/embed/"+A.content},null,8,["src"])])):Q("",!0)],64))),128))]),_:1}),!s(o).completed&&[3,4].includes(s(o).pay)&&s(o).ticketLink?(m(),H(ce,{key:0,align:"right"})):Q("",!0),e(ue,null,{default:u(()=>[e(z,{dense:""},{default:u(()=>[e(O,{caption:""},{default:u(()=>k[2]||(k[2]=[E(" \u0423\u0432\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043F\u043E\u0441\u0435\u0442\u0438\u0442\u0435\u043B\u0438, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0440\u043E\u0441\u044C\u0431\u0430 \u0441\u043E\u0431\u043B\u044E\u0434\u0430\u0442\u044C \u043C\u0435\u0440\u044B \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438 \u0432 \u0441\u0432\u044F\u0437\u0438 \u0441 \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u0438\u0435\u043C \u043A\u043E\u0440\u043E\u043D\u0430\u0432\u0438\u0440\u0443\u0441\u043D\u043E\u0439 \u0438\u043D\u0444\u0435\u043A\u0446\u0438\u0438! ")])),_:1})]),_:1})]),_:1}),e(ue,null,{default:u(()=>[e(z,{clickable:"",href:s(o).Hall.map,target:"_blank"},{default:u(()=>[e($,{avatar:""},{default:u(()=>[e(xe,{name:"place"})]),_:1}),e($,null,{default:u(()=>[e(O,null,{default:u(()=>[E(P(s(o).Hall.name),1)]),_:1}),e(O,{caption:""},{default:u(()=>[E(P(s(o).Hall.suggest.address.formatted),1)]),_:1})]),_:1})]),_:1},8,["href"])]),_:1}),!s(o).completed&&[3,4].includes(s(o).pay)&&s(o).ticketLink?(m(),H(ue,{key:1},{default:u(()=>[e(z,{clickable:"",href:s(o).ticketLink,target:"_blank"},{default:u(()=>[s(o).pay===3?(m(),W(Z,{key:0},[e($,{avatar:""},{default:u(()=>[e(xe,{name:"shopping_cart"})]),_:1}),e($,null,{default:u(()=>[e(O,null,{default:u(()=>k[3]||(k[3]=[E("\u041A\u0443\u043F\u0438\u0442\u044C \u0431\u0438\u043B\u0435\u0442")])),_:1}),s(o).isPushkin?(m(),H(O,{key:0,caption:""},{default:u(()=>k[4]||(k[4]=[E("+ \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043F\u043E \u043F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u043E\u0439 \u043A\u0430\u0440\u0442\u0435")])),_:1})):Q("",!0)]),_:1})],64)):Q("",!0),s(o).pay===4?(m(),W(Z,{key:1},[e($,{avatar:""},{default:u(()=>[e(xe,{name:"img:/img/uds.svg"})]),_:1}),e($,null,{default:u(()=>[e(O,null,{default:u(()=>k[5]||(k[5]=[E("\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439")])),_:1})]),_:1})],64)):Q("",!0)]),_:1},8,["href"])]),_:1})):Q("",!0),e(se),e(ue,{class:"no-padding"},{default:u(()=>[e(cu,{"phone-number":"+7-(4242)-300-518"}),e(cu,{"phone-number":"+7-(962)-416-36-89"})]),_:1}),e(se,{spaced:"1em"}),e(ce,{align:"right"},{default:u(()=>[e(J,{href:a(),target:"_blank",outline:"",icon:"img:/img/logo/vk/VK Logo Black & White.svg",label:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},null,8,["href"])]),_:1})]),_:1})])],64))}};var Xt=Ge(Jt,[["__scopeId","data-v-f32b83ae"]]);const Gt={class:"centralCol"},Zt={class:"eventboxl"},el={__name:"AnnouncePage",setup(l){const B=st("\u0410\u043D\u043E\u043D\u0441");Uu(B);const v=ae(),i=ne("editModes").announce;le("editMode",i);const o=String("https://sakh-orch.ru/api/"),p=pu(),a=b(),h=b(null);le("Announce",h);function g(){we.post(o+"epoint/event/announce.php",{params:{method:"get",id:p.params.evid}}).then(k=>{var A,C;h.value=(C=(A=k==null?void 0:k.data)==null?void 0:A.data)!=null?C:null,console.log("Announce loaded")}).catch(k=>{v.notify(he(k))})}return Xe(()=>{g()}),(k,A)=>(m(),H(Ou,{class:"col myScrollArea"},{default:u(()=>[N("div",Gt,[s(i)&&h.value?(m(),H(Tt,{key:0,onPosterUploaded:g,onReload:g,ref_key:"editorRef",ref:a},null,512)):Q("",!0),N("div",Zt,[h.value?(m(),H(Xt,{key:0,onDelPoster:A[0]||(A[0]=()=>{a.value.delPoster()})})):Q("",!0)])]),e(Hu)]),_:1}))}};var Rl=Ge(el,[["__scopeId","data-v-6738d0fd"]]);export{Rl as default};
