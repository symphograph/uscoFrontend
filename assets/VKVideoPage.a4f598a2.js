import{i as g,r as u,m,n as A,q as l,ax as S,v as b,x as r,E as y,f as e,B,l as C,z as O,bi as L,bk as H,bl as M,t as x,y as F,b as R,H as T,u as w,I as j,p as Q,k as q,F as U,A as z,G}from"./index.52314c0a.js";import{a as I}from"./axios.7c1287c1.js";import{i as J,n as D}from"./myFuncts.671597d2.js";import{u as N}from"./use-quasar.c9b9d459.js";import"./QList.5ebcd5b3.js";import{Q as P}from"./QItemLabel.1623a9a2.js";import{a as E,b as W,Q as $}from"./QImg.596a2b33.js";/* empty css                                                             */import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{P as Y}from"./PageShell.74f1b758.js";import{_ as Z}from"./BtnLibEdit.3088b82d.js";/* empty css                                                               */import{Q as ee}from"./QSelect.f7b7c6b2.js";/* empty css               *//* empty css                                                                   */import"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.fe28985f.js";import"./touch.9135741d.js";import"./selection.0aa390e5.js";import"./AnderHeader.vue_vue_type_style_index_0_lang.956c3b84.js";import"./QScrollArea.546a57de.js";import"./format.de7e9769.js";import"./QLinearProgress.1ce87716.js";import"./myAuth.5621b016.js";import"./QMenu.e39235f4.js";import"./position-engine.2cf59900.js";import"./rtl.276c3f1b.js";const te={class:"absolute-top-left text-subtitle2"},oe={key:0,class:"absolute-top-right no-padding"},ae={key:1,class:"absolute-center",style:{"border-radius":"50%"}},le={class:"absolute-bottom text-center"},ie={__name:"VKVideoItem",props:{video:Object},setup(v){const c=v,d=g("libEditMode"),f=u(!1),i=g("isOpenVKVideoDialog"),n=g("VKVideo");function V(){n.value=c.video,i.value=!0,console.log(n.value)}return(_,a)=>(m(),A(E,{style:{cursor:"pointer"},src:v.video.image[4].url,ratio:1920/1080,onMouseover:a[0]||(a[0]=o=>f.value=!0),onMouseleave:a[1]||(a[1]=o=>f.value=!1),class:"rounded-borders"},{default:l(()=>[S("div",te,b(v.video.recordedAt),1),r(d)?(m(),y("div",oe,[e(B,{icon:"edit",flat:"",onClick:V})])):C("",!0),f.value?(m(),y("div",ae,[e(B,{icon:"play_circle",style:{cursor:"pointer"},round:""})])):C("",!0),S("div",le,b(v.video.title),1)]),_:1},8,["src"]))}},ne={__name:"VKVideoDialog",setup(v){N();const c=String("https://api.sakh-orch.ru/"),d=g("isOpenVKVideoDialog"),f=u(!1),i=g("VKVideo"),n=g("announceList");u(null);function V(){f.value=!1}return(_,a)=>(m(),A(T,{modelValue:r(d),"onUpdate:modelValue":a[3]||(a[3]=o=>R(d)?d.value=o:null),onBeforeHide:V},{default:l(()=>[e(F,{bordered:"",class:"dialogArea"},{default:l(()=>[e(O,null,{default:l(()=>[e(L,{modelValue:r(i).title,"onUpdate:modelValue":a[0]||(a[0]=o=>r(i).title=o),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"])]),_:1}),e(O,null,{default:l(()=>[e(ee,{modelValue:r(i).announceId,"onUpdate:modelValue":[a[1]||(a[1]=o=>r(i).announceId=o),a[2]||(a[2]=()=>{console.log(r(i))})],options:r(n),"map-options":"","emit-value":"","option-label":"progName","option-value":"id"},{option:l(o=>[e(W,H(M(o.itemProps)),{default:l(()=>[e($,{avatar:""},{default:l(()=>{var h,K,k,t;return[e(E,{src:r(J)(r(c),((K=(h=o.opt)==null?void 0:h.sketch)==null?void 0:K.md5)||null,((t=(k=o.opt)==null?void 0:k.sketch)==null?void 0:t.ext)||null,100)},null,8,["src"])]}),_:2},1024),e($,null,{default:l(()=>[e(P,null,{default:l(()=>[x(b(o.opt.progName),1)]),_:2},1024),e(P,{caption:""},{default:l(()=>[x(b(o.opt.eventTime),1)]),_:2},1024),e(P,{caption:""},{default:l(()=>[x(b(o.opt.Hall.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const se={class:"centralCol"},re={key:0,class:"vidarea"},ue={__name:"VKVideoPage",setup(v){const c=N();w(),j();const d=String("https://api.staff.sakh-orch.ru/"),f=String("https://api.sakh-orch.ru/"),i=u(!1),n=u([]),V=u(""),_=u([]);Q("announceList",_);const a=u(!1);Q("isOpenVKVideoDialog",a);const o=u(null);Q("VKVideo",o);function h(){i.value=!0,I.post(d+"/api/lib/video.php",{params:{method:"list"}}).then(t=>{var p,s;n.value=[],n.value=(s=(p=t==null?void 0:t.data)==null?void 0:p.data)!=null?s:[]}).catch(t=>{n.value=[],c.notify(D(t))}).finally(()=>{i.value=!1})}function K(){i.value=!0,I.post(d+"/api/lib/video.php",{params:{method:"updateAllFromVK"}}).then(t=>{h()}).catch(t=>{n.value=[],c.notify(D(t))}).finally(()=>{i.value=!1})}function k(){i.value=!0,I.post(f+"api/event/announce.php",{params:{method:"listAll"}}).then(t=>{var p,s;_.value=[],_.value=(s=(p=t==null?void 0:t.data)==null?void 0:p.data)!=null?s:[]}).catch(t=>{c.notify(D(t)),_.value=[]}).finally(()=>{i.value=!1})}return q(()=>{k(),h()}),(t,p)=>(m(),y(U,null,[e(Y,{"page-title":"\u0412\u0438\u0434\u0435\u043E\u0442\u0435\u043A\u0430"},{ToolPanel:l(()=>[e(B,{icon:"refresh",flat:"",stretch:"",onClick:K}),e(L,{modelValue:V.value,"onUpdate:modelValue":p[0]||(p[0]=s=>V.value=s),style:{width:"100%","max-width":"16em"},label:"\u0444\u0438\u043B\u044C\u0442\u0440","stack-label":"",clearable:""},{append:l(()=>[e(z,{name:"search"})]),_:1},8,["modelValue"]),e(Z)]),PageContent:l(()=>[S("div",se,[n.value.length?(m(),y("div",re,[(m(!0),y(U,null,G(n.value,s=>(m(),A(ie,{key:s.id,video:s},null,8,["video"]))),128))])):C("",!0)])]),_:1}),e(ne)],64))}};var Le=X(ue,[["__scopeId","data-v-24c05866"]]);export{Le as default};
