import{Q as $u,M as Hu}from"./QScrollArea.d29ff5ca.js";import{u as Uu}from"./use-meta.9e3420c8.js";import{u as ie}from"./use-quasar.cdf0ea62.js";import{c as Iu,a as ye}from"./axios.b6bdbb44.js";import{Q as O}from"./QItemLabel.4c832645.js";import{Q as B,b as z,a as nu}from"./QImg.628e9f39.js";import{V as Pu,X as Fu,bb as Tu,Z as Qu,di as Lu,r as h,c as j,w as Ie,aJ as Wu,W as Nu,h as N,g as Ku,dk as Ru,au as ju,a6 as Yu,a4 as zu,ak as ze,A as X,i as oe,m as f,D as W,f as e,q as u,v as s,bi as ve,z as Se,ax as K,n as I,t as E,u as Q,B as Pe,d as Ae,b as Te,G as Ge,y as te,cq as fu,l as L,bm as me,x as Ee,k as Qe,bk as mu,bl as pu,o as Ze,p as le,F as Z,E as Fe,df as Je,C as de,I as gu,H as Ju,a as Xu,ay as au}from"./index.f5e978c0.js";import{Q as Be}from"./QSelect.ed6de9a4.js";import{Q as _u}from"./QTooltip.7abf715f.js";import{T as Gu,d as Le,b as hu}from"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.990b59f1.js";import{a as Zu}from"./style.fbcce293.js";/* empty css               */import{u as ou,b as et,c as ut,_ as Ue,g as tt,f as lt,Q as iu,a as nt}from"./QPopupProxy.d9955562.js";import{p as xe}from"./format.de7e9769.js";import{C as su}from"./ClosePopup.032fa5fe.js";import{n as fe,a as du,i as at,c as ot,g as it}from"./myFuncts.28762f14.js";import{A as st}from"./AnnounceCard.1165afce.js";import{S as dt,Q as rt}from"./QInnerLoading.d67820b7.js";import{m as ct}from"./myAuth.5621b016.js";import{S as vt}from"./SelectComposer.ab01221d.js";import{W as be,P as Xe}from"./lib.ab987395.js";import{_ as We}from"./BtnDelete.921da25f.js";import{H as ke}from"./hall.c147d622.js";import{m as ku}from"./entry.f6555cc6.js";import{Q as ru}from"./QList.c6e92f7b.js";import{_ as cu}from"./BtnMoveSort.27111e8c.js";import{_ as eu}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as ft}from"./QVideo.36315a5a.js";import{_ as vu}from"./PhoneNumber.059acb2c.js";import"./QToolbarTitle.82c27438.js";import"./QLinearProgress.92cabfad.js";import"./QMenu.95cba417.js";import"./position-engine.93af21d7.js";import"./selection.52642521.js";import"./rtl.276c3f1b.js";import"./touch.9135741d.js";import"./use-file.dfae004c.js";import"./get-emits-object.a3f16783.js";import"./use-render-cache.3aae9b27.js";import"./AuthorItem.68f5c219.js";/* empty css                                                               *//* empty css                                                                   */import"./myAxios.e0606f23.js";function mt(l,$){if(l.hour!==null){if(l.minute===null)return"minute";if($===!0&&l.second===null)return"second"}return"hour"}function pt(){const l=new Date;return{hour:l.getHours(),minute:l.getMinutes(),second:l.getSeconds(),millisecond:l.getMilliseconds()}}var gt=Pu({name:"QTime",props:{...Fu,...Tu,...ou,modelValue:{required:!0,validator:l=>typeof l=="string"||l===null},mask:{...ou.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:l=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(l)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:et,setup(l,{slots:$,emit:m}){const v=Ku(),{$q:r}=v.proxy,a=Qu(l,r),{tabindex:g,headerClass:H,getLocale:o,getCurrentDate:k}=ut(l,r),p=Lu(l),A=Ru(p);let D,T;const J=h(null),M=j(()=>Me()),w=j(()=>o()),C=j(()=>yu()),V=Ue(l.modelValue,M.value,w.value,l.calendar,C.value),c=h(mt(V)),i=h(V),U=h(V.hour===null||V.hour<12),pe=j(()=>`q-time q-time--${l.landscape===!0?"landscape":"portrait"}`+(a.value===!0?" q-time--dark q-dark":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-time--readonly":"")+(l.bordered===!0?" q-time--bordered":"")+(l.square===!0?" q-time--square no-border-radius":"")+(l.flat===!0?" q-time--flat no-shadow":"")),P=j(()=>{const t=i.value;return{hour:t.hour===null?"--":x.value===!0?xe(t.hour):String(U.value===!0?t.hour===0?12:t.hour:t.hour>12?t.hour-12:t.hour),minute:t.minute===null?"--":xe(t.minute),second:t.second===null?"--":xe(t.second)}}),x=j(()=>l.format24h!==null?l.format24h:r.lang.date.format24h),F=j(()=>{const t=c.value==="hour",n=t===!0?12:60,_=i.value[c.value];let R=`rotate(${Math.round(_*(360/n))-180}deg) translateX(-50%)`;return t===!0&&x.value===!0&&i.value.hour>=12&&(R+=" scale(.7)"),{transform:R}}),ae=j(()=>i.value.hour!==null),ee=j(()=>ae.value===!0&&i.value.minute!==null),Y=j(()=>l.hourOptions!==void 0?t=>l.hourOptions.includes(t):l.options!==void 0?t=>l.options(t,null,null):null),re=j(()=>l.minuteOptions!==void 0?t=>l.minuteOptions.includes(t):l.options!==void 0?t=>l.options(i.value.hour,t,null):null),Ce=j(()=>l.secondOptions!==void 0?t=>l.secondOptions.includes(t):l.options!==void 0?t=>l.options(i.value.hour,i.value.minute,t):null),ue=j(()=>{if(Y.value===null)return null;const t=b(0,11,Y.value),n=b(12,11,Y.value);return{am:t,pm:n,values:t.values.concat(n.values)}}),ge=j(()=>re.value!==null?b(0,59,re.value):null),_e=j(()=>Ce.value!==null?b(0,59,Ce.value):null),De=j(()=>{switch(c.value){case"hour":return ue.value;case"minute":return ge.value;case"second":return _e.value}}),we=j(()=>{let t,n,_=0,q=1;const R=De.value!==null?De.value.values:void 0;c.value==="hour"?x.value===!0?(t=0,n=23):(t=0,n=11,U.value===!1&&(_=12)):(t=0,n=55,q=5);const ne=[];for(let S=t,G=t;S<=n;S+=q,G++){const he=S+_,qu=R!==void 0&&R.includes(he)===!1,Ou=c.value==="hour"&&S===0?x.value===!0?"00":"12":S;ne.push({val:he,index:G,disable:qu,label:Ou})}return ne}),y=j(()=>[[Gu,bu,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Ie(()=>l.modelValue,t=>{const n=Ue(t,M.value,w.value,l.calendar,C.value);(n.dateHash!==i.value.dateHash||n.timeHash!==i.value.timeHash)&&(i.value=n,n.hour===null?c.value="hour":U.value=n.hour<12)}),Ie([M,w],()=>{ju(()=>{Ye()})});function d(){const t={...k(),...pt()};Ye(t),Object.assign(i.value,t),c.value="hour"}function b(t,n,_){const q=Array.apply(null,{length:n+1}).map((R,ne)=>{const S=ne+t;return{index:S,val:_(S)===!0}}).filter(R=>R.val===!0).map(R=>R.index);return{min:q[0],max:q[q.length-1],values:q,threshold:n+1}}function ce(t,n,_){const q=Math.abs(t-n);return Math.min(q,_-q)}function se(t,{min:n,max:_,values:q,threshold:R}){if(t===n)return n;if(t<n||t>_)return ce(t,n,R)<=ce(t,_,R)?n:_;const ne=q.findIndex(he=>t<=he),S=q[ne-1],G=q[ne];return t-S<=G-t?S:G}function Me(){return l.calendar!=="persian"&&l.mask!==null?l.mask:`HH:mm${l.withSeconds===!0?":ss":""}`}function yu(){if(typeof l.defaultDate!="string"){const t=k(!0);return t.dateHash=tt(t),t}return Ue(l.defaultDate,"YYYY/MM/DD",void 0,l.calendar)}function Ne(){return Yu(v)===!0||De.value!==null&&(De.value.values.length===0||c.value==="hour"&&x.value!==!0&&ue.value[U.value===!0?"am":"pm"].values.length===0)}function Ke(){const t=J.value,{top:n,left:_,width:q}=t.getBoundingClientRect(),R=q/2;return{top:n+R,left:_+R,dist:R*.7}}function bu(t){if(Ne()!==!0){if(t.isFirst===!0){D=Ke(),T=qe(t.evt,D);return}T=qe(t.evt,D,T),t.isFinal===!0&&(D=!1,T=null,uu())}}function uu(){c.value==="hour"?c.value="minute":l.withSeconds&&c.value==="minute"&&(c.value="second")}function qe(t,n,_){const q=Wu(t),R=Math.abs(q.top-n.top),ne=Math.sqrt(Math.pow(Math.abs(q.top-n.top),2)+Math.pow(Math.abs(q.left-n.left),2));let S,G=Math.asin(R/ne)*(180/Math.PI);if(q.top<n.top?G=n.left<q.left?90-G:270+G:G=n.left<q.left?G+90:270-G,c.value==="hour"){if(S=G/30,ue.value!==null){const he=x.value!==!0?U.value===!0:ue.value.am.values.length!==0&&ue.value.pm.values.length!==0?ne>=n.dist:ue.value.am.values.length!==0;S=se(S+(he===!0?0:12),ue.value[he===!0?"am":"pm"])}else S=Math.round(S),x.value===!0?ne<n.dist?S<12&&(S+=12):S===12&&(S=0):U.value===!0&&S===12?S=0:U.value===!1&&S!==12&&(S+=12);x.value===!0&&(U.value=S<12)}else S=Math.round(G/6)%60,c.value==="minute"&&ge.value!==null?S=se(S,ge.value):c.value==="second"&&_e.value!==null&&(S=se(S,_e.value));return _!==S&&Eu[c.value](S),S}const Re={hour(){c.value="hour"},minute(){c.value="minute"},second(){c.value="second"}};function Au(t){t.keyCode===13&&tu()}function Cu(t){t.keyCode===13&&lu()}function Du(t){Ne()!==!0&&(r.platform.is.desktop!==!0&&qe(t,Ke()),uu())}function xu(t){Ne()!==!0&&qe(t,Ke())}function wu(t){if(t.keyCode===13)c.value="hour";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(ue.value!==null){const _=x.value===!0?ue.value.values:ue.value[U.value===!0?"am":"pm"].values;if(_.length===0)return;if(i.value.hour===null)Oe(_[0]);else{const q=(_.length+_.indexOf(i.value.hour)+n)%_.length;Oe(_[q])}}else{const _=x.value===!0?24:12,q=x.value!==!0&&U.value===!1?12:0,R=i.value.hour===null?-n:i.value.hour;Oe(q+(24+R+n)%_)}}}function Vu(t){if(t.keyCode===13)c.value="minute";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(ge.value!==null){const _=ge.value.values;if(_.length===0)return;if(i.value.minute===null)$e(_[0]);else{const q=(_.length+_.indexOf(i.value.minute)+n)%_.length;$e(_[q])}}else{const _=i.value.minute===null?-n:i.value.minute;$e((60+_+n)%60)}}}function Su(t){if(t.keyCode===13)c.value="second";else if([37,39].includes(t.keyCode)){const n=t.keyCode===37?-1:1;if(_e.value!==null){const _=_e.value.values;if(_.length===0)return;if(i.value.seconds===null)He(_[0]);else{const q=(_.length+_.indexOf(i.value.second)+n)%_.length;He(_[q])}}else{const _=i.value.second===null?-n:i.value.second;He((60+_+n)%60)}}}function Oe(t){i.value.hour!==t&&(i.value.hour=t,Ve())}function $e(t){i.value.minute!==t&&(i.value.minute=t,Ve())}function He(t){i.value.second!==t&&(i.value.second=t,Ve())}const Eu={hour:Oe,minute:$e,second:He};function tu(){U.value===!1&&(U.value=!0,i.value.hour!==null&&(i.value.hour-=12,Ve()))}function lu(){U.value===!0&&(U.value=!1,i.value.hour!==null&&(i.value.hour+=12,Ve()))}function je(t){const n=l.modelValue;c.value!==t&&n!==void 0&&n!==null&&n!==""&&typeof n!="string"&&(c.value=t)}function Ve(){if(Y.value!==null&&Y.value(i.value.hour)!==!0){i.value=Ue(),je("hour");return}if(re.value!==null&&re.value(i.value.minute)!==!0){i.value.minute=null,i.value.second=null,je("minute");return}if(l.withSeconds===!0&&Ce.value!==null&&Ce.value(i.value.second)!==!0){i.value.second=null,je("second");return}i.value.hour===null||i.value.minute===null||l.withSeconds===!0&&i.value.second===null||Ye()}function Ye(t){const n=Object.assign({...i.value},t),_=l.calendar==="persian"?xe(n.hour)+":"+xe(n.minute)+(l.withSeconds===!0?":"+xe(n.second):""):lt(new Date(n.year,n.month===null?null:n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond),M.value,w.value,n.year,n.timezoneOffset);n.changed=_!==l.modelValue,m("update:modelValue",_,n)}function Bu(){const t=[N("div",{class:"q-time__link "+(c.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Re.hour,onKeyup:wu},P.value.hour),N("div",":"),N("div",ae.value===!0?{class:"q-time__link "+(c.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:Vu,onClick:Re.minute}:{class:"q-time__link"},P.value.minute)];l.withSeconds===!0&&t.push(N("div",":"),N("div",ee.value===!0?{class:"q-time__link "+(c.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:Su,onClick:Re.second}:{class:"q-time__link"},P.value.second));const n=[N("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},t)];return x.value===!1&&n.push(N("div",{class:"q-time__header-ampm column items-between no-wrap"},[N("div",{class:"q-time__link "+(U.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:tu,onKeyup:Au},"AM"),N("div",{class:"q-time__link "+(U.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:lu,onKeyup:Cu},"PM")])),N("div",{class:"q-time__header flex flex-center no-wrap "+H.value},n)}function Mu(){const t=i.value[c.value];return N("div",{class:"q-time__content col relative-position"},[N(zu,{name:"q-transition--scale"},()=>N("div",{key:"clock"+c.value,class:"q-time__container-parent absolute-full"},[N("div",{ref:J,class:"q-time__container-child fit overflow-hidden"},[ze(N("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:Du,onMousedown:xu},[N("div",{class:"q-time__clock-circle fit"},[N("div",{class:"q-time__clock-pointer"+(i.value[c.value]===null?" hidden":l.color!==void 0?` text-${l.color}`:""),style:F.value}),we.value.map(n=>N("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${n.index}`+(n.val===t?" q-time__clock-position--active "+H.value:n.disable===!0?" q-time__clock-position--disable":"")},[N("span",n.label)]))])]),y.value)])])),l.nowBtn===!0?N(X,{class:"q-time__now-button absolute",icon:r.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:l.color,textColor:l.textColor,tabindex:g.value,onClick:d}):null])}return v.proxy.setNow=d,()=>{const t=[Mu()],n=Nu($.default);return n!==void 0&&t.push(N("div",{class:"q-time__actions"},n)),l.name!==void 0&&l.disable!==!0&&A(t,"push"),N("div",{class:pe.value,tabindex:-1},[Bu(),N("div",{class:"q-time__main col overflow-auto"},t)])}}});const _t={class:"q-pa-md",style:{"max-width":"300px",padding:"0"}},ht={class:"row items-center justify-end"},kt={class:"row items-center justify-end"},yt={__name:"DateTime",props:{evDateTime:h("2019-02-01 12:44")},emits:["update:date"],setup(l,{emit:$}){const m=oe("Announce");return h(l.evDateTime),(r,a)=>(f(),W("div",_t,[e(ve,{filled:"",modelValue:s(m).eventTime,"onUpdate:modelValue":a[2]||(a[2]=g=>s(m).eventTime=g),mask:"####-##-## ##:##"},{prepend:u(()=>[e(Se,{name:"event",class:"cursor-pointer"},{default:u(()=>[e(iu,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:u(()=>[e(nt,{modelValue:s(m).eventTime,"onUpdate:modelValue":a[0]||(a[0]=g=>s(m).eventTime=g),mask:"YYYY-MM-DD HH:mm"},{default:u(()=>[K("div",ht,[ze(e(X,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[su]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:u(()=>[e(Se,{name:"access_time",class:"cursor-pointer"},{default:u(()=>[e(iu,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:u(()=>[e(gt,{modelValue:s(m).eventTime,"onUpdate:modelValue":a[1]||(a[1]=g=>s(m).eventTime=g),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:u(()=>[K("div",kt,[ze(e(X,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[su]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},bt={__name:"WorkSelectItem",props:{work:Object},setup(l){const $=ie();return(m,v)=>(f(),I(z,{clickable:"",dense:""},{default:u(()=>[e(B,null,{default:u(()=>[e(O,null,{default:u(()=>[E(Q(l.work.titleRu),1)]),_:1}),e(O,{caption:""},{default:u(()=>[E(Q(l.work.titleEn),1)]),_:1})]),_:1}),e(B,{side:"",class:"opus"},{default:u(()=>[e(O,{caption:""},{default:u(()=>{var r;return[E(Q((r=l.work.opus)!=null?r:"Op.?"),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var r;return[E(Q((r=l.work.icatno)!=null?r:"cat\u2116.?"),1)]}),_:1}),e(O,{caption:""},{default:u(()=>{var r;return[E(Q((r=l.work.catalogIndex)!=null?r:"catIdx: ?"),1)]}),_:1}),e(X,{dense:"","icon-right":"content_copy",flat:"",label:`ID: ${l.work.id}`,onClick:v[0]||(v[0]=Pe(r=>m.copy(l.work.id,s($)),["prevent","stop"]))},null,8,["label"])]),_:1})]),_:1}))}},At=Ae({__name:"AddWorkDialog",props:{announce:{type:Object,required:!0}},emits:["workSelected","onAddWork"],setup(l,{emit:$}){const m=ie(),v=oe("isOpenAddWorkDialog"),r=h(!1),a=h(),g=h(),H=$,o=l,k=h([]),p=h([]);h([]);function A(V){g.value=V,H("workSelected",V),J(V.id)}function D(V){var c;a.value=V,g.value=void 0,(c=a.value)!=null&&c.id&&T(a.value.id)}async function T(V){r.value=!0,k.value=await be.getListByAuthor(m,V),r.value=!1}async function J(V){r.value=!0,p.value=await Xe.getList(m,V),r.value=!1}async function M(){r.value=!0,await be.linkToAnnounce(m,o.announce.id,g.value.id)&&(H("onAddWork",g.value),w()),r.value=!1}function w(){v.value=!1}function C(){a.value=void 0,g.value=void 0,r.value=!1}return(V,c)=>(f(),I(Ge,{modelValue:s(v),"onUpdate:modelValue":c[1]||(c[1]=i=>Te(v)?v.value=i:null),onBeforeHide:C},{default:u(()=>[e(Ee,{bordered:"",class:"dialogArea"},{default:u(()=>[e(te,null,{default:u(()=>[e(vt,{onItSel:D})]),_:1}),a.value?(f(),I(te,{key:0},{default:u(()=>[e(Be,{modelValue:g.value,"onUpdate:modelValue":[c[0]||(c[0]=i=>g.value=i),A],options:k.value,"option-label":"titleRu","option-value":"id","map-options":"",clearable:"",label:"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0435"},{option:u(i=>[e(bt,fu(i.itemProps,{work:i.opt}),null,16,["work"])]),_:1},8,["modelValue","options"])]),_:1})):L("",!0),e(me,{align:"between"},{default:u(()=>[e(Le),e(X,{"icon-right":"save",color:"green",loading:r.value,onClick:M,label:"\u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",flat:""},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ct=Ae({__name:"SuggestSelect",emits:["saved"],setup(l,{emit:$}){const m=ie(),v=String("https://sakh-orch.ru/api/"),r=String("https://sakh-orch.ru/stapi/"),a=h(""),g=h(null),H=h([{title:{text:"\u0421\u0430\u0445\u0430\u043B\u0438\u043D\u0441\u043A\u0438\u0439 \u043C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u044B\u0439 \u0442\u0435\u0430\u0442\u0440\u0430\u043B\u044C\u043D\u044B\u0439 \u0446\u0435\u043D\u0442\u0440 \u0438\u043C\u0435\u043D\u0438 \u0410\u043D\u0442\u043E\u043D\u0430 \u041F\u0430\u0432\u043B\u043E\u0432\u0438\u0447\u0430 \u0427\u0435\u0445\u043E\u0432\u0430",hl:[{begin:26,end:31}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u043E\u043C\u043C\u0443\u043D\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442, 35",hl:[{begin:0,end:5}]},tags:["business","theatre","museum","concert hall"],distance:{value:1178.70231,text:"1.18 \u043A\u043C"}},{title:{text:"\u0421\u0430\u0445\u0430\u043B\u0438\u043D\u0441\u043A\u0438\u0439 \u0442\u0435\u0430\u0442\u0440 \u043A\u0443\u043A\u043E\u043B",hl:[{begin:12,end:17}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u043E\u043C\u043C\u0443\u043D\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442, 28\u0410",hl:[{begin:0,end:5}]},tags:["business","theatre","office service"],distance:{value:1224.330864,text:"1.22 \u043A\u043C"}},{title:{text:"\u041C\u043E\u0441\u043A\u043E\u0432\u0441\u043A\u0438\u0439 \u0434\u0440\u0430\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0442\u0435\u0430\u0442\u0440 \u0438\u043C\u0435\u043D\u0438 \u041C. \u041D. \u0415\u0440\u043C\u043E\u043B\u043E\u0432\u043E\u0439",hl:[{begin:25,end:30}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041C\u043E\u0441\u043A\u0432\u0430, \u0422\u0432\u0435\u0440\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 5/6",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:6655148389e-3,text:"6655.15 \u043A\u043C"}},{title:{text:"\u0422\u0430\u0442\u0430\u0440\u0441\u043A\u0438\u0439 \u0433\u043E\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0439 \u0442\u0435\u0430\u0442\u0440 \u043A\u0443\u043A\u043E\u043B \u042D\u043A\u0438\u044F\u0442",hl:[{begin:26,end:31}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041A\u0430\u0437\u0430\u043D\u044C, \u041F\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 57",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:6077098052e-3,text:"6077.10 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440 \u0434\u0440\u0430\u043C\u044B \u0438 \u043A\u043E\u043C\u0435\u0434\u0438\u0438",hl:[{begin:0,end:5}]},subtitle:{text:"\u0422\u0435\u0430\u0442\u0440 \xB7 \u041F\u0435\u0442\u0440\u043E\u043F\u0430\u0432\u043B\u043E\u0432\u0441\u043A-\u041A\u0430\u043C\u0447\u0430\u0442\u0441\u043A\u0438\u0439, \u041B\u0435\u043D\u0438\u043D\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 75",hl:[{begin:0,end:5}]},tags:["business","theatre"],distance:{value:1321394665e-3,text:"1321.39 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440 \u041A\u043E\u043B\u0435\u0441\u043E",hl:[{begin:0,end:5}]},subtitle:{text:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0433\u043E \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\u0430 \xB7 \u0422\u043E\u043B\u044C\u044F\u0442\u0442\u0438, \u041B\u0435\u043D\u0438\u043D\u0433\u0440\u0430\u0434\u0441\u043A\u0430\u044F \u0443\u043B\u0438\u0446\u0430, 33\u0410\u04411"},tags:["business","bus stop"],distance:{value:6203127608e-3,text:"6203.13 \u043A\u043C"}},{title:{text:"\u0422\u0435\u0430\u0442\u0440\u0430\u043B\u044C\u043D\u0430\u044F",hl:[{begin:0,end:5}]},subtitle:{text:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0433\u043E \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442\u0430 \xB7 \u0421\u043E\u0447\u0438, \u0410-147"},tags:["business","bus stop"],distance:{value:7445799203e-3,text:"7445.80 \u043A\u043C"}}]),o=h([...H.value]),k=$;function p(M,w){if(!M){o.value=[];return}w(()=>{A(M)})}function A(M){const w="https://suggest-maps.yandex.ru/v1/suggest";Iu.get(w,{params:{apikey:a.value,text:M,ull:"142.728060,46.966085",print_address:1,strict_bounds:1,attrs:"uri"},withCredentials:!1,headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(C=>{var c;if(!((c=C==null?void 0:C.data)!=null&&c.results))return;const V=C.data.results;V.forEach((i,U)=>{i.label=i.address.formatted_address,i.value=U}),o.value=V}).catch(C=>{console.error(C),m.notify(fe(C))})}function D(){ye.post(v+"epoint/ya/suggest.php",{params:{method:"add",suggest:g.value}}).then(M=>{var w;if(!((w=M==null?void 0:M.data)!=null&&w.result))throw new Error;k("saved",M.data.data.id)}).catch(M=>{m.notify(fe(M))})}function T(){!g.value||D()}function J(){const M=r+"epoint/ya/suggest.php",w={method:"getApiKey"};ye.post(M,{params:w}).then(C=>{var V;if(!((V=C==null?void 0:C.data)!=null&&V.result))throw new Error("SuggestApiKey Error");a.value=C.data.data.key}).catch(C=>{console.error(C),m.notify(fe(C))})}return Qe(()=>{J()}),(M,w)=>a.value?(f(),I(Be,{key:0,modelValue:g.value,"onUpdate:modelValue":[w[0]||(w[0]=C=>g.value=C),T],options:o.value,"use-input":"","fill-input":"","hide-selected":"",clearable:"",onFilter:p},{option:u(C=>[e(z,mu(pu(C.itemProps)),{default:u(()=>[e(B,null,{default:u(()=>[e(O,null,{default:u(()=>[E(Q(C.opt.title.text),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>{var V,c;return[E(Q((c=(V=C.opt)==null?void 0:V.address)==null?void 0:c.formatted_address),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])):L("",!0)}}),Dt={class:"text-h6"},xt=Ae({__name:"HallDialog",setup(l){const $=ie(),m=oe("clickedHall"),v=oe("IsHallDialogOpen"),r=h(!1);Ze(()=>{});async function a(){r.value=!0,await m.value.save($)&&(ke.List.value=await ke.getList($),v.value=!1),r.value=!1}function g(p){m.value.suggestId=p}function H(){m.value||(m.value=new ke)}function o(){}async function k(p){r.value=!0,await p.del($)&&(v.value=!1),r.value=!1}return(p,A)=>(f(),I(Ge,{modelValue:s(v),"onUpdate:modelValue":A[3]||(A[3]=D=>Te(v)?v.value=D:null),onBeforeShow:H,onBeforeHide:o},{default:u(()=>[e(Ee,{bordered:"",class:"dialogArea"},{default:u(()=>[e(B,null,{default:u(()=>[K("div",Dt,Q(s(m).id>0?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0437\u0430\u043B":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043B"),1)]),_:1}),e(te,null,{default:u(()=>[e(ve,{modelValue:s(m).name,"onUpdate:modelValue":A[0]||(A[0]=D=>s(m).name=D),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435","stack-label":""},null,8,["modelValue"]),s(m).id===-1?(f(),I(Ct,{key:0,onSaved:g})):(f(),I(z,{key:1},{default:u(()=>[e(B,null,{default:u(()=>[e(O,null,{default:u(()=>{var D,T,J;return[E(Q((J=(T=(D=s(m))==null?void 0:D.suggest)==null?void 0:T.address)==null?void 0:J.formatted),1)]}),_:1})]),_:1})]),_:1}))]),_:1}),e(me,null,{default:u(()=>[e(Le),s(m).id>0?(f(),I(We,{key:0,label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",loading:r.value,"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B",danger:"",onOnOk:A[1]||(A[1]=D=>k(s(m)))},null,8,["loading"])):L("",!0),e(X,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",disable:!s(m).suggestId,loading:r.value,color:"green",onClick:A[2]||(A[2]=D=>a())},null,8,["disable","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),wt=Ae({__name:"HallSelect",emits:["selected"],setup(l,{emit:$}){const m=ie(),v=oe("selectedHall"),r=h(!1),a=h(!1);le("IsHallDialogOpen",r);const g=h(),H=$;function o(D=null){D||(D=new ke),A.value=new ke(D),r.value=!0}function k(){A.value=v.value,H("selected",v.value)}async function p(D){a.value=!0,await D.del(m)&&(r.value=!1),a.value=!1}const A=h(new ke);return le("clickedHall",A),Qe(()=>{}),(D,T)=>{var J,M;return f(),W(Z,null,[e(Be,{modelValue:s(v),"onUpdate:modelValue":[T[1]||(T[1]=w=>Te(v)?v.value=w:null),T[2]||(T[2]=w=>k())],label:"\u041C\u0435\u0441\u0442\u043E \u043F\u0440\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F","map-options":"","option-label":"name","option-value":"id",options:(M=(J=s(ke).List)==null?void 0:J.value)!=null?M:[],ref_key:"selRef",ref:g},{append:u(()=>[e(X,{icon:"add",round:"",onClick:T[0]||(T[0]=Pe(w=>o(),["prevent","stop"]))},{default:u(()=>[e(_u,null,{default:u(()=>T[3]||(T[3]=[E("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043B")])),_:1})]),_:1})]),option:u(w=>[e(z,mu(pu(w.itemProps)),{default:u(()=>[e(B,null,{default:u(()=>[e(O,null,{default:u(()=>[E(Q(w.opt.name),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[E(Q(w.opt.suggest.address.formatted),1)]),_:2},1024)]),_:2},1024),e(B,{side:""},{default:u(()=>[e(We,{danger:"","throw-confirm":"",flat:"",loading:a.value,tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u043B: "+w.opt.name,onOnOk:C=>p(w.opt)},null,8,["loading","title","onOnOk"])]),_:2},1024),e(B,{side:""},{default:u(()=>[e(X,{icon:"edit",flat:"",onClick:Pe(C=>o(w.opt),["prevent","stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),e(xt)],64)}}}),Vt=Ae({__name:"AnnounceSelect",props:{announces:{}},emits:["onSelect"],setup(l,{emit:$}){const m=$,v=h();return(r,a)=>(f(),I(Be,{modelValue:v.value,"onUpdate:modelValue":[a[0]||(a[0]=g=>v.value=g),a[1]||(a[1]=g=>m("onSelect",v.value))],options:r.announces,"map-options":"","option-value":"id","option-label":"progName"},{option:u(g=>{var H;return[e(z,fu(g.itemProps,{id:`an${(H=g.opt)==null?void 0:H.id}`}),{default:u(()=>[e(B,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(Q(g.opt.eventTime),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[E(Q(g.opt.Hall.name),1)]),_:2},1024),e(O,null,{default:u(()=>[E(Q(g.opt.progName),1)]),_:2},1024)]),_:2},1024)]),_:2},1040,["id"])]}),_:1},8,["modelValue","options"]))}}),St=Ae({__name:"WorkBatchAddDialog",props:{targetAnnounceId:{}},emits:["onBatchAddWorks"],setup(l,{emit:$}){const m=ie(),v=oe("isOpenBatchAddDialog"),r=h(!1),a=l,g=$,H=h(),o=h([]),k=h([]);function p(){v.value=!1}function A(){k.value=[],H.value=[],o.value=[],r.value=!1}async function D(){r.value=!0,H.value=await ku.getList(m),r.value=!1}async function T(c){r.value=!0,o.value=await be.getListByAnnounce(m,c),r.value=!1}function J(c){!c||T(c.id)}async function M(){r.value=!0,await be.linkListToAnnounce(m,a.targetAnnounceId,k.value)&&(g("onBatchAddWorks"),p()),r.value=!1}function w(){k.value=o.value.map(c=>c.id)}function C(){k.value=[]}const V=j(()=>o.value.length?o.value.length===k.value.length:!1);return Qe(()=>{D()}),(c,i)=>(f(),I(Ge,{modelValue:s(v),"onUpdate:modelValue":i[1]||(i[1]=U=>Te(v)?v.value=U:null),onBeforeHide:A},{default:u(()=>[e(Ee,{bordered:"",class:"dialogArea"},{default:u(()=>[e(te,null,{default:u(()=>[e(Vt,{announces:H.value,onOnSelect:J},null,8,["announces"])]),_:1}),o.value.length?(f(),I(te,{key:0},{default:u(()=>[e(z,null,{default:u(()=>[e(B,null,{default:u(()=>[V.value?L("",!0):(f(),I(X,{key:0,label:"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0432\u0441\u0435",onClick:w})),V.value?(f(),I(X,{key:1,label:"\u0421\u043D\u044F\u0442\u044C \u0432\u0441\u0435",onClick:C})):L("",!0)]),_:1})]),_:1}),(f(!0),W(Z,null,Fe(o.value,U=>(f(),I(z,{key:`add_work${U.id}`,tag:"label"},{default:u(()=>[e(B,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(Q(U.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[E(Q(U.titleRu),1)]),_:2},1024)]),_:2},1024),e(B),e(B,{side:""},{default:u(()=>[e(Je,{modelValue:k.value,"onUpdate:modelValue":i[0]||(i[0]=pe=>k.value=pe),val:U.id},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):L("",!0),e(me,{align:"right"},{default:u(()=>[e(X,{icon:"save",flat:"",color:"green",disable:!k.value.length,onClick:M,label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Et=Ae({__name:"WorkList",props:{announce:{type:Object,required:!0}},setup(l){const $=ie(),m=l,v=h(!1),r=h(!1);le("isOpenAddWorkDialog",r);const a=h(!1);le("isOpenBatchAddDialog",a);function g(P){console.log(P)}const H=h([]),o=h([]),k=h([]),p=h(!1);function A(P){const x=P.map(F=>F.id);k.value=Array.from(new Set([...k.value,...x]))}function D(P){const x=P.map(F=>F.id);k.value=k.value.filter(F=>!x.includes(F))}function T(P){return P.every(x=>k.value.includes(x.id))}function J(P){T(P)?D(P):A(P)}const M=h({});function w(P){M.value[P.id]=j({get(){return T(P.children)},set(x){J(P.children)}})}async function C(){v.value=!0;const P=m.announce.id;H.value=await be.getListByAnnounce($,P),H.value.length&&(await V(),H.value.forEach(x=>w(x))),v.value=!1}async function V(){v.value=!0;const P=m.announce.id;o.value=await Xe.getListByAnnounce($,P),k.value=o.value.map(x=>x.id),v.value=!1}async function c(){v.value=!0,await Xe.linkListToAnnounce($,m.announce.id,k.value),v.value=!1}async function i(P){v.value=!0,await be.unlinkFromAnnounce($,m.announce.id,P)&&await C(),v.value=!1}async function U(P,x){v.value=!0,await be.moveSortInAnnounce($,P,x,m.announce.id)&&await C(),v.value=!1}function pe(){C(),p.value=!1}return Qe(async()=>{await C()}),(P,x)=>(f(),W(Z,null,[e(Ee,null,{default:u(()=>[e(me,{align:"between"},{default:u(()=>[p.value?(f(),I(X,{key:0,icon:"add",label:"\u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C",onClick:x[0]||(x[0]=F=>r.value=!0),loading:v.value},null,8,["loading"])):L("",!0),p.value?(f(),I(X,{key:1,icon:"add",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432\u0441\u0435 \u0438\u0437 \u0434\u0440\u0443\u0433\u043E\u0433\u043E \u043A\u043E\u043D\u0446\u0435\u0440\u0442\u0430",onClick:x[1]||(x[1]=F=>a.value=!0),loading:v.value},null,8,["loading"])):L("",!0),e(Le),e(X,{icon:"edit",flat:"",round:"",onClick:x[2]||(x[2]=Pe(F=>p.value=!p.value,["stop","prevent"])),color:p.value?"red":"gray"},null,8,["color"])]),_:1}),e(te,null,{default:u(()=>[e(ru,null,{default:u(()=>[(f(!0),W(Z,null,Fe(H.value,(F,ae)=>{var ee;return f(),W(Z,{key:`w${F.id}`},[(ee=F==null?void 0:F.children)!=null&&ee.length?(f(),I(hu,{key:0,"content-inset-level":.1,"expand-separator":""},{header:u(()=>[e(z,{style:{width:"100%"},class:"no-padding"},{default:u(()=>[e(B,{avatar:""},{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(Q(F.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[E(Q(F.titleRu),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),default:u(()=>[e(ru,null,{default:u(()=>[p.value?(f(),I(z,{key:0,tag:"label"},{default:u(()=>[e(B,null,{default:u(()=>[e(O,null,{default:u(()=>[E(Q(T(F.children)?"\u0421\u043D\u044F\u0442\u044C \u0432\u0441\u0435":"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0432\u0441\u0435"),1)]),_:2},1024)]),_:2},1024),e(B,{side:""},{default:u(()=>[e(Je,{modelValue:M.value[F.id],"onUpdate:modelValue":[Y=>M.value[F.id]=Y,c],disable:v.value,"keep-color":"",color:"green"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:2},1024)]),_:2},1024)):L("",!0),(f(!0),W(Z,null,Fe(F.children,Y=>(f(),I(z,{key:`ch${Y.id}`,tag:"label"},{default:u(()=>[e(B,{avatar:""},{default:u(()=>[e(O,null,{default:u(()=>[E(Q(Y.num),1)]),_:2},1024)]),_:2},1024),e(B,null,{default:u(()=>[e(O,null,{default:u(()=>[E(Q(Y.title),1)]),_:2},1024),e(O,{caption:""},{default:u(()=>[E(Q(Y.caption),1)]),_:2},1024)]),_:2},1024),e(B,{side:""},{default:u(()=>[e(Je,{modelValue:k.value,"onUpdate:modelValue":[x[3]||(x[3]=re=>k.value=re),c],disable:!p.value,val:Y.id},null,8,["modelValue","disable","val"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):(f(),I(z,{key:1},{default:u(()=>[e(B,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>[E(Q(F.author.fioRu),1)]),_:2},1024),e(O,null,{default:u(()=>[E(Q(F.titleRu),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),p.value?(f(),W(Z,{key:2},[e(z,null,{default:u(()=>[e(B,{avatar:""},{default:u(()=>[e(cu,{disable:ae<1,onOnClick:Y=>U("up",F.id),direction:"up"},null,8,["disable","onOnClick"])]),_:2},1024),e(B,{avatar:""},{default:u(()=>[e(cu,{disable:ae>=H.value.length-1,onOnClick:Y=>U("down",F.id),direction:"down"},null,8,["disable","onOnClick"])]),_:2},1024),e(B),e(B,{side:""},{default:u(()=>[e(We,{flat:"","throw-confirm":"",danger:"",onOnOk:Y=>i(F.id),loading:v.value,title:`\u0423\u0434\u0430\u043B\u0438\u0442\u044C: ${F.titleRu}`},null,8,["onOnOk","loading","title"])]),_:2},1024)]),_:2},1024),e(de)],64)):L("",!0)],64)}),128))]),_:1})]),_:1})]),_:1}),e(At,{announce:l.announce,onWorkSelected:g,onOnAddWork:C},null,8,["announce"]),e(St,{"target-announce-id":l.announce.id,onOnBatchAddWorks:pe},null,8,["target-announce-id"])],64))}});const Bt={key:0,class:"eventsarea"},Mt={class:"editArea"},qt={key:0,class:"card"},Ot={class:"editor"},$t={style:{display:"flex","justify-content":"space-between"}},Ht={key:0,class:"uploads"},Ut={style:{width:"100%"}},It={class:"uploads"},Pt={__name:"AnnounceEditor",emits:["reload","posterUploaded"],setup(l,{expose:$,emit:m}){const v=String("https://sakh-orch.ru/stapi/"),r=String("https://sakh-orch.ru/api/"),a=ie(),g=gu(),H=Ju(),o=oe("Announce"),k=h(o.value.Hall);le("selectedHall",k);function p(y){console.log(y),o.value.hallId=y.id,o.value.Hall=y}const A=h("");le("pwUrl",A);const D=m,T={};function J(){}const M=[{label:"\u0412\u0445\u043E\u0434 \u0441\u0432\u043E\u0431\u043E\u0434\u043D\u044B\u0439",value:2},{label:"\u0411\u0438\u043B\u0435\u0442\u044B \u0432 \u043F\u0440\u043E\u0434\u0430\u0436\u0435",value:3},{label:"\u0412\u0445\u043E\u0434 \u043F\u043E \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C",value:4},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",value:5}],w=h(null),C=h(null),V=h([]);le("AuthorSelectList",V);const c=h(!1);le("loadingAuthors",c);const i=h(0);le("selectedAuthorId",i);const U=h(null);le("selectedAuthor",U),Ie(i,()=>{U.value=V.value.find(y=>y.id===i.value)});function pe(){c.value=!0,ye.post(v+"epoint/lib/author.php",{params:{method:"all"}}).then(y=>{var d,b;V.value=(b=(d=y==null?void 0:y.data)==null?void 0:d.data)!=null?b:[]}).catch(y=>{V.value=[],a.notify(fe(y))}).finally(()=>{c.value=!1})}function P(y){return{url:r+"epoint/event/poster.php",headers:[{name:"ACCESSTOKEN",value:ct.self.AccessToken}],formFields:[{name:"id",value:o.value.id},{name:"method",value:"add"}]}}function x(y){a.notify(du("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),D("posterUploaded")}function F(y){a.notify(du("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),D("posterUploaded"),w.value.reset(),ae.value=!0}const ae=h(!1);let ee=null;Ie(ae,y=>{console.log("photoWatcher"),y&&!ee?ee=setInterval(De,3e3):!y&&ee&&(clearInterval(ee),ee=null)});function Y(y){var b,ce,se;let d=(se=(ce=JSON.parse((b=y==null?void 0:y.xhr)==null?void 0:b.response))==null?void 0:ce.error)!=null?se:"";a.notify(fe(null,d))}function re(){ku.save(a,o.value)}function Ce(){H.push({path:"/announces"})}function ue(){D("reload")}function ge(){delete o.value.sketch,delete o.value.sketchId}function _e(){ye.post(r+"epoint/event/announce.php",{params:{method:"updateMarkdown",id:o.value.id,markdown:o.value.description}}).then(y=>{var d;if(!((d=y==null?void 0:y.data)!=null&&d.result))throw new Error;o.value.parsedMD=y==null?void 0:y.data.data}).catch(y=>{})}function De(){ye.post(r+"epoint/event/poster.php",{params:{method:"get",announceId:g.params.evid}}).then(y=>{var d,b,ce,se,Me;if(!((d=y==null?void 0:y.data)!=null&&d.result))throw new Error;o.value.poster=(ce=(b=y==null?void 0:y.data)==null?void 0:b.data)!=null?ce:null,((Me=(se=o.value)==null?void 0:se.poster)==null?void 0:Me.status)!=="process"&&(ae.value=!1)}).catch(y=>{ae.value=!1,a.notify(fe(y))}).finally(()=>{})}const we=h(!1);return $({}),Ze(()=>{pe()}),Xu(()=>{ee&&clearInterval(ee)}),(y,d)=>(f(),W(Z,null,[s(o)?(f(),W("div",Bt,[K("div",Mt,[s(a).platform.is.desktop?(f(),W("div",qt,[s(o).Hall?(f(),I(st,{key:0,onIamDeleted:Ce,onNewAnnounce:ue,onDelSketch:ge,ref_key:"rAnnounceCard",ref:C,announce:s(o),pwUrl:A.value},null,8,["announce","pwUrl"])):L("",!0)])):L("",!0),K("div",Ot,[K("div",$t,[e(yt,{date:s(o).eventTime,"onUpdate:date":[d[0]||(d[0]=b=>s(o).eventTime=b),d[1]||(d[1]=b=>void 0)]},null,8,["date"])]),d[19]||(d[19]=K("br",null,null,-1)),d[20]||(d[20]=K("hr",null,null,-1)),s(a).platform.is.desktop?(f(),W("div",Ht,[K("div",Ut,[e(dt,{id:s(o).id,type:"event",onOnUploaded:x},null,8,["id"])])])):(f(),I(z,{key:1},{default:u(()=>[e(B,null,{default:u(()=>[e(O,{caption:""},{default:u(()=>d[14]||(d[14]=[E(" \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u044D\u0441\u043A\u0438\u0437\u0430 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0435 \u0443\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u0430 ")])),_:1})]),_:1})]),_:1})),e(de,{spaced:"1em"}),e(ve,{name:"progName",modelValue:s(o).progName,"onUpdate:modelValue":d[2]||(d[2]=b=>s(o).progName=b),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),e(wt,{onSelected:p}),e(Be,{modelValue:s(o).pay,"onUpdate:modelValue":d[3]||(d[3]=b=>s(o).pay=b),"emit-value":"","map-options":"",label:"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0432\u0445\u043E\u0434\u0430",options:M},null,8,["modelValue"]),d[21]||(d[21]=K("br",null,null,-1)),[3,4].includes(s(o).pay)?(f(),W(Z,{key:2},[e(ve,{type:"text",modelValue:s(o).ticketLink,"onUpdate:modelValue":d[4]||(d[4]=b=>s(o).ticketLink=b),label:"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435 \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"]),d[16]||(d[16]=K("br",null,null,-1)),e(ve,{modelValue:s(o).radarioEventId,"onUpdate:modelValue":d[5]||(d[5]=b=>s(o).radarioEventId=b),type:"number","stack-label":"",placeholder:"1234567",label:"ID \u043C\u0435\u0440\u043E\u043F\u0440\u0438\u044F\u0442\u0438\u044F \u043D\u0430 Radario"},{default:u(()=>[e(_u,null,{default:u(()=>d[15]||(d[15]=[E("\u0426\u0438\u0444\u0440\u044B \u0432 \u043A\u043E\u043D\u0446\u0435 \u0441\u0441\u044B\u043B\u043A\u0438 \u043D\u0430 \u043F\u043E\u043A\u0443\u043F\u043A\u0443 \u0431\u0438\u043B\u0435\u0442\u043E\u0432")])),_:1})]),_:1},8,["modelValue"]),d[17]||(d[17]=K("br",null,null,-1)),e(me,null,{default:u(()=>[e(au,{modelValue:s(o).isPushkin,"onUpdate:modelValue":d[6]||(d[6]=b=>s(o).isPushkin=b),label:"\u041F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430",color:"green"},null,8,["modelValue"]),e(Le),e(au,{modelValue:s(o).isShowTicketCount,"onUpdate:modelValue":d[7]||(d[7]=b=>s(o).isShowTicketCount=b),color:"green",label:"\u041E\u0441\u0442\u0430\u0442\u043E\u043A \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"])]),_:1}),d[18]||(d[18]=K("br",null,null,-1))],64)):L("",!0),e(ve,{type:"number",modelValue:s(o).age,"onUpdate:modelValue":d[8]||(d[8]=b=>s(o).age=b),label:"\u0412\u043E\u0437\u0440\u0430\u0441\u0442\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"},null,8,["modelValue"]),d[22]||(d[22]=K("br",null,null,-1)),e(de,{spaced:""}),e(ve,{name:"evDescr",modelValue:s(o).sdescr,"onUpdate:modelValue":d[9]||(d[9]=b=>s(o).sdescr=b),type:"textarea",autogrow:"",label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),d[23]||(d[23]=K("br",null,null,-1)),e(ve,{name:"evText",modelValue:s(o).description,"onUpdate:modelValue":[d[10]||(d[10]=b=>s(o).description=b),d[11]||(d[11]=b=>_e())],type:"textarea",autogrow:"",debounce:300,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),e(de,{spaced:"1em"}),K("div",It,[e(Zu,{modelValue:T,"onUpdate:modelValue":d[12]||(d[12]=b=>T=b),style:{width:"100%"},label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",factory:P,ref_key:"posterUploader",ref:w,onUploaded:F,onFailed:Y,"no-thumbnails":""},null,512)]),e(me,{align:"right"},{default:u(()=>[e(X,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:re,color:"green","icon-right":"save",flat:""})]),_:1})]),e(de,{spaced:"1em"})])])):L("",!0),e(de),e(hu,{label:"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0439",modelValue:we.value,"onUpdate:modelValue":d[13]||(d[13]=b=>we.value=b)},{default:u(()=>[we.value?(f(),I(Et,{key:0,announce:s(o)},null,8,["announce"])):L("",!0)]),_:1},8,["modelValue"]),e(de),d[24]||(d[24]=K("br",null,null,-1)),d[25]||(d[25]=K("hr",null,null,-1)),d[26]||(d[26]=K("br",null,null,-1))],64))}};var Ft=eu(Pt,[["__scopeId","data-v-e7609992"]]);const Tt={key:0,class:"posterArea relative-position"},Qt={key:0,style:{position:"absolute",right:"1em",top:"1em","z-index":"10"}},Lt={class:"eventboxin"},Wt={key:0},Nt=["innerHTML"],Kt={key:1},Rt={key:1,class:"videoItem"},jt={__name:"AnnounceDescr",emits:["delPoster"],setup(l,{emit:$}){const m=String("https://sakh-orch.ru/api/"),v=ie(),r=oe("editMode"),a=oe("Announce"),g=j(()=>{let k=v.platform.is.mobile?1080:480;return a.value.poster?at(m,a.value.poster.md5,a.value.poster.ext,k):"/img/news/default_sketch.svg"});function H(){return"https://vk.com/share.php?url="+String("https://sakh-orch.ru/")+"/announce/"+String(a.value.id)+"&title="+String(a.value.progName)+"&noparse=true&image="+String(g.value)}function o(){ye.post(m+"epoint/event/poster.php",{params:{method:"unlink",id:a.value.id}}).then(k=>{var p;if(!((p=k==null?void 0:k.data)!=null&&p.result))throw new Error;delete a.value.poster,delete a.value.posterId}).catch(k=>{v.notify(fe(k))})}return(k,p)=>(f(),W(Z,null,[s(a).poster?(f(),W("div",Tt,[s(r)?(f(),W("div",Qt,[e(We,{"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",onOnOk:p[0]||(p[0]=A=>o())})])):L("",!0),s(a).poster.status==="process"?(f(),I(z,{key:1},{default:u(()=>[e(nu),e(B,null,{default:u(()=>[e(rt,{showing:"",label:"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430"})]),_:1})]),_:1})):(f(),I(nu,{key:2,src:g.value},{error:u(()=>p[1]||(p[1]=[K("img",{src:"/img/news/default_sketch.svg"},null,-1)])),_:1},8,["src"]))])):L("",!0),K("div",Lt,[e(Ee,{class:"transparent no-padding",flat:""},{default:u(()=>[e(te,{class:"no-padding"},{default:u(()=>[e(z,null,{default:u(()=>[e(B,null,{default:u(()=>[e(O,{class:"title"},{default:u(()=>[E(Q(s(a).progName),1)]),_:1}),e(O,{class:"title"},{default:u(()=>[E(Q(s(ot)(s(a).eventTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(te,null,{default:u(()=>[(f(!0),W(Z,null,Fe(s(a).parsedMD,(A,D)=>(f(),W(Z,{key:D},[A.type==="text"?(f(),W("div",Wt,[A.content!==`
`?(f(),W("div",{key:0,innerHTML:A.content,class:"textBlock"},null,8,Nt)):(f(),W("br",Kt))])):L("",!0),A.type==="video"?(f(),W("div",Rt,[e(ft,{ratio:16/9,src:"https://www.youtube.com/embed/"+A.content},null,8,["src"])])):L("",!0)],64))),128))]),_:1}),!s(a).completed&&[3,4].includes(s(a).pay)&&s(a).ticketLink?(f(),I(me,{key:0,align:"right"})):L("",!0),e(te,null,{default:u(()=>[e(z,{dense:""},{default:u(()=>[e(O,{caption:""},{default:u(()=>p[2]||(p[2]=[E(" \u0423\u0432\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043F\u043E\u0441\u0435\u0442\u0438\u0442\u0435\u043B\u0438, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0440\u043E\u0441\u044C\u0431\u0430 \u0441\u043E\u0431\u043B\u044E\u0434\u0430\u0442\u044C \u043C\u0435\u0440\u044B \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438 \u0432 \u0441\u0432\u044F\u0437\u0438 \u0441 \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u0438\u0435\u043C \u043A\u043E\u0440\u043E\u043D\u0430\u0432\u0438\u0440\u0443\u0441\u043D\u043E\u0439 \u0438\u043D\u0444\u0435\u043A\u0446\u0438\u0438! ")])),_:1})]),_:1})]),_:1}),e(te,null,{default:u(()=>[e(z,{clickable:"",href:s(a).Hall.map,target:"_blank"},{default:u(()=>[e(B,{avatar:""},{default:u(()=>[e(Se,{name:"place"})]),_:1}),e(B,null,{default:u(()=>[e(O,null,{default:u(()=>[E(Q(s(a).Hall.name),1)]),_:1}),e(O,{caption:""},{default:u(()=>[E(Q(s(a).Hall.suggest.address.formatted),1)]),_:1})]),_:1})]),_:1},8,["href"])]),_:1}),!s(a).completed&&[3,4].includes(s(a).pay)&&s(a).ticketLink?(f(),I(te,{key:1},{default:u(()=>[e(z,{clickable:"",href:s(a).ticketLink,target:"_blank"},{default:u(()=>[s(a).pay===3?(f(),W(Z,{key:0},[e(B,{avatar:""},{default:u(()=>[e(Se,{name:"shopping_cart"})]),_:1}),e(B,null,{default:u(()=>[e(O,null,{default:u(()=>p[3]||(p[3]=[E("\u041A\u0443\u043F\u0438\u0442\u044C \u0431\u0438\u043B\u0435\u0442")])),_:1}),s(a).isPushkin?(f(),I(O,{key:0,caption:""},{default:u(()=>p[4]||(p[4]=[E("+ \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043F\u043E \u043F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u043E\u0439 \u043A\u0430\u0440\u0442\u0435")])),_:1})):L("",!0)]),_:1})],64)):L("",!0),s(a).pay===4?(f(),W(Z,{key:1},[e(B,{avatar:""},{default:u(()=>[e(Se,{name:"img:/img/uds.svg"})]),_:1}),e(B,null,{default:u(()=>[e(O,null,{default:u(()=>p[5]||(p[5]=[E("\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439")])),_:1})]),_:1})],64)):L("",!0)]),_:1},8,["href"])]),_:1})):L("",!0),e(de),e(te,{class:"no-padding"},{default:u(()=>[e(vu,{"phone-number":"+7-(4242)-300-518"}),e(vu,{"phone-number":"+7-(962)-416-36-89"})]),_:1}),e(de,{spaced:"1em"}),e(me,{align:"right"},{default:u(()=>[e(X,{href:H(),target:"_blank",outline:"",icon:"img:/img/logo/vk/VK Logo Black & White.svg",label:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},null,8,["href"])]),_:1})]),_:1})])],64))}};var Yt=eu(jt,[["__scopeId","data-v-f32b83ae"]]);const zt={class:"centralCol"},Jt={class:"eventboxl"},Xt={__name:"AnnouncePage",setup(l){const $=it("\u0410\u043D\u043E\u043D\u0441");Uu($);const m=ie(),r=oe("editModes").announce;le("editMode",r);const a=String("https://sakh-orch.ru/api/"),g=gu(),H=h(),o=h(null);le("Announce",o);function k(){ye.post(a+"epoint/event/announce.php",{params:{method:"get",id:g.params.evid}}).then(p=>{var A,D;o.value=(D=(A=p==null?void 0:p.data)==null?void 0:A.data)!=null?D:null,console.log("Announce loaded")}).catch(p=>{m.notify(fe(p))})}return Ze(()=>{k()}),(p,A)=>(f(),I($u,{class:"col myScrollArea"},{default:u(()=>[K("div",zt,[s(r)&&o.value?(f(),I(Ft,{key:0,onPosterUploaded:k,onReload:k,ref_key:"editorRef",ref:H},null,512)):L("",!0),K("div",Jt,[o.value?(f(),I(Yt,{key:0,onDelPoster:A[0]||(A[0]=()=>{H.value.delPoster()})})):L("",!0)])]),e(Hu)]),_:1}))}};var Ql=eu(Xt,[["__scopeId","data-v-6738d0fd"]]);export{Ql as default};
