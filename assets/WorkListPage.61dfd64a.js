import{m as f,n as _,q as a,f as t,t as h,u as w,A as C,B as S,v as o,i as c,c as N,w as M,D as U,F as D,E as q,r as k,y as F,bi as b,x as H,b as j,G as z,I as G,H as J,p as x,o as K,l as R,z as X,ax as Y}from"./index.e91fb510.js";import{Q as A,b as Z}from"./QImg.74d9d22f.js";import{Q as V}from"./QItemLabel.5220bd87.js";import"./QSelect.458574af.js";import{A as ee}from"./AuthorItem.64525302.js";/* empty css                                                                   */import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import"./LocalStorage.444a7db9.js";import{u as E}from"./use-quasar.87d72c4b.js";import{a as te}from"./axios.07914dc4.js";import{Q as oe}from"./QList.840fbbd1.js";import{h as ae,n as le}from"./myFuncts.bdba1267.js";/* empty css                                                             */import{P as re}from"./PageShell.39877c62.js";import{_ as ne}from"./BtnLibEdit.86045c93.js";import{Q as ie}from"./QForm.e9759f6d.js";/* empty css               */import"./QMenu.3148f36e.js";import"./position-engine.530b58a5.js";import"./selection.b594d881.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";/* empty css                                                               */import"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.ce02be63.js";import"./touch.9135741d.js";import"./AnderHeader.vue_vue_type_style_index_0_lang.d39e13e6.js";import"./QScrollArea.1d5f5a86.js";import"./QLinearProgress.66f5a960.js";import"./myAuth.5621b016.js";const se={__name:"WorkItem",props:{work:Object},setup(i){const u=E();return(m,l)=>(f(),_(Z,{clickable:"",to:`/work/${i.work.id}`,dense:""},{default:a(()=>[t(A,null,{default:a(()=>[t(V,null,{default:a(()=>[h(w(i.work.titleRu),1)]),_:1}),t(V,{caption:""},{default:a(()=>[h(w(i.work.titleEn),1)]),_:1})]),_:1}),t(A,{side:"",class:"opus"},{default:a(()=>[t(V,{caption:""},{default:a(()=>{var e;return[h(w((e=i.work.opus)!=null?e:"Op.?"),1)]}),_:1}),t(V,{caption:""},{default:a(()=>{var e;return[h(w((e=i.work.icatno)!=null?e:"cat\u2116.?"),1)]}),_:1}),t(V,{caption:""},{default:a(()=>{var e;return[h(w((e=i.work.catalogIndex)!=null?e:"catIdx: ?"),1)]}),_:1}),t(C,{dense:"","icon-right":"content_copy",flat:"",label:`ID: ${i.work.id}`,onClick:l[0]||(l[0]=S(e=>o(ae)(i.work.id,o(u)),["prevent","stop"]))},null,8,["label"])]),_:1})]),_:1},8,["to"]))}};var ue=B(se,[["__scopeId","data-v-4b9f681b"]]);const de={__name:"WorkList",setup(i){const u=c("works"),m=c("searchText"),l=N(()=>{if(!m.value)return u.value;const e=m.value.toLowerCase();return u.value.filter(n=>(n.titleRu?n.titleRu.toLowerCase().includes(e):!1)||(n.titleEn?n.titleEn.toLowerCase().includes(e):!1))});return M(m,(e,n)=>{console.log("Search text changed from",n,"to",e)}),(e,n)=>(f(),_(oe,{separator:""},{default:a(()=>[(f(!0),U(D,null,q(l.value,d=>(f(),_(ue,{key:d.id,work:d},null,8,["work"]))),128))]),_:1}))}},me={__name:"WorkDialog",setup(i){E();const u=c("isOpenWorkDialog"),m=k(!1),l=c("work");function e(){!d()||save()}function n(){m.value=!1}function d(){return refTitle.value.validate()&&refNum.value.validate()}return(I,r)=>(f(),_(z,{modelValue:o(u),"onUpdate:modelValue":r[4]||(r[4]=s=>j(u)?u.value=s:null),onBeforeHide:n},{default:a(()=>[t(H,{bordered:"",class:"dialogArea"},{default:a(()=>[t(ie,{onSubmit:S(e,["prevent","stop"])},{default:a(()=>[t(F,null,{default:a(()=>[t(b,{modelValue:o(l).titleRu,"onUpdate:modelValue":r[0]||(r[0]=s=>o(l).titleRu=s),prefix:"RU",label:"\u0420\u0443\u0441\u0441\u043A\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),t(b,{modelValue:o(l).titleEn,"onUpdate:modelValue":r[1]||(r[1]=s=>o(l).titleEn=s),prefix:"EN",label:"\u041C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),t(b,{modelValue:o(l).opus,"onUpdate:modelValue":r[2]||(r[2]=s=>o(l).opus=s),prefix:"Op.",label:"\u041E\u043F\u0443\u0441"},null,8,["modelValue"]),t(b,{modelValue:o(l).catalogIndex,"onUpdate:modelValue":r[3]||(r[3]=s=>o(l).catalogIndex=s),label:"\u041A\u0430\u0442\u0430\u043B\u043E\u0433. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440: BWV 123"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const ce={class:"centralCol"},pe={__name:"WorkListPage",setup(i){const u=E(),m=G();J();const l=String("https://sakh-orch.ru/stapi/"),e=k("");x("searchText",e);const n=k(!1);x("progress",n);const d=k([]);x("works",d),c("AuthorSelectList");const I=c("selectedAuthorId"),r=c("selectedAuthor"),s=c("libEditMode"),W=k(!1);x("isOpenWorkDialog",W);const y=k(null);x("work",y);function O(){let Q=m.params.authorId*1;!Q||(n.value=!0,te.post(l+"epoint/lib/work.php",{params:{method:"list",authorId:Q}}).then(p=>{var v,g;d.value=[],d.value=(g=(v=p==null?void 0:p.data)==null?void 0:v.data)!=null?g:[]}).catch(p=>{d.value=[],u.notify(le(p))}).finally(()=>{n.value=!1}))}const P=c("loadAuthor");function T(){y.value={id:void 0,titleRu:"",titleEn:"",authorId:I.value,opus:"",icatno:""},W.value=!0}return K(()=>{I.value=m.params.authorId*1,P(),O(),console.log(r.value)}),(Q,p)=>(f(),U(D,null,[t(re,{"page-title":"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u044F "},{ToolPanel:a(()=>{var v,g,L;return[o(s)?(f(),_(C,{key:0,onClick:T,icon:"add",flat:"",round:""})):R("",!0),t(ee,{id:o(I),iofEn:(v=o(r))==null?void 0:v.iofEn,iconUrl:(g=o(r))==null?void 0:g.iconUrl,fioRu:(L=o(r))==null?void 0:L.fioRu},null,8,["id","iofEn","iconUrl","fioRu"]),t(b,{modelValue:e.value,"onUpdate:modelValue":p[0]||(p[0]=$=>e.value=$),style:{width:"100%","max-width":"16em"},label:"\u0444\u0438\u043B\u044C\u0442\u0440","stack-label":"",clearable:""},{append:a(()=>[t(X,{name:"search"})]),_:1},8,["modelValue"]),t(ne)]}),PageContent:a(()=>[Y("div",ce,[d.value.length?(f(),_(de,{key:0})):R("",!0)])]),_:1}),t(me)],64))}};var qe=B(pe,[["__scopeId","data-v-5d6c87f8"]]);export{qe as default};
