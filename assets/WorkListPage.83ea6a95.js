import{i as p,c as O,w as S,m as c,n as x,q as u,D,F as E,E as P,r as m,f as l,B as T,y as M,bi as w,v as a,A as Q,x as N,b as q,G as F,I as H,H as $,p as g,k as j,o as z,l as R,z as G,ax as J}from"./index.f5e978c0.js";import"./QImg.628e9f39.js";import"./QItemLabel.4c832645.js";import"./QSelect.ed6de9a4.js";import{A as K}from"./AuthorItem.68f5c219.js";import{W as B,A as V}from"./lib.ab987395.js";/* empty css                                                                   */import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import"./LocalStorage.a31cb3b4.js";import{u as C}from"./use-quasar.cdf0ea62.js";import"./axios.b6bdbb44.js";import{Q as Y}from"./QList.c6e92f7b.js";import{W as Z}from"./WorkItem.511bbfe5.js";import"./myFuncts.28762f14.js";import{P as ee}from"./PageShell.bef0802e.js";import{Q as te}from"./QForm.2a82004a.js";/* empty css               */import"./QMenu.95cba417.js";import"./position-engine.93af21d7.js";import"./selection.52642521.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";/* empty css                                                               */import"./myAxios.e0606f23.js";import"./BtnDelete.921da25f.js";import"./QTooltip.7abf715f.js";import"./MainFooter.vue_vue_type_style_index_0_scoped_true_lang.990b59f1.js";import"./touch.9135741d.js";import"./QScrollArea.d29ff5ca.js";import"./QLinearProgress.92cabfad.js";/* empty css                                                    */const oe={__name:"WorkList",emits:["onDel"],setup(I,{emit:f}){const i=p("works"),n=p("searchText"),d=O(()=>{if(!n.value)return i.value;const r=n.value.toLowerCase();return i.value.filter(o=>(o.titleRu?o.titleRu.toLowerCase().includes(r):!1)||(o.titleEn?o.titleEn.toLowerCase().includes(r):!1))}),t=f;return S(n,(r,o)=>{console.log("Search text changed from",o,"to",r)}),(r,o)=>(c(),x(Y,{separator:""},{default:u(()=>[(c(!0),D(E,null,P(d.value,v=>(c(),x(Z,{key:v.id,work:v,onOnDel:o[0]||(o[0]=_=>t("onDel"))},null,8,["work"]))),128))]),_:1}))}},ae={__name:"WorkDialog",emits:["onSave"],setup(I,{emit:f}){const i=C(),n=p("isOpenWorkDialog"),d=m(!1),t=p("work"),r=m();function o(){n.value=!1}const v=f;function _(){!b()||h()}async function h(){await B.add(i,t.value)&&(v("onSave"),o())}function k(){d.value=!1}function b(){return r.value.validate()}return(W,e)=>(c(),x(F,{modelValue:a(n),"onUpdate:modelValue":e[4]||(e[4]=s=>q(n)?n.value=s:null),onBeforeHide:k},{default:u(()=>[l(N,{bordered:"",class:"dialogArea"},{default:u(()=>[l(te,{onSubmit:T(_,["prevent","stop"])},{default:u(()=>[l(M,null,{default:u(()=>[l(w,{modelValue:a(t).titleRu,"onUpdate:modelValue":e[0]||(e[0]=s=>a(t).titleRu=s),ref_key:"refTitle",ref:r,prefix:"RU",label:"\u0420\u0443\u0441\u0441\u043A\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),l(w,{modelValue:a(t).titleEn,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).titleEn=s),prefix:"EN",label:"\u041C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),l(w,{modelValue:a(t).opus,"onUpdate:modelValue":e[2]||(e[2]=s=>a(t).opus=s),prefix:"Op.",label:"\u041E\u043F\u0443\u0441","stack-label":""},null,8,["modelValue"]),l(w,{modelValue:a(t).catalogIndex,"onUpdate:modelValue":e[3]||(e[3]=s=>a(t).catalogIndex=s),label:"\u041A\u0430\u0442\u0430\u043B\u043E\u0433. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440: BWV 123","stack-label":""},null,8,["modelValue"]),l(Q,{type:"submit",label:"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const le={class:"centralCol"},re={__name:"WorkListPage",setup(I){const f=C(),i=H();$();const n=p("loadingAuthors"),d=m("");g("searchText",d);const t=m(!1);g("progress",t);const r=m([]);g("works",r);const o=p("selectedAuthorId"),v=p("editMode"),_=m(!1);g("isOpenWorkDialog",_);const h=m(null);g("work",h);async function k(){t.value=!0;const e=await B.getListByAuthor(f,i.params.authorId);e&&(r.value=e),t.value=!1}async function b(){n.value=!0;const e=await V.get(f,i.params.authorId);e&&(V.selected.value=e),n.value=!1}function W(){h.value={id:void 0,titleRu:"",titleEn:"",authorId:i.params.authorId,opus:"",icatno:""},_.value=!0}return j(()=>{o.value=i.params.authorId*1}),z(()=>{b(),k()}),(e,s)=>(c(),D(E,null,[l(ee,{"page-title":"\u041F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u044F "},{ToolPanel:u(()=>{var y,L,A;return[a(v)?(c(),x(Q,{key:0,onClick:W,icon:"add",flat:"",round:""})):R("",!0),l(K,{id:a(o),iofEn:(y=a(V).selected.value)==null?void 0:y.iofEn,iconUrl:(L=a(V).selected.value)==null?void 0:L.iconUrl,fioRu:(A=a(V).selected.value)==null?void 0:A.fioRu},null,8,["id","iofEn","iconUrl","fioRu"]),l(w,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=U=>d.value=U),style:{width:"100%","max-width":"16em"},label:"\u0444\u0438\u043B\u044C\u0442\u0440","stack-label":"",clearable:""},{append:u(()=>[l(G,{name:"search"})]),_:1},8,["modelValue"])]}),PageContent:u(()=>[J("div",le,[r.value.length?(c(),x(oe,{key:0,onOnDel:k})):R("",!0)])]),_:1}),l(ae,{onOnSave:k})],64))}};var Se=X(re,[["__scopeId","data-v-6b876069"]]);export{Se as default};
