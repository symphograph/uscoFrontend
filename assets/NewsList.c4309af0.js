import{Q as j}from"./QVirtualScroll.2b60d040.js";import{Q as H,M as U}from"./QScrollArea.08a568a1.js";import{m as i,n as y,p as a,f as s,u as d,d as A,i as z,r as I,C as _,ax as w,z as x,l as v,B as L,q as E,t as B,H as Y,w as R,o as G,F as M,D as J,aY as K}from"./index.1ed4f0d9.js";import{a as $,b as F,Q as P}from"./QImg.d3ea3630.js";import{Q as N}from"./QItemLabel.91ec210f.js";import{Q as b}from"./QTooltip.4f8868a4.js";import{i as W,u as O,f as X}from"./myFuncts.57fb681f.js";import{_ as Z}from"./BtnDelete.3fcc8c4a.js";import{E as Q}from"./entry.5005a3f9.js";import{_ as V}from"./plugin-vue_export-helper.21dcd24c.js";const ee={__name:"SketchImg",props:{md5:{type:String,required:!0},ext:{type:String,required:!0},size:{type:Number,required:!1,default:0}},setup(c){const h=String("https://sakh-orch.ru/api/");return(m,C)=>(i(),y($,{src:d(W)(d(h),c.md5,c.ext,c.size),ratio:1920/1080,fit:"fill","placeholder-src":"/img/news/default_sketch.svg"},{error:a(()=>[s($,{src:"/img/news/default_sketch.svg"})]),_:1},8,["src"]))}};const te={class:"narea"},ue={class:"nimg_block"},se={class:"tcol"},ae={class:"mainText"},ie={key:0,style:{display:"flex","justify-content":"right","grid-gap":"1em"}},oe=A({__name:"NewItem",props:{item:{}},emits:["hideOrShow","delEntry"],setup(c,{emit:h}){const m=O(),g=z("editModes").entry,D=h,n=I(!1),t=c,o=I(t.item);function f(){var e,u;return(e=t.item)!=null&&e.announceId?{to:"/announce/"+t.item.announceId,href:void 0}:(u=t.item)!=null&&u.isExternal?{to:void 0,href:t.item.refLink}:{to:"/new/"+t.item.id,href:void 0}}async function p(){n.value=!0,await Q.hideOrShow(m,t.item.id,!o.value.isShow)&&(o.value.isShow=!o.value.isShow),n.value=!1}async function S(){n.value=!0,await Q.del(m,t.item.id)&&D("delEntry",t.item.id),n.value=!1}return(e,u)=>(i(),_("div",{key:`en${e.item.id}`},[w("div",te,[w("div",ue,[w("div",null,[s(F,{href:f().href,to:f().to,dense:"",class:"no-padding",target:"_blank"},{default:a(()=>{var r,k,l,T;return[s(ee,{ext:((k=(r=e.item)==null?void 0:r.sketch)==null?void 0:k.ext)||"",md5:((T=(l=e.item)==null?void 0:l.sketch)==null?void 0:T.md5)||"",size:d(m).platform.is.desktop?260:1080},null,8,["ext","md5","size"])]}),_:1},8,["href","to"])])]),w("div",se,[s(F,{clickable:"",href:f().href,to:f().to,target:"_blank"},{default:a(()=>[s(P,null,{default:a(()=>[s(N,{class:"ItemHeader text-h6"},{default:a(()=>[E(B(e.item.title),1)]),_:1}),s(N,null,{default:a(()=>[w("span",ae,B(e.item.descr),1)]),_:1}),s(N,{caption:""},{default:a(()=>[E(B(d(X)(e.item.date)),1)]),_:1})]),_:1})]),_:1},8,["href","to"])]),d(g)?(i(),_("div",ie,[o.value.isShow?(i(),y(x,{key:0,icon:"visibility",loading:n.value,flat:"",color:"green",outline:"",onClick:u[0]||(u[0]=r=>p())},{default:a(()=>[s(b,null,{default:a(()=>u[3]||(u[3]=[E("\u0421\u043A\u0440\u044B\u0442\u044C")])),_:1})]),_:1},8,["loading"])):(i(),y(x,{key:1,color:"orange",flat:"",icon:"visibility_off",onClick:u[1]||(u[1]=r=>p())},{default:a(()=>[s(b,null,{default:a(()=>u[4]||(u[4]=[E("\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C")])),_:1})]),_:1})),s(Z,{danger:"",flat:"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u043E\u0432\u043E\u0441\u0442\u044C",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C","throw-confirm":"",onOnOk:u[2]||(u[2]=r=>S())}),s(x,{icon:"edit",flat:"",to:"/new/"+e.item.id},{default:a(()=>[s(b,{anchor:"top middle"},{default:a(()=>u[5]||(u[5]=[E("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C")])),_:1})]),_:1},8,["to"])])):v("",!0)]),s(L)]))}});var q=V(oe,[["__scopeId","data-v-13d183d6"]]);const re={key:2,class:"noEntyes"},le=A({__name:"NewsList",props:{category:{},year:{},isTop:{type:Boolean}},setup(c,{expose:h}){const m=O(),C=Y(),g=z("progress"),n=z("editModes").entry,t=I([]),o=c,f=I(o.category);R(C,e=>{f.value=e.params.category,p()});async function p(){g.value=!0,o.isTop?t.value=await Q.listTop(m):t.value=await Q.listByYear(m,(o==null?void 0:o.year)||0,f.value),g.value=!1}function S(e){const u=t.value.findIndex(r=>r.id===e);u!==-1&&t.value.splice(u,1)}return h({loadData:p}),G(()=>{p()}),(e,u)=>{var r,k;return i(),_(M,null,[((r=t.value)==null?void 0:r.length)&&!e.isTop?(i(),y(H,{key:0,id:"scroll-area-with-virtual-scroll-1",style:{height:"100%"}},{default:a(()=>[s(j,{items:t.value,"virtual-scroll-item-size":"40","virtual-scroll-slice-size":"5","virtual-scroll-sticky-size-start":148,"virtual-scroll-sticky-size-end":132,"scroll-target":"#scroll-area-with-virtual-scroll-1 > .scroll"},K({default:a(({item:l})=>[l.isShow||d(n)?(i(),y(q,{class:"EntryItem",item:l,key:`entry${l.id}`,onDelEntry:S},null,8,["item"])):v("",!0)]),_:2},[e.isTop?void 0:{name:"after",fn:a(()=>[s(U)]),key:"0"}]),1032,["items"])]),_:1})):v("",!0),((k=t.value)==null?void 0:k.length)&&e.isTop?(i(!0),_(M,{key:1},J(t.value,l=>(i(),_(M,{key:l.id},[l.isShow||d(n)?(i(),y(q,{key:0,item:l,onDelEntry:S},null,8,["item"])):v("",!0),s(L)],64))),128)):v("",!0),!t.value&&!d(g)?(i(),_("h5",re," \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443. ")):v("",!0)],64)}}});var ge=V(le,[["__scopeId","data-v-1f327e09"]]);export{ge as N};
