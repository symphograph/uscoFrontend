import{u as ct}from"./use-meta.6535a57c.js";import{u as xe}from"./use-quasar.ff1c236f.js";import{api as He}from"./axios.4ccd572a.js";import{K as vt,ap as mt,ba as ft,ar as pt,bi as ht,r as I,c as y,w as Ne,aJ as _t,Y as kt,h as p,g as gt,bj as yt,a2 as bt,aI as At,aD as wt,ac as Ce,a9 as ue,i as G,n as k,q as C,f as l,G as s,V as f,bh as X,S as ae,H as h,u as Le,aX as Vt,p as Ee,t as E,l as H,W as ye,bk as Se,F as L,I as je,J as ze,aZ as W,U as P,ax as _e,aw as Dt,aY as Mt,o as qt}from"./index.d7d1bcb8.js";import{Q as Ye}from"./QSelect.0366063b.js";import{Q as Ct}from"./style.dba5a572.js";import{u as St,a as xt,b as Ht,_ as ke,g as It,f as Ut,Q as Be,c as Tt}from"./QPopupProxy.4484cca8.js";import{T as $t}from"./TouchPan.4cc0dc22.js";import{p as R}from"./format.3e32b8d9.js";import{C as Ke}from"./ClosePopup.7ac17327.js";import{a as Qt,n as Ie,i as Ot,b as Pt,g as Nt}from"./myFuncts.bfee3d05.js";import{A as Yt}from"./AnnounceCard.bfde8bfe.js";import{S as Bt}from"./SketchUploader.e2e1bf27.js";import{m as Kt}from"./myAuth.f2132660.js";import{_ as Ue}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as Ft}from"./QImg.83f9a5cf.js";import{b as ge,Q as F,a as N}from"./QItemLabel.225c1518.js";import{Q as Lt}from"./QVideo.6447472f.js";import{_ as Fe}from"./PhoneNumber.c9cd51c4.js";import{_ as Et}from"./BtnDelete.495bf513.js";import"./QToolbarTitle.a2a60936.js";import"./QToolbar.80094866.js";import"./QLinearProgress.d8cf207f.js";import"./rtl.da602a43.js";import"./position-engine.802685a2.js";import"./use-file.f7a34da4.js";import"./get-emits-object.24798346.js";import"./use-render-cache.1a7235d4.js";import"./touch.3df10340.js";import"./QTooltip.87ead732.js";import"./use-ratio.6d8d9949.js";function jt(n,$){if(n.hour!==null){if(n.minute===null)return"minute";if($===!0&&n.second===null)return"second"}return"hour"}function zt(){const n=new Date;return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds(),millisecond:n.getMilliseconds()}}var Jt=vt({name:"QTime",props:{...mt,...ft,...St,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:n=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(n)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:xt,setup(n,{slots:$,emit:V}){const S=gt(),{$q:r}=S.proxy,D=pt(n,r),{tabindex:g,headerClass:x,getLocale:w,getCurrentDate:b}=Ht(n,r),M=ht(n),O=yt(M);let j,Y;const oe=I(null),B=y(()=>Re()),z=y(()=>w()),ie=y(()=>Xe()),J=ke(n.modelValue,B.value,z.value,n.calendar,ie.value),c=I(jt(J)),a=I(J),A=I(J.hour===null||J.hour<12),be=y(()=>`q-time q-time--${n.landscape===!0?"landscape":"portrait"}`+(D.value===!0?" q-time--dark q-dark":"")+(n.disable===!0?" disabled":n.readonly===!0?" q-time--readonly":"")+(n.bordered===!0?" q-time--bordered":"")+(n.square===!0?" q-time--square no-border-radius":"")+(n.flat===!0?" q-time--flat no-shadow":"")),i=y(()=>{const e=a.value;return{hour:e.hour===null?"--":o.value===!0?R(e.hour):String(A.value===!0?e.hour===0?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:e.minute===null?"--":R(e.minute),second:e.second===null?"--":R(e.second)}}),o=y(()=>n.format24h!==null?n.format24h:r.lang.date.format24h),m=y(()=>{const e=c.value==="hour",t=e===!0?12:60,u=a.value[c.value];let _=`rotate(${Math.round(u*(360/t))-180}deg) translateX(-50%)`;return e===!0&&o.value===!0&&a.value.hour>=12&&(_+=" scale(.7)"),{transform:_}}),Z=y(()=>a.value.hour!==null),se=y(()=>Z.value===!0&&a.value.minute!==null),ee=y(()=>n.hourOptions!==void 0?e=>n.hourOptions.includes(e):n.options!==void 0?e=>n.options(e,null,null):null),re=y(()=>n.minuteOptions!==void 0?e=>n.minuteOptions.includes(e):n.options!==void 0?e=>n.options(a.value.hour,e,null):null),de=y(()=>n.secondOptions!==void 0?e=>n.secondOptions.includes(e):n.options!==void 0?e=>n.options(a.value.hour,a.value.minute,e):null),T=y(()=>{if(ee.value===null)return null;const e=ve(0,11,ee.value),t=ve(12,11,ee.value);return{am:e,pm:t,values:e.values.concat(t.values)}}),te=y(()=>re.value!==null?ve(0,59,re.value):null),ne=y(()=>de.value!==null?ve(0,59,de.value):null),ce=y(()=>{switch(c.value){case"hour":return T.value;case"minute":return te.value;case"second":return ne.value}}),Je=y(()=>{let e,t,u=0,v=1;const _=ce.value!==null?ce.value.values:void 0;c.value==="hour"?o.value===!0?(e=0,t=23):(e=0,t=11,A.value===!1&&(u=12)):(e=0,t=55,v=5);const U=[];for(let d=e,q=e;d<=t;d+=v,q++){const K=d+u,rt=_!==void 0&&_.includes(K)===!1,dt=c.value==="hour"&&d===0?o.value===!0?"00":"12":d;U.push({val:K,index:q,disable:rt,label:dt})}return U}),We=y(()=>[[$t,Ge,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Ne(()=>n.modelValue,e=>{const t=ke(e,B.value,z.value,n.calendar,ie.value);(t.dateHash!==a.value.dateHash||t.timeHash!==a.value.timeHash)&&(a.value=t,t.hour===null?c.value="hour":A.value=t.hour<12)}),Ne([B,z],()=>{bt(()=>{qe()})});function Te(){const e={...b(),...zt()};qe(e),Object.assign(a.value,e),c.value="hour"}function ve(e,t,u){const v=Array.apply(null,{length:t+1}).map((_,U)=>{const d=U+e;return{index:d,val:u(d)===!0}}).filter(_=>_.val===!0).map(_=>_.index);return{min:v[0],max:v[v.length-1],values:v,threshold:t+1}}function $e(e,t,u){const v=Math.abs(e-t);return Math.min(v,u-v)}function Ae(e,{min:t,max:u,values:v,threshold:_}){if(e===t)return t;if(e<t||e>u)return $e(e,t,_)<=$e(e,u,_)?t:u;const U=v.findIndex(K=>e<=K),d=v[U-1],q=v[U];return e-d<=q-e?d:q}function Re(){return n.calendar!=="persian"&&n.mask!==null?n.mask:`HH:mm${n.withSeconds===!0?":ss":""}`}function Xe(){if(typeof n.defaultDate!="string"){const e=b(!0);return e.dateHash=It(e),e}return ke(n.defaultDate,"YYYY/MM/DD",void 0,n.calendar)}function we(){return At(S)===!0||ce.value!==null&&(ce.value.values.length===0||c.value==="hour"&&o.value!==!0&&T.value[A.value===!0?"am":"pm"].values.length===0)}function Ve(){const e=oe.value,{top:t,left:u,width:v}=e.getBoundingClientRect(),_=v/2;return{top:t+_,left:u+_,dist:_*.7}}function Ge(e){if(we()!==!0){if(e.isFirst===!0){j=Ve(),Y=me(e.evt,j);return}Y=me(e.evt,j,Y),e.isFinal===!0&&(j=!1,Y=null,Qe())}}function Qe(){c.value==="hour"?c.value="minute":n.withSeconds&&c.value==="minute"&&(c.value="second")}function me(e,t,u){const v=_t(e),_=Math.abs(v.top-t.top),U=Math.sqrt(Math.pow(Math.abs(v.top-t.top),2)+Math.pow(Math.abs(v.left-t.left),2));let d,q=Math.asin(_/U)*(180/Math.PI);if(v.top<t.top?q=t.left<v.left?90-q:270+q:q=t.left<v.left?q+90:270-q,c.value==="hour"){if(d=q/30,T.value!==null){const K=o.value!==!0?A.value===!0:T.value.am.values.length!==0&&T.value.pm.values.length!==0?U>=t.dist:T.value.am.values.length!==0;d=Ae(d+(K===!0?0:12),T.value[K===!0?"am":"pm"])}else d=Math.round(d),o.value===!0?U<t.dist?d<12&&(d+=12):d===12&&(d=0):A.value===!0&&d===12?d=0:A.value===!1&&d!==12&&(d+=12);o.value===!0&&(A.value=d<12)}else d=Math.round(q/6)%60,c.value==="minute"&&te.value!==null?d=Ae(d,te.value):c.value==="second"&&ne.value!==null&&(d=Ae(d,ne.value));return u!==d&&ot[c.value](d),d}const De={hour(){c.value="hour"},minute(){c.value="minute"},second(){c.value="second"}};function Ze(e){e.keyCode===13&&Oe()}function et(e){e.keyCode===13&&Pe()}function tt(e){we()!==!0&&(r.platform.is.desktop!==!0&&me(e,Ve()),Qe())}function nt(e){we()!==!0&&me(e,Ve())}function lt(e){if(e.keyCode===13)c.value="hour";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(T.value!==null){const u=o.value===!0?T.value.values:T.value[A.value===!0?"am":"pm"].values;if(u.length===0)return;if(a.value.hour===null)fe(u[0]);else{const v=(u.length+u.indexOf(a.value.hour)+t)%u.length;fe(u[v])}}else{const u=o.value===!0?24:12,v=o.value!==!0&&A.value===!1?12:0,_=a.value.hour===null?-t:a.value.hour;fe(v+(24+_+t)%u)}}}function at(e){if(e.keyCode===13)c.value="minute";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(te.value!==null){const u=te.value.values;if(u.length===0)return;if(a.value.minute===null)pe(u[0]);else{const v=(u.length+u.indexOf(a.value.minute)+t)%u.length;pe(u[v])}}else{const u=a.value.minute===null?-t:a.value.minute;pe((60+u+t)%60)}}}function ut(e){if(e.keyCode===13)c.value="second";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(ne.value!==null){const u=ne.value.values;if(u.length===0)return;if(a.value.seconds===null)he(u[0]);else{const v=(u.length+u.indexOf(a.value.second)+t)%u.length;he(u[v])}}else{const u=a.value.second===null?-t:a.value.second;he((60+u+t)%60)}}}function fe(e){a.value.hour!==e&&(a.value.hour=e,le())}function pe(e){a.value.minute!==e&&(a.value.minute=e,le())}function he(e){a.value.second!==e&&(a.value.second=e,le())}const ot={hour:fe,minute:pe,second:he};function Oe(){A.value===!1&&(A.value=!0,a.value.hour!==null&&(a.value.hour-=12,le()))}function Pe(){A.value===!0&&(A.value=!1,a.value.hour!==null&&(a.value.hour+=12,le()))}function Me(e){const t=n.modelValue;c.value!==e&&t!==void 0&&t!==null&&t!==""&&typeof t!="string"&&(c.value=e)}function le(){if(ee.value!==null&&ee.value(a.value.hour)!==!0){a.value=ke(),Me("hour");return}if(re.value!==null&&re.value(a.value.minute)!==!0){a.value.minute=null,a.value.second=null,Me("minute");return}if(n.withSeconds===!0&&de.value!==null&&de.value(a.value.second)!==!0){a.value.second=null,Me("second");return}a.value.hour===null||a.value.minute===null||n.withSeconds===!0&&a.value.second===null||qe()}function qe(e){const t=Object.assign({...a.value},e),u=n.calendar==="persian"?R(t.hour)+":"+R(t.minute)+(n.withSeconds===!0?":"+R(t.second):""):Ut(new Date(t.year,t.month===null?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),B.value,z.value,t.year,t.timezoneOffset);t.changed=u!==n.modelValue,V("update:modelValue",u,t)}function it(){const e=[p("div",{class:"q-time__link "+(c.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:De.hour,onKeyup:lt},i.value.hour),p("div",":"),p("div",Z.value===!0?{class:"q-time__link "+(c.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:at,onClick:De.minute}:{class:"q-time__link"},i.value.minute)];n.withSeconds===!0&&e.push(p("div",":"),p("div",se.value===!0?{class:"q-time__link "+(c.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:ut,onClick:De.second}:{class:"q-time__link"},i.value.second));const t=[p("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},e)];return o.value===!1&&t.push(p("div",{class:"q-time__header-ampm column items-between no-wrap"},[p("div",{class:"q-time__link "+(A.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Oe,onKeyup:Ze},"AM"),p("div",{class:"q-time__link "+(A.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Pe,onKeyup:et},"PM")])),p("div",{class:"q-time__header flex flex-center no-wrap "+x.value},t)}function st(){const e=a.value[c.value];return p("div",{class:"q-time__content col relative-position"},[p(wt,{name:"q-transition--scale"},()=>p("div",{key:"clock"+c.value,class:"q-time__container-parent absolute-full"},[p("div",{ref:oe,class:"q-time__container-child fit overflow-hidden"},[Ce(p("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:tt,onMousedown:nt},[p("div",{class:"q-time__clock-circle fit"},[p("div",{class:"q-time__clock-pointer"+(a.value[c.value]===null?" hidden":n.color!==void 0?` text-${n.color}`:""),style:m.value}),Je.value.map(t=>p("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${t.index}`+(t.val===e?" q-time__clock-position--active "+x.value:t.disable===!0?" q-time__clock-position--disable":"")},[p("span",t.label)]))])]),We.value)])])),n.nowBtn===!0?p(ue,{class:"q-time__now-button absolute",icon:r.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:n.color,textColor:n.textColor,tabindex:g.value,onClick:Te}):null])}return S.proxy.setNow=Te,()=>{const e=[st()],t=kt($.default);return t!==void 0&&e.push(p("div",{class:"q-time__actions"},t)),n.name!==void 0&&n.disable!==!0&&O(e,"push"),p("div",{class:be.value,tabindex:-1},[it(),p("div",{class:"q-time__main col overflow-auto"},e)])}}});const Wt={class:"q-pa-md",style:{"max-width":"300px",padding:"0"}},Rt={class:"row items-center justify-end"},Xt={class:"row items-center justify-end"},Gt={__name:"DateTime",props:{evDateTime:I("2019-02-01 12:44")},emits:["update:date"],setup(n,{emit:$}){const V=G("Announce");return I(n.evDateTime),(r,D)=>(k(),C("div",Wt,[l(X,{filled:"",modelValue:f(V).eventTime,"onUpdate:modelValue":D[2]||(D[2]=g=>f(V).eventTime=g),mask:"####-##-## ##:##"},{prepend:s(()=>[l(ae,{name:"event",class:"cursor-pointer"},{default:s(()=>[l(Be,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[l(Tt,{modelValue:f(V).eventTime,"onUpdate:modelValue":D[0]||(D[0]=g=>f(V).eventTime=g),mask:"YYYY-MM-DD HH:mm"},{default:s(()=>[h("div",Rt,[Ce(l(ue,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[Ke]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:s(()=>[l(ae,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[l(Be,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[l(Jt,{modelValue:f(V).eventTime,"onUpdate:modelValue":D[1]||(D[1]=g=>f(V).eventTime=g),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:s(()=>[h("div",Xt,[Ce(l(ue,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[Ke]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};const Q=n=>(je("data-v-39eb0314"),n=n(),ze(),n),Zt={key:0,class:"eventsarea"},en={class:"editArea"},tn={class:"card"},nn={class:"editor"},ln={style:{display:"flex","justify-content":"space-between"}},an=Q(()=>h("br",null,null,-1)),un=Q(()=>h("hr",null,null,-1)),on={class:"uploads"},sn={style:{width:"100%"}},rn=Q(()=>h("br",null,null,-1)),dn=Q(()=>h("br",null,null,-1)),cn=Q(()=>h("br",null,null,-1)),vn=Q(()=>h("br",null,null,-1)),mn={class:"uploads"},fn=Q(()=>h("br",null,null,-1)),pn=Q(()=>h("hr",null,null,-1)),hn=Q(()=>h("br",null,null,-1)),_n={__name:"AnnounceEditor",emits:["reload","posterUploaded"],setup(n,{expose:$,emit:V}){const S=String("https://api.sakh-orch.ru/"),r=xe();Le();const D=Vt();G("editMode");const g=G("Halls"),x=I("");Ee("pwUrl",x);const w=V,b={};function M(){}const O=[{label:"\u0412\u0445\u043E\u0434 \u0441\u0432\u043E\u0431\u043E\u0434\u043D\u044B\u0439",value:2},{label:"\u0411\u0438\u043B\u0435\u0442\u044B \u0432 \u043F\u0440\u043E\u0434\u0430\u0436\u0435",value:3},{label:"\u0412\u0445\u043E\u0434 \u043F\u043E \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C",value:4},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",value:5}];I(null);const j=I(null),Y=I(null);function oe(i){return{url:S+"api/event/poster.php",headers:[{name:"ACCESSTOKEN",value:Kt.self.AccessToken}],formFields:[{name:"id",value:Announce.value.id},{name:"method",value:"add"}]}}function B(i){r.notify(Qt("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E")),w("posterUploaded")}function z(i){var m,Z,se;let o=(se=(Z=JSON.parse((m=i==null?void 0:i.xhr)==null?void 0:m.response))==null?void 0:Z.error)!=null?se:"";r.notify(Ie(null,o))}function ie(){Y.value.saveData()}function J(){D.push({path:"/announces"})}function c(){w("reload")}function a(){delete Announce.value.sketch,delete Announce.value.sketchId}function A(){Announce.value.hallId=Announce.value.Hall.id}function be(){He.post(S+"api/event/announce.php",{params:{method:"updateMarkdown",id:Announce.value.id,markdown:Announce.value.description}}).then(i=>{var o;if(!((o=i==null?void 0:i.data)!=null&&o.result))throw new Error;Announce.value.parsedMD=i==null?void 0:i.data.data}).catch(i=>{})}return $({}),(i,o)=>(k(),C(L,null,[i.Announce?(k(),C("div",Zt,[h("div",en,[h("div",tn,[i.Announce.Hall.map?(k(),E(Yt,{key:0,onIamDeleted:J,onNewAnnounce:c,onDelSketch:a,ref_key:"rAnnounceCard",ref:Y,Announce:i.Announce,pwUrl:x.value},null,8,["Announce","pwUrl"])):H("",!0)]),h("div",nn,[h("div",ln,[l(Gt,{date:i.Announce.eventTime,"onUpdate:date":[o[0]||(o[0]=m=>i.Announce.eventTime=m),o[1]||(o[1]=m=>void 0)]},null,8,["date"])]),an,un,h("div",on,[h("div",sn,[l(Bt,{id:i.Announce.id,type:"event",onOnUploaded:B},null,8,["id"])])]),l(ye,{spaced:"1em"}),l(X,{name:"progName",modelValue:i.Announce.progName,"onUpdate:modelValue":o[2]||(o[2]=m=>i.Announce.progName=m),label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),l(Ye,{modelValue:i.Announce.Hall,"onUpdate:modelValue":[o[3]||(o[3]=m=>i.Announce.Hall=m),o[4]||(o[4]=m=>A())],label:"\u041C\u0435\u0441\u0442\u043E \u043F\u0440\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F","map-options":"","option-label":"name","option-value":"id",options:f(g)},null,8,["modelValue","options"]),l(Ye,{modelValue:i.Announce.pay,"onUpdate:modelValue":o[5]||(o[5]=m=>i.Announce.pay=m),"emit-value":"","map-options":"",label:"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0432\u0445\u043E\u0434\u0430",options:O},null,8,["modelValue"]),rn,[3,4].includes(i.Announce.pay)?(k(),E(X,{key:0,type:"text",modelValue:i.Announce.ticketLink,"onUpdate:modelValue":o[6]||(o[6]=m=>i.Announce.ticketLink=m),label:"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435 \u0431\u0438\u043B\u0435\u0442\u043E\u0432"},null,8,["modelValue"])):H("",!0),dn,l(X,{type:"number",modelValue:i.Announce.age,"onUpdate:modelValue":o[7]||(o[7]=m=>i.Announce.age=m),label:"\u0412\u043E\u0437\u0440\u0430\u0441\u0442\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"},null,8,["modelValue"]),cn,l(X,{name:"evDescr",modelValue:i.Announce.sdescr,"onUpdate:modelValue":o[8]||(o[8]=m=>i.Announce.sdescr=m),type:"textarea",autogrow:"",label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),vn,l(X,{name:"evText",modelValue:i.Announce.description,"onUpdate:modelValue":[o[9]||(o[9]=m=>i.Announce.description=m),o[10]||(o[10]=m=>be())],type:"textarea",autogrow:"",debounce:300,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},null,8,["modelValue"]),l(ye,{spaced:"1em"}),h("div",mn,[l(Ct,{modelValue:b,"onUpdate:modelValue":o[11]||(o[11]=m=>b=m),style:{width:"100%"},label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",factory:oe,ref_key:"uploader2",ref:j,onUploaded:B,onFailed:z,"no-thumbnails":""},null,512)])])]),l(Se,{align:"right"},{default:s(()=>[l(ue,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:ie,color:"green"})]),_:1})])):H("",!0),fn,pn,hn],64))}};var kn=Ue(_n,[["__scopeId","data-v-39eb0314"]]);const gn=n=>(je("data-v-5d52020c"),n=n(),ze(),n),yn={key:0,class:"posterArea relative-position"},bn={style:{position:"absolute",right:"1em",top:"1em","z-index":"10"}},An=gn(()=>h("img",{src:"/img/news/default_sketch.svg"},null,-1)),wn={class:"eventboxin"},Vn={key:0},Dn=["innerHTML"],Mn={key:1},qn={key:1,class:"videoItem"},Cn={__name:"AnnounceDescr",emits:["delPoster"],setup(n,{emit:$}){const V=String("https://api.sakh-orch.ru/"),S=xe();G("editMode");const r=G("Announce"),D=y(()=>{let w=S.platform.is.mobile?1080:480;return r.value.poster?Ot(V,r.value.poster.md5,r.value.poster.ext,w):"/error.err"});function g(){return"https://vk.com/share.php?url="+String("https://sakh-orch.ru/")+"/announce/"+String(r.value.id)+"&title="+String(r.value.progName)+"&noparse=true&image="+String(D.value)}function x(){He.post(V+"api/event/poster.php",{params:{method:"unlink",id:r.value.id}}).then(w=>{var b;if(!((b=w==null?void 0:w.data)!=null&&b.result))throw new Error;delete r.value.poster,delete r.value.posterId}).catch(w=>{S.notify(Ie(w))})}return(w,b)=>(k(),C(L,null,[f(r).poster?(k(),C("div",yn,[h("div",bn,[l(Et,{"throw-confirm":"",title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",tooltip:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0444\u0438\u0448\u0443",onOnOk:b[0]||(b[0]=M=>x())})]),l(Ft,{src:D.value},{error:s(()=>[An]),_:1},8,["src"])])):H("",!0),h("div",wn,[l(Mt,{class:"transparent no-padding",flat:""},{default:s(()=>[l(W,{class:"no-padding"},{default:s(()=>[l(ge,null,{default:s(()=>[l(F,null,{default:s(()=>[l(N,{class:"title"},{default:s(()=>[P(_e(f(r).progName),1)]),_:1}),l(N,{class:"title"},{default:s(()=>[P(_e(f(Pt)(f(r).eventTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(W,null,{default:s(()=>[(k(!0),C(L,null,Dt(f(r).parsedMD,(M,O)=>(k(),C(L,{key:O},[M.type==="text"?(k(),C("div",Vn,[M.content!==`
`?(k(),C("div",{key:0,innerHTML:M.content,class:"textBlock"},null,8,Dn)):(k(),C("br",Mn))])):H("",!0),M.type==="video"?(k(),C("div",qn,[l(Lt,{ratio:16/9,src:"https://www.youtube.com/embed/"+M.content},null,8,["src"])])):H("",!0)],64))),128))]),_:1}),!f(r).completed&&[3,4].includes(f(r).pay)&&f(r).ticketLink?(k(),E(Se,{key:0,align:"right"})):H("",!0),l(W,null,{default:s(()=>[l(ge,{dense:""},{default:s(()=>[l(N,{caption:""},{default:s(()=>[P(" \u0423\u0432\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043F\u043E\u0441\u0435\u0442\u0438\u0442\u0435\u043B\u0438, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0440\u043E\u0441\u044C\u0431\u0430 \u0441\u043E\u0431\u043B\u044E\u0434\u0430\u0442\u044C \u043C\u0435\u0440\u044B \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438 \u0432 \u0441\u0432\u044F\u0437\u0438 \u0441 \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u0438\u0435\u043C \u043A\u043E\u0440\u043E\u043D\u0430\u0432\u0438\u0440\u0443\u0441\u043D\u043E\u0439 \u0438\u043D\u0444\u0435\u043A\u0446\u0438\u0438! ")]),_:1})]),_:1})]),_:1}),l(W,null,{default:s(()=>[l(ge,{clickable:"",href:f(r).Hall.map,target:"_blank"},{default:s(()=>[l(F,{avatar:""},{default:s(()=>[l(ae,{name:"place"})]),_:1}),l(F,null,{default:s(()=>[l(N,null,{default:s(()=>[P(_e(f(r).Hall.name),1)]),_:1}),l(N,{caption:""},{default:s(()=>[P(_e(f(r).Hall.address),1)]),_:1})]),_:1})]),_:1},8,["href"])]),_:1}),!f(r).completed&&[3,4].includes(f(r).pay)&&f(r).ticketLink?(k(),E(W,{key:1},{default:s(()=>[l(ge,{clickable:"",href:f(r).ticketLink,target:"_blank"},{default:s(()=>[f(r).pay===3?(k(),C(L,{key:0},[l(F,{avatar:""},{default:s(()=>[l(ae,{name:"shopping_cart"})]),_:1}),l(F,null,{default:s(()=>[l(N,null,{default:s(()=>[P("\u041A\u0443\u043F\u0438\u0442\u044C \u0431\u0438\u043B\u0435\u0442")]),_:1}),(k(),E(N,{key:0,caption:""},{default:s(()=>[P("+ \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043F\u043E \u043F\u0443\u0448\u043A\u0438\u043D\u0441\u043A\u043E\u0439 \u043A\u0430\u0440\u0442\u0435")]),_:1}))]),_:1})],64)):H("",!0),f(r).pay===4?(k(),C(L,{key:1},[l(F,{avatar:""},{default:s(()=>[l(ae,{name:"img:/img/uds.svg"})]),_:1}),l(F,null,{default:s(()=>[l(N,null,{default:s(()=>[P("\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439")]),_:1})]),_:1})],64)):H("",!0)]),_:1},8,["href"])]),_:1})):H("",!0),l(ye),l(W,{class:"no-padding"},{default:s(()=>[l(Fe,{"phone-number":"+7-(4242)-300-518"}),l(Fe,{"phone-number":"+7-(962)-416-36-89"})]),_:1}),l(ye,{spaced:"1em"}),l(Se,{align:"right"},{default:s(()=>[l(ue,{href:g(),target:"_blank",icon:"ion-logo-vk",outline:"",style:{color:"var(--docTitle)"},label:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},null,8,["href"])]),_:1})]),_:1})])],64))}};var Sn=Ue(Cn,[["__scopeId","data-v-5d52020c"]]);const xn={class:"eventboxl"},Hn={__name:"AnnouncePage",setup(n){const $=Nt("\u0410\u043D\u043E\u043D\u0441");ct($);const V=xe(),S=G("editMode"),r=String("https://api.sakh-orch.ru/"),D=Le(),g=I(),x=I(null);Ee("Announce",x);function w(){He.post(r+"api/event/announce.php",{params:{method:"get",id:D.params.evid}}).then(b=>{var M,O;x.value=(O=(M=b==null?void 0:b.data)==null?void 0:M.data)!=null?O:null,console.log("Announce loaded")}).catch(b=>{V.notify(Ie(b))})}return qt(()=>{w()}),(b,M)=>(k(),C(L,null,[f(S)&&x.value?(k(),E(kn,{key:0,onPosterUploaded:w,onReload:w,ref_key:"editorRef",ref:g},null,512)):H("",!0),h("div",xn,[x.value?(k(),E(Sn,{key:0,onDelPoster:M[0]||(M[0]=()=>{g.value.delPoster()})})):H("",!0)])],64))}};var rl=Ue(Hn,[["__scopeId","data-v-64b5a099"]]);export{rl as default};
